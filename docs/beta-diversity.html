<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Beta diversity | Data analysis based on XMAS 2.0 package in microbiota data</title>
  <meta name="description" content="A tutorial of XMAS 2.0 package for in-house training" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Beta diversity | Data analysis based on XMAS 2.0 package in microbiota data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A tutorial of XMAS 2.0 package for in-house training" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Beta diversity | Data analysis based on XMAS 2.0 package in microbiota data" />
  
  <meta name="twitter:description" content="A tutorial of XMAS 2.0 package for in-house training" />
  

<meta name="author" content="Hua Zou" />


<meta name="date" content="2022-05-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="aplha-diversity.html"/>
<link rel="next" href="composition.html"/>
<script src="libs/header-attrs-2.13/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.21/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.9/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data analysis based on XMAS 2.0 package</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#preparing-for-the-tutorial"><i class="fa fa-check"></i><b>1.1</b> Preparing for the tutorial<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#microbiome"><i class="fa fa-check"></i><b>2.1</b> Microbiome<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#sequencing-technology"><i class="fa fa-check"></i><b>2.2</b> Sequencing technology<span></span></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction.html"><a href="introduction.html#amplicon-sequencing"><i class="fa fa-check"></i><b>2.2.1</b> Amplicon sequencing<span></span></a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction.html"><a href="introduction.html#whole-genome-shotgun-sequencing"><i class="fa fa-check"></i><b>2.2.2</b> Whole genome shotgun sequencing<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#the-gut-microbiome-relationships-with-disease-and-opportunities-for-therapy"><i class="fa fa-check"></i><b>2.3</b> The gut microbiome: Relationships with disease and opportunities for therapy<span></span></a></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#data-analysis-apply-for-discovering-the-potential-microbial-biomarkers"><i class="fa fa-check"></i><b>2.4</b> Data Analysis apply for discovering the potential microbial biomarkers<span></span></a></li>
<li class="chapter" data-level="2.5" data-path="introduction.html"><a href="introduction.html#book"><i class="fa fa-check"></i><b>2.5</b> Book<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html"><i class="fa fa-check"></i><b>3</b> Material in this tutorial<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#resources"><i class="fa fa-check"></i><b>3.1</b> Resources<span></span></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#dada2"><i class="fa fa-check"></i><b>3.1.1</b> DADA2<span></span></a></li>
<li class="chapter" data-level="3.1.2" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#metaphlan2"><i class="fa fa-check"></i><b>3.1.2</b> Metaphlan2<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#overview-of-the-design-of-xmas-package"><i class="fa fa-check"></i><b>3.2</b> Overview of the design of <strong>XMAS</strong> package<span></span></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#description"><i class="fa fa-check"></i><b>3.2.1</b> Description<span></span></a></li>
<li class="chapter" data-level="3.2.2" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#installation-of-dependent-packages"><i class="fa fa-check"></i><b>3.2.2</b> Installation of dependent packages<span></span></a></li>
<li class="chapter" data-level="3.2.3" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#installation"><i class="fa fa-check"></i><b>3.2.3</b> Installation<span></span></a></li>
<li class="chapter" data-level="3.2.4" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#vignette"><i class="fa fa-check"></i><b>3.2.4</b> Vignette<span></span></a></li>
<li class="chapter" data-level="3.2.5" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#authors"><i class="fa fa-check"></i><b>3.2.5</b> Authors<span></span></a></li>
<li class="chapter" data-level="3.2.6" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#library-package"><i class="fa fa-check"></i><b>3.2.6</b> library package<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#future-plan"><i class="fa fa-check"></i><b>3.3</b> Future plan<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#systematic-information"><i class="fa fa-check"></i><b>3.4</b> Systematic Information<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="convert-inputdata-into-phyloseq-object.html"><a href="convert-inputdata-into-phyloseq-object.html"><i class="fa fa-check"></i><b>4</b> Convert inputdata into phyloseq object<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="convert-inputdata-into-phyloseq-object.html"><a href="convert-inputdata-into-phyloseq-object.html#loading-packages"><i class="fa fa-check"></i><b>4.1</b> loading packages<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="convert-inputdata-into-phyloseq-object.html"><a href="convert-inputdata-into-phyloseq-object.html#dada2-1"><i class="fa fa-check"></i><b>4.2</b> DADA2<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="convert-inputdata-into-phyloseq-object.html"><a href="convert-inputdata-into-phyloseq-object.html#metaphlan23"><i class="fa fa-check"></i><b>4.3</b> Metaphlan2/3<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="convert-inputdata-into-phyloseq-object.html"><a href="convert-inputdata-into-phyloseq-object.html#systematic-information-1"><i class="fa fa-check"></i><b>4.4</b> Systematic Information<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="quality-evaluation.html"><a href="quality-evaluation.html"><i class="fa fa-check"></i><b>5</b> Quality Evaluation<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="quality-evaluation.html"><a href="quality-evaluation.html#reads-track"><i class="fa fa-check"></i><b>5.1</b> Reads’ track<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="quality-evaluation.html"><a href="quality-evaluation.html#spike-in-brs-sample-assessment"><i class="fa fa-check"></i><b>5.2</b> Spike-in (BRS) sample assessment<span></span></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="quality-evaluation.html"><a href="quality-evaluation.html#s-data"><i class="fa fa-check"></i><b>5.2.1</b> 16s data<span></span></a></li>
<li class="chapter" data-level="5.2.2" data-path="quality-evaluation.html"><a href="quality-evaluation.html#metagenomic-data"><i class="fa fa-check"></i><b>5.2.2</b> Metagenomic data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="quality-evaluation.html"><a href="quality-evaluation.html#rarefaction-curves"><i class="fa fa-check"></i><b>5.3</b> Rarefaction Curves<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="quality-evaluation.html"><a href="quality-evaluation.html#summarize-phyloseq-class-object"><i class="fa fa-check"></i><b>5.4</b> Summarize phyloseq-class object<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="quality-evaluation.html"><a href="quality-evaluation.html#systematic-information-2"><i class="fa fa-check"></i><b>5.5</b> Systematic Information<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="pre-processing.html"><a href="pre-processing.html"><i class="fa fa-check"></i><b>6</b> Pre-processing<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="pre-processing.html"><a href="pre-processing.html#removing-brs"><i class="fa fa-check"></i><b>6.1</b> Removing BRS<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="pre-processing.html"><a href="pre-processing.html#transformation"><i class="fa fa-check"></i><b>6.2</b> Transformation<span></span></a></li>
<li class="chapter" data-level="6.3" data-path="pre-processing.html"><a href="pre-processing.html#normalization"><i class="fa fa-check"></i><b>6.3</b> Normalization<span></span></a></li>
<li class="chapter" data-level="6.4" data-path="pre-processing.html"><a href="pre-processing.html#filtering"><i class="fa fa-check"></i><b>6.4</b> Filtering<span></span></a></li>
<li class="chapter" data-level="6.5" data-path="pre-processing.html"><a href="pre-processing.html#trimming"><i class="fa fa-check"></i><b>6.5</b> Trimming<span></span></a></li>
<li class="chapter" data-level="6.6" data-path="pre-processing.html"><a href="pre-processing.html#imputation"><i class="fa fa-check"></i><b>6.6</b> Imputation<span></span></a></li>
<li class="chapter" data-level="6.7" data-path="pre-processing.html"><a href="pre-processing.html#extracting-specific-taxa-phyloseq-class-object"><i class="fa fa-check"></i><b>6.7</b> Extracting specific taxa phyloseq-class object<span></span></a></li>
<li class="chapter" data-level="6.8" data-path="pre-processing.html"><a href="pre-processing.html#aggregating-low-relative-abundance-or-unclassified-taxa-into-others"><i class="fa fa-check"></i><b>6.8</b> Aggregating low relative abundance or unclassified taxa into others<span></span></a></li>
<li class="chapter" data-level="6.9" data-path="pre-processing.html"><a href="pre-processing.html#systematic-information-3"><i class="fa fa-check"></i><b>6.9</b> Systematic Information<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="aplha-diversity.html"><a href="aplha-diversity.html"><i class="fa fa-check"></i><b>7</b> Aplha diversity<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="aplha-diversity.html"><a href="aplha-diversity.html#equal-sample-sums"><i class="fa fa-check"></i><b>7.1</b> Equal sample sums<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="aplha-diversity.html"><a href="aplha-diversity.html#diversities"><i class="fa fa-check"></i><b>7.2</b> Diversities<span></span></a></li>
<li class="chapter" data-level="7.3" data-path="aplha-diversity.html"><a href="aplha-diversity.html#rank-abundance"><i class="fa fa-check"></i><b>7.3</b> Rank Abundance<span></span></a></li>
<li class="chapter" data-level="7.4" data-path="aplha-diversity.html"><a href="aplha-diversity.html#systematic-information-4"><i class="fa fa-check"></i><b>7.4</b> Systematic Information<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="beta-diversity.html"><a href="beta-diversity.html"><i class="fa fa-check"></i><b>8</b> Beta diversity<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="beta-diversity.html"><a href="beta-diversity.html#loading-data-and-removing-brs"><i class="fa fa-check"></i><b>8.1</b> Loading data and Removing BRS<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="beta-diversity.html"><a href="beta-diversity.html#phylogenetic-beta-diversity-metrics"><i class="fa fa-check"></i><b>8.2</b> Phylogenetic beta-diversity metrics<span></span></a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="beta-diversity.html"><a href="beta-diversity.html#unweighted-unifrac"><i class="fa fa-check"></i><b>8.2.1</b> Unweighted Unifrac<span></span></a></li>
<li class="chapter" data-level="8.2.2" data-path="beta-diversity.html"><a href="beta-diversity.html#weighted-unifrac"><i class="fa fa-check"></i><b>8.2.2</b> Weighted Unifrac<span></span></a></li>
<li class="chapter" data-level="8.2.3" data-path="beta-diversity.html"><a href="beta-diversity.html#generalized-unifrac-distance-metrics"><i class="fa fa-check"></i><b>8.2.3</b> Generalized UniFrac Distance Metrics<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="beta-diversity.html"><a href="beta-diversity.html#distance-dissimilarity-coefficients-bray-curtis-index"><i class="fa fa-check"></i><b>8.3</b> Distance (Dissimilarity) Coefficients: Bray-Curtis Index<span></span></a></li>
<li class="chapter" data-level="8.4" data-path="beta-diversity.html"><a href="beta-diversity.html#checking-the-homogeneity-condition"><i class="fa fa-check"></i><b>8.4</b> Checking the homogeneity condition<span></span></a></li>
<li class="chapter" data-level="8.5" data-path="beta-diversity.html"><a href="beta-diversity.html#permutational-multivariate-analysis-of-variance-permanova"><i class="fa fa-check"></i><b>8.5</b> Permutational Multivariate Analysis of Variance (PERMANOVA)<span></span></a></li>
<li class="chapter" data-level="8.6" data-path="beta-diversity.html"><a href="beta-diversity.html#analysis-of-similarity-anosim"><i class="fa fa-check"></i><b>8.6</b> Analysis of Similarity (ANOSIM)<span></span></a></li>
<li class="chapter" data-level="8.7" data-path="beta-diversity.html"><a href="beta-diversity.html#ordination"><i class="fa fa-check"></i><b>8.7</b> Ordination<span></span></a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="beta-diversity.html"><a href="beta-diversity.html#principal-component-analysis-pca"><i class="fa fa-check"></i><b>8.7.1</b> Principal Component Analysis (PCA)<span></span></a></li>
<li class="chapter" data-level="8.7.2" data-path="beta-diversity.html"><a href="beta-diversity.html#principal-coordinate-analysis-pcoa"><i class="fa fa-check"></i><b>8.7.2</b> Principal Coordinate Analysis (PCoA)<span></span></a></li>
<li class="chapter" data-level="8.7.3" data-path="beta-diversity.html"><a href="beta-diversity.html#t-distributed-stochastic-neighbor-embedding-t-sne"><i class="fa fa-check"></i><b>8.7.3</b> t-distributed stochastic neighbor embedding (t-SNE)<span></span></a></li>
<li class="chapter" data-level="8.7.4" data-path="beta-diversity.html"><a href="beta-diversity.html#uniform-manifold-approximation-and-projection-for-dimension-reduction-umap"><i class="fa fa-check"></i><b>8.7.4</b> Uniform Manifold Approximation and Projection for Dimension Reduction (UMAP)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="beta-diversity.html"><a href="beta-diversity.html#systematic-information-5"><i class="fa fa-check"></i><b>8.8</b> Systematic Information<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="composition.html"><a href="composition.html"><i class="fa fa-check"></i><b>9</b> Composition<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="composition.html"><a href="composition.html#loading-precessing-phyloseq-object"><i class="fa fa-check"></i><b>9.1</b> Loading &amp; precessing phyloseq object<span></span></a></li>
<li class="chapter" data-level="9.2" data-path="composition.html"><a href="composition.html#stacked-barplot"><i class="fa fa-check"></i><b>9.2</b> Stacked barplot<span></span></a></li>
<li class="chapter" data-level="9.3" data-path="composition.html"><a href="composition.html#xviz-plot_stacked_bar"><i class="fa fa-check"></i><b>9.3</b> XVIZ <code>plot_stacked_bar</code><span></span></a></li>
<li class="chapter" data-level="9.4" data-path="composition.html"><a href="composition.html#heatmaps"><i class="fa fa-check"></i><b>9.4</b> Heatmaps<span></span></a></li>
<li class="chapter" data-level="9.5" data-path="composition.html"><a href="composition.html#systematic-information-6"><i class="fa fa-check"></i><b>9.5</b> Systematic Information<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="core-microbiota.html"><a href="core-microbiota.html"><i class="fa fa-check"></i><b>10</b> Core microbiota<span></span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="core-microbiota.html"><a href="core-microbiota.html#core-microbiota-anlaysis"><i class="fa fa-check"></i><b>10.1</b> Core microbiota anlaysis<span></span></a></li>
<li class="chapter" data-level="10.2" data-path="core-microbiota.html"><a href="core-microbiota.html#core-abundance-and-diversity"><i class="fa fa-check"></i><b>10.2</b> Core abundance and diversity<span></span></a></li>
<li class="chapter" data-level="10.3" data-path="core-microbiota.html"><a href="core-microbiota.html#core-visualization"><i class="fa fa-check"></i><b>10.3</b> Core visualization<span></span></a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="core-microbiota.html"><a href="core-microbiota.html#heatmap"><i class="fa fa-check"></i><b>10.3.1</b> heatmap<span></span></a></li>
<li class="chapter" data-level="10.3.2" data-path="core-microbiota.html"><a href="core-microbiota.html#linechart"><i class="fa fa-check"></i><b>10.3.2</b> linechart<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="core-microbiota.html"><a href="core-microbiota.html#systematic-information-7"><i class="fa fa-check"></i><b>10.4</b> Systematic Information<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="differential-analysis.html"><a href="differential-analysis.html"><i class="fa fa-check"></i><b>11</b> Differential analysis<span></span></a>
<ul>
<li class="chapter" data-level="11.1" data-path="differential-analysis.html"><a href="differential-analysis.html#amplicon-sequencing-microbial-data-16s"><i class="fa fa-check"></i><b>11.1</b> Amplicon sequencing microbial data (16s)<span></span></a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="differential-analysis.html"><a href="differential-analysis.html#aldex2"><i class="fa fa-check"></i><b>11.1.1</b> ALDEx2<span></span></a></li>
<li class="chapter" data-level="11.1.2" data-path="differential-analysis.html"><a href="differential-analysis.html#limma_voom"><i class="fa fa-check"></i><b>11.1.2</b> limma_voom<span></span></a></li>
<li class="chapter" data-level="11.1.3" data-path="differential-analysis.html"><a href="differential-analysis.html#mbzinb"><i class="fa fa-check"></i><b>11.1.3</b> mbzinb<span></span></a></li>
<li class="chapter" data-level="11.1.4" data-path="differential-analysis.html"><a href="differential-analysis.html#omnibus"><i class="fa fa-check"></i><b>11.1.4</b> omnibus<span></span></a></li>
<li class="chapter" data-level="11.1.5" data-path="differential-analysis.html"><a href="differential-analysis.html#raida"><i class="fa fa-check"></i><b>11.1.5</b> RAIDA<span></span></a></li>
<li class="chapter" data-level="11.1.6" data-path="differential-analysis.html"><a href="differential-analysis.html#wilcoxon-rank-sum-and-signed-rank-tests"><i class="fa fa-check"></i><b>11.1.6</b> Wilcoxon Rank Sum and Signed Rank Tests<span></span></a></li>
<li class="chapter" data-level="11.1.7" data-path="differential-analysis.html"><a href="differential-analysis.html#liner-discriminant-analysis-lda-effect-size-lefse"><i class="fa fa-check"></i><b>11.1.7</b> Liner discriminant analysis (LDA) effect size (LEfSe)<span></span></a></li>
<li class="chapter" data-level="11.1.8" data-path="differential-analysis.html"><a href="differential-analysis.html#t-test"><i class="fa fa-check"></i><b>11.1.8</b> t-test<span></span></a></li>
<li class="chapter" data-level="11.1.9" data-path="differential-analysis.html"><a href="differential-analysis.html#metagenomeseq"><i class="fa fa-check"></i><b>11.1.9</b> MetagenomeSeq<span></span></a></li>
<li class="chapter" data-level="11.1.10" data-path="differential-analysis.html"><a href="differential-analysis.html#deseq2"><i class="fa fa-check"></i><b>11.1.10</b> DESeq2<span></span></a></li>
<li class="chapter" data-level="11.1.11" data-path="differential-analysis.html"><a href="differential-analysis.html#edger"><i class="fa fa-check"></i><b>11.1.11</b> EdgeR<span></span></a></li>
<li class="chapter" data-level="11.1.12" data-path="differential-analysis.html"><a href="differential-analysis.html#ancom"><i class="fa fa-check"></i><b>11.1.12</b> ANCOM<span></span></a></li>
<li class="chapter" data-level="11.1.13" data-path="differential-analysis.html"><a href="differential-analysis.html#corncob"><i class="fa fa-check"></i><b>11.1.13</b> Corncob<span></span></a></li>
<li class="chapter" data-level="11.1.14" data-path="differential-analysis.html"><a href="differential-analysis.html#maaslin2-microbiome-multivariable-association-with-linear-models"><i class="fa fa-check"></i><b>11.1.14</b> Maaslin2 (Microbiome Multivariable Association with Linear Models)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="differential-analysis.html"><a href="differential-analysis.html#metagenomic-sequencing-microbial-data-metaphlan23"><i class="fa fa-check"></i><b>11.2</b> Metagenomic sequencing microbial data (metaphlan2/3)<span></span></a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="differential-analysis.html"><a href="differential-analysis.html#limma_voom-1"><i class="fa fa-check"></i><b>11.2.1</b> limma_voom<span></span></a></li>
<li class="chapter" data-level="11.2.2" data-path="differential-analysis.html"><a href="differential-analysis.html#wilcoxon-rank-sum-and-signed-rank-tests-1"><i class="fa fa-check"></i><b>11.2.2</b> Wilcoxon Rank Sum and Signed Rank Tests<span></span></a></li>
<li class="chapter" data-level="11.2.3" data-path="differential-analysis.html"><a href="differential-analysis.html#liner-discriminant-analysis-lda-effect-size-lefse-1"><i class="fa fa-check"></i><b>11.2.3</b> Liner discriminant analysis (LDA) effect size (LEfSe)<span></span></a></li>
<li class="chapter" data-level="11.2.4" data-path="differential-analysis.html"><a href="differential-analysis.html#t-test-1"><i class="fa fa-check"></i><b>11.2.4</b> t-test<span></span></a></li>
<li class="chapter" data-level="11.2.5" data-path="differential-analysis.html"><a href="differential-analysis.html#maaslin2-microbiome-multivariable-association-with-linear-models-1"><i class="fa fa-check"></i><b>11.2.5</b> Maaslin2 (Microbiome Multivariable Association with Linear Models)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="differential-analysis.html"><a href="differential-analysis.html#visualization-4"><i class="fa fa-check"></i><b>11.3</b> Visualization<span></span></a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="differential-analysis.html"><a href="differential-analysis.html#volcano-plot"><i class="fa fa-check"></i><b>11.3.1</b> Volcano plot<span></span></a></li>
<li class="chapter" data-level="11.3.2" data-path="differential-analysis.html"><a href="differential-analysis.html#barplot-in-lefse"><i class="fa fa-check"></i><b>11.3.2</b> barplot in lefse<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="differential-analysis.html"><a href="differential-analysis.html#dominant-taxa"><i class="fa fa-check"></i><b>11.4</b> Dominant taxa<span></span></a></li>
<li class="chapter" data-level="11.5" data-path="differential-analysis.html"><a href="differential-analysis.html#multiple-differential-analysis-by-one-function"><i class="fa fa-check"></i><b>11.5</b> Multiple differential analysis by one function<span></span></a></li>
<li class="chapter" data-level="11.6" data-path="differential-analysis.html"><a href="differential-analysis.html#systematic-information-8"><i class="fa fa-check"></i><b>11.6</b> Systematic Information<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="visualization-5.html"><a href="visualization-5.html"><i class="fa fa-check"></i><b>12</b> Visualization<span></span></a>
<ul>
<li class="chapter" data-level="12.1" data-path="visualization-5.html"><a href="visualization-5.html#plot_boxplot"><i class="fa fa-check"></i><b>12.1</b> plot_boxplot<span></span></a></li>
<li class="chapter" data-level="12.2" data-path="visualization-5.html"><a href="visualization-5.html#plot_barplot"><i class="fa fa-check"></i><b>12.2</b> plot_barplot<span></span></a></li>
<li class="chapter" data-level="12.3" data-path="visualization-5.html"><a href="visualization-5.html#plot_dotplot"><i class="fa fa-check"></i><b>12.3</b> plot_dotplot<span></span></a></li>
<li class="chapter" data-level="12.4" data-path="visualization-5.html"><a href="visualization-5.html#plot_correlation_boxplot"><i class="fa fa-check"></i><b>12.4</b> plot_correlation_boxplot<span></span></a></li>
<li class="chapter" data-level="12.5" data-path="visualization-5.html"><a href="visualization-5.html#plot_correlation_density"><i class="fa fa-check"></i><b>12.5</b> plot_correlation_density<span></span></a></li>
<li class="chapter" data-level="12.6" data-path="visualization-5.html"><a href="visualization-5.html#plot_ordination"><i class="fa fa-check"></i><b>12.6</b> plot_Ordination<span></span></a></li>
<li class="chapter" data-level="12.7" data-path="visualization-5.html"><a href="visualization-5.html#plot_ggbiplot"><i class="fa fa-check"></i><b>12.7</b> plot_ggbiplot<span></span></a></li>
<li class="chapter" data-level="12.8" data-path="visualization-5.html"><a href="visualization-5.html#systematic-information-9"><i class="fa fa-check"></i><b>12.8</b> Systematic Information<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>13</b> Examples<span></span></a>
<ul>
<li class="chapter" data-level="13.1" data-path="examples.html"><a href="examples.html#workflow-description"><i class="fa fa-check"></i><b>13.1</b> Workflow description<span></span></a></li>
<li class="chapter" data-level="13.2" data-path="examples.html"><a href="examples.html#amplicon-sequencing-16s"><i class="fa fa-check"></i><b>13.2</b> Amplicon sequencing (16s)<span></span></a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="examples.html"><a href="examples.html#converting-inputs-into-phyloseq-class-object"><i class="fa fa-check"></i><b>13.2.1</b> Converting inputs into phyloseq-class object<span></span></a></li>
<li class="chapter" data-level="13.2.2" data-path="examples.html"><a href="examples.html#quality-control"><i class="fa fa-check"></i><b>13.2.2</b> Quality Control<span></span></a></li>
<li class="chapter" data-level="13.2.3" data-path="examples.html"><a href="examples.html#data-processing"><i class="fa fa-check"></i><b>13.2.3</b> Data processing<span></span></a></li>
<li class="chapter" data-level="13.2.4" data-path="examples.html"><a href="examples.html#diversity-analysis"><i class="fa fa-check"></i><b>13.2.4</b> Diversity analysis<span></span></a></li>
<li class="chapter" data-level="13.2.5" data-path="examples.html"><a href="examples.html#permanova-ordination"><i class="fa fa-check"></i><b>13.2.5</b> PERMANOVA + Ordination<span></span></a></li>
<li class="chapter" data-level="13.2.6" data-path="examples.html"><a href="examples.html#microbial-composition"><i class="fa fa-check"></i><b>13.2.6</b> Microbial composition<span></span></a></li>
<li class="chapter" data-level="13.2.7" data-path="examples.html"><a href="examples.html#differential-analysis-1"><i class="fa fa-check"></i><b>13.2.7</b> Differential Analysis<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="examples.html"><a href="examples.html#metagenomics"><i class="fa fa-check"></i><b>13.3</b> Metagenomics<span></span></a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="examples.html"><a href="examples.html#converting-inputs-into-phyloseq-class-object-1"><i class="fa fa-check"></i><b>13.3.1</b> Converting inputs into phyloseq-class object<span></span></a></li>
<li class="chapter" data-level="13.3.2" data-path="examples.html"><a href="examples.html#quality-control-1"><i class="fa fa-check"></i><b>13.3.2</b> Quality Control<span></span></a></li>
<li class="chapter" data-level="13.3.3" data-path="examples.html"><a href="examples.html#data-processing-1"><i class="fa fa-check"></i><b>13.3.3</b> Data processing<span></span></a></li>
<li class="chapter" data-level="13.3.4" data-path="examples.html"><a href="examples.html#diversity-analysis-1"><i class="fa fa-check"></i><b>13.3.4</b> Diversity analysis<span></span></a></li>
<li class="chapter" data-level="13.3.5" data-path="examples.html"><a href="examples.html#permanova-ordination-1"><i class="fa fa-check"></i><b>13.3.5</b> PERMANOVA + Ordination<span></span></a></li>
<li class="chapter" data-level="13.3.6" data-path="examples.html"><a href="examples.html#microbial-composition-1"><i class="fa fa-check"></i><b>13.3.6</b> Microbial composition<span></span></a></li>
<li class="chapter" data-level="13.3.7" data-path="examples.html"><a href="examples.html#differential-analysis-2"><i class="fa fa-check"></i><b>13.3.7</b> Differential Analysis<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="references.html#references">References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data analysis based on XMAS 2.0 package in microbiota data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="beta-diversity" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Beta diversity<a href="beta-diversity.html#beta-diversity" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Beta-diversity: Measures for differences between samples from different groups to identify if there are differences in the overall community composition and structure.</p>
<p><strong>Loading packages</strong></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="beta-diversity.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(XMAS)</span>
<span id="cb106-2"><a href="beta-diversity.html#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb106-3"><a href="beta-diversity.html#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb106-4"><a href="beta-diversity.html#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phyloseq)</span>
<span id="cb106-5"><a href="beta-diversity.html#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div id="loading-data-and-removing-brs" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Loading data and Removing BRS<a href="beta-diversity.html#loading-data-and-removing-brs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Using <code>get_GroupPhyloseq</code> to remove some samples. For instance, removing the spike-in sample QC in Group column.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="beta-diversity.html#cb107-1" aria-hidden="true" tabindex="-1"></a>dada2_ps_remove_BRS <span class="ot">&lt;-</span> <span class="fu">get_GroupPhyloseq</span>(</span>
<span id="cb107-2"><a href="beta-diversity.html#cb107-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ps =</span> dada2_ps,</span>
<span id="cb107-3"><a href="beta-diversity.html#cb107-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb107-4"><a href="beta-diversity.html#cb107-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group_names =</span> <span class="st">&quot;QC&quot;</span>,</span>
<span id="cb107-5"><a href="beta-diversity.html#cb107-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">discard =</span> <span class="cn">TRUE</span></span>
<span id="cb107-6"><a href="beta-diversity.html#cb107-6" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb107-7"><a href="beta-diversity.html#cb107-7" aria-hidden="true" tabindex="-1"></a>dada2_ps_remove_BRS</span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 896 taxa and 23 samples ]
## sample_data() Sample Data:       [ 23 samples by 1 sample variables ]
## tax_table()   Taxonomy Table:    [ 896 taxa by 7 taxonomic ranks ]
## phy_tree()    Phylogenetic Tree: [ 896 tips and 893 internal nodes ]</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="beta-diversity.html#cb109-1" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps_remove_BRS <span class="ot">&lt;-</span> <span class="fu">get_GroupPhyloseq</span>(</span>
<span id="cb109-2"><a href="beta-diversity.html#cb109-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ps =</span> metaphlan2_ps,</span>
<span id="cb109-3"><a href="beta-diversity.html#cb109-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb109-4"><a href="beta-diversity.html#cb109-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group_names =</span> <span class="st">&quot;QC&quot;</span>,</span>
<span id="cb109-5"><a href="beta-diversity.html#cb109-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">discard =</span> <span class="cn">TRUE</span></span>
<span id="cb109-6"><a href="beta-diversity.html#cb109-6" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb109-7"><a href="beta-diversity.html#cb109-7" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps_remove_BRS</span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 326 taxa and 22 samples ]
## sample_data() Sample Data:       [ 22 samples by 2 sample variables ]
## tax_table()   Taxonomy Table:    [ 326 taxa by 7 taxonomic ranks ]</code></pre>
</div>
<div id="phylogenetic-beta-diversity-metrics" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Phylogenetic beta-diversity metrics<a href="beta-diversity.html#phylogenetic-beta-diversity-metrics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="unweighted-unifrac" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Unweighted Unifrac<a href="beta-diversity.html#unweighted-unifrac" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Unweighted Unifrac is based on presence/absence of different taxa and abundance is not important.</p>
<blockquote>
<p>The UniFrac distance, also known as unweighted UniFrac distance, was introduced by Lozupone et al. The goal of the UniFrac distance metric was to enable objective comparison between microbiome samples from different conditions.</p>
</blockquote>
<p><span class="math display">\[d^{u} = \sum^{n}_{i=1}\frac{b_{i}|I(p_{i}^{A} &gt; 0) - I(p_{i}^{B} &gt; 0)|}{\sum_{i=1}^{n}b_{i}}\]</span></p>
<p>where,</p>
<ul>
<li><p><span class="math inline">\(d^{u}\)</span> = unweighted UniFrac distance;</p></li>
<li><p><span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span> = microbiome community A and B, respectively;</p></li>
<li><p><span class="math inline">\(n\)</span> = rooted phylogenetic tree’s branches;</p></li>
<li><p><span class="math inline">\(b_{i}\)</span> =length of the branch <span class="math inline">\(i\)</span>;</p></li>
<li><p><span class="math inline">\(p_{i}^{A}\)</span> and <span class="math inline">\(p_{i}^{A}\)</span> = taxa proportions descending from the branch <span class="math inline">\(i\)</span> for community A and B, respectively.</p></li>
<li><p>Calculation</p></li>
</ul>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="beta-diversity.html#cb111-1" aria-hidden="true" tabindex="-1"></a>beta_df <span class="ot">&lt;-</span> <span class="fu">run_beta_diversity</span>(<span class="at">ps=</span>dada2_ps_remove_BRS, <span class="at">method =</span> <span class="st">&quot;unifrac&quot;</span>, <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Permutation test for homogeneity of multivariate dispersions
## Permutation: free
## Number of permutations: 999
## 
## Response: Distances
##           Df   Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
## Groups     1 0.001185 0.0011849 0.4844    999  0.513
## Residuals 21 0.051370 0.0024462                     
## 
## Pairwise comparisons:
## (Observed p-value below diagonal, permuted p-value above diagonal)
##         AA   BB
## AA         0.51
## BB 0.49408</code></pre>
<p>The result of dispersion test (<code>Pr(&gt;F) &lt; 0.05</code>) showed that the <strong>homogeneity condition</strong> of two groups were significant.</p>
<ul>
<li>Visualization</li>
</ul>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="beta-diversity.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_distance_corrplot</span>(beta_df<span class="sc">$</span>BetaDistance, </span>
<span id="cb113-2"><a href="beta-diversity.html#cb113-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">&quot;color&quot;</span>,</span>
<span id="cb113-3"><a href="beta-diversity.html#cb113-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;lower&quot;</span>,</span>
<span id="cb113-4"><a href="beta-diversity.html#cb113-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">order =</span> <span class="st">&quot;original&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-49"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-49-1.png" alt="Unweighted Unifrac Distance" width="576" />
<p class="caption">
Figure 8.1: Unweighted Unifrac Distance
</p>
</div>
<p>Try repeating the above ordination using filtered phyloseq object (<strong>discarding singletons/OTUs with very low reads</strong>).</p>
</div>
<div id="weighted-unifrac" class="section level3 hasAnchor" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Weighted Unifrac<a href="beta-diversity.html#weighted-unifrac" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Weighted Unifrac will consider the abundances of different taxa.</p>
<blockquote>
<p>In 2007, Lozupone et al. added a proportional weighting to the original unweighted method, hence called this new UniFrac measure as weighted UniFrac.</p>
</blockquote>
<p>The weighted UniFrac distance is defined as:</p>
<p><span class="math display">\[d^{W} = \frac{\sum_{i=1}^{n}b_{i}|p_{i}^{A}-p_{i}^{B}|}{\sum_{i=1}^{n}b_{i}(p_{i}^{A}+p_{i}^{B})}\]</span></p>
<p>where,</p>
<ul>
<li><p><span class="math inline">\(d^{W}\)</span> = (normalized) weighted UniFrac distance;</p></li>
<li><p><span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span> = microbiome community A and B, respectively;</p></li>
<li><p><span class="math inline">\(n\)</span> = rooted phylogenetic tree’s branches;</p></li>
<li><p><span class="math inline">\(b_{i}\)</span> = length of the branch <span class="math inline">\(i\)</span>.</p></li>
</ul>
<blockquote>
<p>By adding a proportional weighting to UniFrac distance, weighted UniFrac distance reduces the problem of low abundance taxa being represented as a 0 or by a low count depending on sampling depth.</p>
</blockquote>
<ul>
<li><strong>Calculation</strong></li>
</ul>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="beta-diversity.html#cb114-1" aria-hidden="true" tabindex="-1"></a>beta_df <span class="ot">&lt;-</span> <span class="fu">run_beta_diversity</span>(<span class="at">ps=</span>dada2_ps_remove_BRS, <span class="at">method =</span> <span class="st">&quot;wunifrac&quot;</span>, <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Permutation test for homogeneity of multivariate dispersions
## Permutation: free
## Number of permutations: 999
## 
## Response: Distances
##           Df    Sum Sq    Mean Sq      F N.Perm Pr(&gt;F)
## Groups     1 0.0004211 0.00042108 0.3653    999  0.582
## Residuals 21 0.0242075 0.00115274                     
## 
## Pairwise comparisons:
## (Observed p-value below diagonal, permuted p-value above diagonal)
##         AA    BB
## AA         0.571
## BB 0.55206</code></pre>
<p>The result of dispersion test (<code>Pr(&gt;F) &gt; 0.05</code>) showed that the <strong>homogeneity condition</strong> of two groups were not significant.</p>
<ul>
<li><strong>Visualization</strong></li>
</ul>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="beta-diversity.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_distance_corrplot</span>(beta_df<span class="sc">$</span>BetaDistance, </span>
<span id="cb116-2"><a href="beta-diversity.html#cb116-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">&quot;color&quot;</span>,</span>
<span id="cb116-3"><a href="beta-diversity.html#cb116-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;lower&quot;</span>,</span>
<span id="cb116-4"><a href="beta-diversity.html#cb116-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">order =</span> <span class="st">&quot;original&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-51"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-51-1.png" alt="Weighted Unifrac Distance" width="576" />
<p class="caption">
Figure 8.2: Weighted Unifrac Distance
</p>
</div>
</div>
<div id="generalized-unifrac-distance-metrics" class="section level3 hasAnchor" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> Generalized UniFrac Distance Metrics<a href="beta-diversity.html#generalized-unifrac-distance-metrics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>However, either unweighted or weighted UniFrac distances may not be very powerful in detecting change in moderately abundant lineages <span class="citation">(<a href="#ref-chen2012associating" role="doc-biblioref">J. Chen et al. 2012</a>)</span> because they assign too much weight either to rare lineages or to most abundant lineages. Thus, Chen et al. proposed the following generalized UniFrac distances to unify weighted UniFrac and unweighted UniFrac distances.</p>
<p>The Generalized UniFrac Distance Metrics is defined as:</p>
<p><span class="math display">\[d^{\alpha} = \frac{\sum_{i=1}^{n}b_{i}(p_{i}^{A}+p_{i}^{B})^{\alpha}|\frac{p_{i}^{A}-p_{i}^{B}}{p_{i}^{A}+p_{i}^{B}}|}{\sum_{i=1}^{n}b_{i}(p_{i}^{A}+p_{i}^{B})}\]</span></p>
<p>where,</p>
<ul>
<li><p><span class="math inline">\(d^{\alpha}\)</span> = generalized UniFrac distances;</p></li>
<li><p><span class="math inline">\(\alpha\in [0, 1]\)</span> is used to controls the contribution from high-abundance branches;</p></li>
<li><p><strong>Calculation</strong></p></li>
</ul>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="beta-diversity.html#cb117-1" aria-hidden="true" tabindex="-1"></a>beta_df <span class="ot">&lt;-</span> <span class="fu">run_beta_diversity</span>(<span class="at">ps=</span>dada2_ps_remove_BRS, <span class="at">method =</span> <span class="st">&quot;GUniFrac&quot;</span>, <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>, <span class="at">GUniFrac_alpha =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## 
## Permutation test for homogeneity of multivariate dispersions
## Permutation: free
## Number of permutations: 999
## 
## Response: Distances
##           Df   Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
## Groups     1 0.003073 0.0030731 1.0732    999  0.286
## Residuals 21 0.060135 0.0028636                     
## 
## Pairwise comparisons:
## (Observed p-value below diagonal, permuted p-value above diagonal)
##         AA    BB
## AA         0.285
## BB 0.31201</code></pre>
<ul>
<li><strong>Visualization</strong>: GUniFrac with alpha 0.5</li>
</ul>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="beta-diversity.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_distance_corrplot</span>(beta_df<span class="sc">$</span>BetaDistance, </span>
<span id="cb119-2"><a href="beta-diversity.html#cb119-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">&quot;color&quot;</span>,</span>
<span id="cb119-3"><a href="beta-diversity.html#cb119-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;lower&quot;</span>,</span>
<span id="cb119-4"><a href="beta-diversity.html#cb119-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">order =</span> <span class="st">&quot;original&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-53"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-53-1.png" alt="Generalized UniFrac Distance (alpha=0.5)" width="576" />
<p class="caption">
Figure 8.3: Generalized UniFrac Distance (alpha=0.5)
</p>
</div>
</div>
</div>
<div id="distance-dissimilarity-coefficients-bray-curtis-index" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Distance (Dissimilarity) Coefficients: Bray-Curtis Index<a href="beta-diversity.html#distance-dissimilarity-coefficients-bray-curtis-index" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For microbiome abundance data, the measures of distance coefficients are not really distances. They actually measure “dissimilarity”.</p>
<p>Measures of dissimilarity include Euclidian distance, Manhattan, and Bray-Curtis measures. Here, we take Bray-Curtis distance as an example.</p>
<p>As defined by Bray and Curtis, the index of dissimilarity is given as follow:</p>
<p><span class="math display">\[BC = \frac{\sum_{i=1}^{n}|X_{ij}-X_{ik}|}{\sum_{i=1}^{n}|X_{ij}+X_{ik}|}\]</span>
where,</p>
<ul>
<li><p><span class="math inline">\(BC\)</span> Bray-Curtis measure of dissimilarity;</p></li>
<li><p><span class="math inline">\(X_{ij}\)</span>, <span class="math inline">\(X_{ik}\)</span> Number of individuals in species;</p></li>
<li><p><span class="math inline">\(i\)</span> in each <span class="math inline">\(sample (j, k)\)</span>;</p></li>
<li><p><span class="math inline">\(n\)</span> Total number of species in samples.</p></li>
</ul>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="beta-diversity.html#cb120-1" aria-hidden="true" tabindex="-1"></a>beta_df <span class="ot">&lt;-</span> <span class="fu">run_beta_diversity</span>(<span class="at">ps=</span>dada2_ps_remove_BRS, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>, <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Permutation test for homogeneity of multivariate dispersions
## Permutation: free
## Number of permutations: 999
## 
## Response: Distances
##           Df   Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
## Groups     1 0.002229 0.0022290 0.4342    999  0.532
## Residuals 21 0.107795 0.0051331                     
## 
## Pairwise comparisons:
## (Observed p-value below diagonal, permuted p-value above diagonal)
##         AA    BB
## AA         0.536
## BB 0.51708</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="beta-diversity.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_distance_corrplot</span>(beta_df<span class="sc">$</span>BetaDistance, </span>
<span id="cb122-2"><a href="beta-diversity.html#cb122-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">&quot;color&quot;</span>,</span>
<span id="cb122-3"><a href="beta-diversity.html#cb122-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;lower&quot;</span>,</span>
<span id="cb122-4"><a href="beta-diversity.html#cb122-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">order =</span> <span class="st">&quot;original&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-54"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-54-1.png" alt="Bray Curtis Distance" width="576" />
<p class="caption">
Figure 8.4: Bray Curtis Distance
</p>
</div>
</div>
<div id="checking-the-homogeneity-condition" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Checking the homogeneity condition<a href="beta-diversity.html#checking-the-homogeneity-condition" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="beta-diversity.html#cb123-1" aria-hidden="true" tabindex="-1"></a>beta_df <span class="ot">&lt;-</span> <span class="fu">run_beta_diversity</span>(<span class="at">ps=</span>dada2_ps_remove_BRS, <span class="at">method =</span> <span class="st">&quot;jsd&quot;</span>, <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Permutation test for homogeneity of multivariate dispersions
## Permutation: free
## Number of permutations: 999
## 
## Response: Distances
##           Df   Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
## Groups     1 0.000498 0.0004984 0.1234    999  0.721
## Residuals 21 0.084815 0.0040388                     
## 
## Pairwise comparisons:
## (Observed p-value below diagonal, permuted p-value above diagonal)
##         AA    BB
## AA         0.735
## BB 0.72887</code></pre>
<p>The result of dispersion test (<code>Pr(&gt;F) &lt; 0.05</code>) showed that the <strong>homogeneity condition</strong> of two groups were significant.</p>
</div>
<div id="permutational-multivariate-analysis-of-variance-permanova" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Permutational Multivariate Analysis of Variance (PERMANOVA)<a href="beta-diversity.html#permutational-multivariate-analysis-of-variance-permanova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Permutational Multivariate Analysis of Variance (PERMANOVA)</strong> test <span class="citation">(<a href="#ref-anderson2014permutational" role="doc-biblioref">Anderson 2014</a>)</span> is to investigate the associations between the environmental factors including discrete or continuous variables (treatments or populations representatives, age, gender etc) and the whole microbial community.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="beta-diversity.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;amplicon_ps&quot;</span>)</span>
<span id="cb125-2"><a href="beta-diversity.html#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">run_permanova</span>(amplicon_ps, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>)</span></code></pre></div>
<pre><code>##                          SumsOfSample Df  SumsOfSqs   MeanSqs   F.Model         R2 Pr(&gt;F) AdjustedPvalue
## SampleID                           34 33 12.4906568 0.3785048 0.0000000 1.00000000  1.000      1.0000000
## SampleType                         34  3  5.5551059 1.8517020 8.0096101 0.44474090  0.001      0.0090000
## Year                               34  1  0.5879699 0.5879699 1.5807386 0.04707278  0.136      0.3465000
## Month                              34  4  1.3032780 0.3258195 0.8445915 0.10434023  0.731      0.9398571
## Day                                34  3  1.0649549 0.3549850 0.9320696 0.08526012  0.556      0.9398571
## Subject                            34  1  0.5598389 0.5598389 1.5015606 0.04482062  0.154      0.3465000
## ReportedAntibioticUsage            34  1  0.5879699 0.5879699 1.5807386 0.04707278  0.136      0.3465000
## DaysSinceExperimentStart           34  4  1.3032780 0.3258195 0.8445915 0.10434023  0.731      0.9398571
## Description                        34 33 12.4906568 0.3785048 0.0000000 1.00000000  1.000      1.0000000</code></pre>
<p><strong>Results:</strong></p>
<ol style="list-style-type: decimal">
<li><p>The PERMANOVA result of the <em>SampleType</em> (AdjustedPvalue &lt; 0.05) revealed that different groups of SampleType had the distinct patterns of microbial community. From the previous metadata, <em>SampleType</em> had four groups (<em>gut</em>, <em>right palm</em>, <em>left palm</em>, <em>tongue</em>) which are different body sites.</p></li>
<li><p>The other continuous variables such as Year, Day and Month didn’t show any significant association with microbial community.</p></li>
<li><p>We suggest you performing the PERMANOVA test before you do correlation analysis between individual taxa and environmental factors. If the whole microbial community had related to one environmental factor, we could find more associations between individual taxa and environmental factors.</p></li>
<li><p>Ordination analysis is usually utilized for dimensionality reduction and then we decipher their results by using scatterplot. In fact, we should combine the statistical results, for example PERMANOVA, ANOSIM or others and dimension reduction results to provide stronger evidences to display the association and difference.</p></li>
</ol>
</div>
<div id="analysis-of-similarity-anosim" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Analysis of Similarity (ANOSIM)<a href="beta-diversity.html#analysis-of-similarity-anosim" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Analysis of Similarity (ANOSIM)</strong> is simply a modified version of the Mantel Test based on a standardized <em>rank</em> correlation between two distance matrices.</p>
<blockquote>
<p>It is a nonparametric procedure for testing the hypothesis of no difference between two or more groups of samples based on permutation test of among-and within-group similarities.</p>
</blockquote>
<p>The <em>ANOSIM test statistic(R)</em> is based on the difference of mean ranks between groups and within groups. It is given below:</p>
<p><span class="math display">\[R = \frac{\bar{r}_{B} - \bar{r}_{W}}{M/2}\]</span>
where,</p>
<ul>
<li><p><span class="math inline">\(R\)</span> test statistic, is an index of relative within-group dissimilarity;</p></li>
<li><p><span class="math inline">\(M = N(N − 1)/2\)</span> number of sample pairs;</p></li>
<li><p><span class="math inline">\(N\)</span> is the total number of samples (subjects);</p></li>
<li><p><span class="math inline">\(r_{B}\)</span> is the mean of the ranked similarity between groups;</p></li>
<li><p><span class="math inline">\(r_{W}\)</span> is the mean of the ranked similarity within groups.</p></li>
</ul>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="beta-diversity.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;amplicon_ps&quot;</span>)</span>
<span id="cb127-2"><a href="beta-diversity.html#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">run_ANOSIM</span>(amplicon_ps, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>, <span class="at">group =</span> <span class="st">&quot;SampleType&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## vegan::anosim(x = dis, grouping = datphe, permutations = 999) 
## Dissimilarity: bray 
## 
## ANOSIM statistic R: 0.7226 
##       Significance: 0.001 
## 
## Permutation: free
## Number of permutations: 999</code></pre>
<p>The p-value of 0.001 is less than 0.05, which indicates that within-group similarity is greater than between-group similarity at 0.05 significant level. We can conclude that there is strong evidence that the within-group samples are more different than would be expected by random chance.</p>
</div>
<div id="ordination" class="section level2 hasAnchor" number="8.7">
<h2><span class="header-section-number">8.7</span> Ordination<a href="beta-diversity.html#ordination" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ordination is one of the main multivariate methods to reduce the dimensions of taxa–for instance, the whole microbial community often contains too much taxa which makes the microbial profile have too large dimensions. Utilizing ordination to convert the data into two or three dimensions could have more interpretable visualization. Compared to clustering methods, ordination focuses on the dimension reduction and has explanation loss (variation).</p>
<p>We also use a distance method to calculate the distance matrix among samples and then do ordination analysis. Here, we give five universal ordination methods. There is no <em>one-fit-all</em> method for all microbiota data, so please pay attention to your own ordination analysis.</p>
<div id="principal-component-analysis-pca" class="section level3 hasAnchor" number="8.7.1">
<h3><span class="header-section-number">8.7.1</span> Principal Component Analysis (PCA)<a href="beta-diversity.html#principal-component-analysis-pca" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Principal Component Analysis (PCA)</strong> uses a linear combination algorithm to obtain the principal components (PC) (the number of PCs according to the samples). The results have been effected by the normalization methods because different count numbers would affect the PCs. We recommend you using filtering or normalization before performing PCA.</p>
<div id="preprocessing-phyloseq-object" class="section level4 hasAnchor" number="8.7.1.1">
<h4><span class="header-section-number">8.7.1.1</span> Preprocessing phyloseq object<a href="beta-diversity.html#preprocessing-phyloseq-object" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="beta-diversity.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;dada2_ps&quot;</span>)</span>
<span id="cb129-2"><a href="beta-diversity.html#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="beta-diversity.html#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="co"># step1: Removing samples of specific group in phyloseq-class object</span></span>
<span id="cb129-4"><a href="beta-diversity.html#cb129-4" aria-hidden="true" tabindex="-1"></a>dada2_ps_remove_BRS <span class="ot">&lt;-</span> <span class="fu">get_GroupPhyloseq</span>(</span>
<span id="cb129-5"><a href="beta-diversity.html#cb129-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ps =</span> dada2_ps,</span>
<span id="cb129-6"><a href="beta-diversity.html#cb129-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb129-7"><a href="beta-diversity.html#cb129-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group_names =</span> <span class="st">&quot;QC&quot;</span>,</span>
<span id="cb129-8"><a href="beta-diversity.html#cb129-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">discard =</span> <span class="cn">TRUE</span></span>
<span id="cb129-9"><a href="beta-diversity.html#cb129-9" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb129-10"><a href="beta-diversity.html#cb129-10" aria-hidden="true" tabindex="-1"></a>dada2_ps_remove_BRS</span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 896 taxa and 23 samples ]
## sample_data() Sample Data:       [ 23 samples by 1 sample variables ]
## tax_table()   Taxonomy Table:    [ 896 taxa by 7 taxonomic ranks ]
## phy_tree()    Phylogenetic Tree: [ 896 tips and 893 internal nodes ]</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="beta-diversity.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># step2: Extracting specific taxa phyloseq-class object </span></span>
<span id="cb131-2"><a href="beta-diversity.html#cb131-2" aria-hidden="true" tabindex="-1"></a>dada2_ps_genus <span class="ot">&lt;-</span> <span class="fu">summarize_taxa</span>(dada2_ps_remove_BRS, <span class="at">taxa_level =</span> <span class="st">&quot;Genus&quot;</span>, <span class="at">absolute =</span> <span class="cn">TRUE</span>)</span>
<span id="cb131-3"><a href="beta-diversity.html#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="beta-diversity.html#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="co"># step3: Aggregating low relative abundance or unclassified taxa into others</span></span>
<span id="cb131-5"><a href="beta-diversity.html#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="co">#dada2_ps_genus_LRA &lt;- summarize_LowAbundance_taxa(dada2_ps_genus, cutoff = 10, unclass = TRUE)</span></span>
<span id="cb131-6"><a href="beta-diversity.html#cb131-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-7"><a href="beta-diversity.html#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="co"># step4: Filtering the low relative abundance or unclassified taxa by the threshold</span></span>
<span id="cb131-8"><a href="beta-diversity.html#cb131-8" aria-hidden="true" tabindex="-1"></a>dada2_ps_genus_filter <span class="ot">&lt;-</span> <span class="fu">run_filter</span>(dada2_ps_genus, <span class="at">cutoff =</span> <span class="dv">10</span>, <span class="at">unclass =</span> <span class="cn">TRUE</span>)</span>
<span id="cb131-9"><a href="beta-diversity.html#cb131-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-10"><a href="beta-diversity.html#cb131-10" aria-hidden="true" tabindex="-1"></a><span class="co"># step5: Trimming the taxa with low occurrence less than threshold</span></span>
<span id="cb131-11"><a href="beta-diversity.html#cb131-11" aria-hidden="true" tabindex="-1"></a>dada2_ps_genus_filter_trim <span class="ot">&lt;-</span> <span class="fu">run_trim</span>(dada2_ps_genus_filter, <span class="at">cutoff =</span> <span class="fl">0.2</span>, <span class="at">trim =</span> <span class="st">&quot;feature&quot;</span>)</span>
<span id="cb131-12"><a href="beta-diversity.html#cb131-12" aria-hidden="true" tabindex="-1"></a>dada2_ps_genus_filter_trim</span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 100 taxa and 23 samples ]
## sample_data() Sample Data:       [ 23 samples by 1 sample variables ]
## tax_table()   Taxonomy Table:    [ 100 taxa by 6 taxonomic ranks ]</code></pre>
</div>
<div id="running-pca" class="section level4 hasAnchor" number="8.7.1.2">
<h4><span class="header-section-number">8.7.1.2</span> Running PCA<a href="beta-diversity.html#running-pca" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="beta-diversity.html#cb133-1" aria-hidden="true" tabindex="-1"></a>ordination_PCA <span class="ot">&lt;-</span> <span class="fu">run_ordination</span>(</span>
<span id="cb133-2"><a href="beta-diversity.html#cb133-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ps =</span> dada2_ps_genus_filter_trim,</span>
<span id="cb133-3"><a href="beta-diversity.html#cb133-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb133-4"><a href="beta-diversity.html#cb133-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;PCA&quot;</span>)</span>
<span id="cb133-5"><a href="beta-diversity.html#cb133-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-6"><a href="beta-diversity.html#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ordination_PCA)</span></code></pre></div>
<pre><code>## [1] &quot;fit&quot;           &quot;dat&quot;           &quot;explains&quot;      &quot;eigvalue&quot;      &quot;PERMANOVA&quot;     &quot;axis_taxa_cor&quot;</code></pre>
<p>The object of <code>run_ordination</code> is comprising of several results which could be used for visualization.</p>
<ul>
<li><p><em>fit</em>: the result of PCA functions from <code>stats::prcomp</code>;</p></li>
<li><p><em>dat</em>: the combination of PCs score and metadata group information;</p></li>
<li><p><em>explains</em>: the 1st and 2nd PCs’ explains;</p></li>
<li><p><em>eigvalue</em>: the eigvalues of all the PCs;</p></li>
<li><p><em>PERMANOVA</em>: the result of PERMANOVA between the whole microbial community and group;</p></li>
<li><p><em>axis_taxa_cor</em>: inherit from the <code>XVIZ</code> package for visualization (only for PCoA analysis).</p></li>
</ul>
</div>
<div id="visualization" class="section level4 hasAnchor" number="8.7.1.3">
<h4><span class="header-section-number">8.7.1.3</span> Visualization<a href="beta-diversity.html#visualization" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>plot_Ordination</code> provides too many parameters for users to display the ordination results by using ggplot2 format. Here is the ordinary pattern.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="beta-diversity.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_Ordination</span>(<span class="at">ResultList =</span> ordination_PCA, </span>
<span id="cb135-2"><a href="beta-diversity.html#cb135-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb135-3"><a href="beta-diversity.html#cb135-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">circle_type =</span> <span class="st">&quot;ellipse&quot;</span>,</span>
<span id="cb135-4"><a href="beta-diversity.html#cb135-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">sideboxplot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-5"><a href="beta-diversity.html#cb135-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">sidelinechart =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-60"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-60-1.png" alt="Principal Component Analysis (PCA): Ordinary pattern" width="480" />
<p class="caption">
Figure 8.5: Principal Component Analysis (PCA): Ordinary pattern
</p>
</div>
<p><strong>Results:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Scatterplot showed the distribution of samples in the two groups;</p></li>
<li><p>PERMANOVA results revealed that there was no association between the groups and the genus microbial community;</p></li>
<li><p>Sideboxplot of PC1 and PC2 also demonstrated that there were no significant differences between the groups.</p></li>
</ol>
<ul>
<li>plot with SampleID and setting group colors</li>
</ul>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="beta-diversity.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_Ordination</span>(<span class="at">ResultList =</span> ordination_PCA, </span>
<span id="cb136-2"><a href="beta-diversity.html#cb136-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>, </span>
<span id="cb136-3"><a href="beta-diversity.html#cb136-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">group_names =</span> <span class="fu">c</span>(<span class="st">&quot;AA&quot;</span>, <span class="st">&quot;BB&quot;</span>),</span>
<span id="cb136-4"><a href="beta-diversity.html#cb136-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">group_color =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb136-5"><a href="beta-diversity.html#cb136-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">circle_type =</span> <span class="st">&quot;ellipse_groups&quot;</span>,</span>
<span id="cb136-6"><a href="beta-diversity.html#cb136-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">sample =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-61"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-61-1.png" alt="Principal Component Analysis (PCA): Ordinary pattern with SampleID" width="768" />
<p class="caption">
Figure 8.6: Principal Component Analysis (PCA): Ordinary pattern with SampleID
</p>
</div>
<ul>
<li>biplot with topN dominant taxa</li>
</ul>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="beta-diversity.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ggbiplot</span>(<span class="at">ResultList =</span> ordination_PCA,</span>
<span id="cb137-2"><a href="beta-diversity.html#cb137-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb137-3"><a href="beta-diversity.html#cb137-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">group_color =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb137-4"><a href="beta-diversity.html#cb137-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">topN =</span> <span class="dv">5</span>,</span>
<span id="cb137-5"><a href="beta-diversity.html#cb137-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">ellipse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb137-6"><a href="beta-diversity.html#cb137-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">labels =</span> <span class="st">&quot;SampleID&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-62"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-62-1.png" alt="Principal Component Analysis (PCA): biplot" width="576" />
<p class="caption">
Figure 8.7: Principal Component Analysis (PCA): biplot
</p>
</div>
<p><strong>biplot</strong> not only shows the distribution of samples, but also displays correlation among the dominant taxa. We chose top 5 dominant taxa.</p>
<blockquote>
<p>The length of vector approximates standard deviation of variables (bacteria); the angles between variables (bacteria in this case) reflect their correlations: the cosine of angle approximates correlation between variables (bacteria).</p>
</blockquote>
</div>
</div>
<div id="principal-coordinate-analysis-pcoa" class="section level3 hasAnchor" number="8.7.2">
<h3><span class="header-section-number">8.7.2</span> Principal Coordinate Analysis (PCoA)<a href="beta-diversity.html#principal-coordinate-analysis-pcoa" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Principal Coordinate Analysis (PCoA)</strong> could use different distance measures (e.g., Jaccard, Bray-Curtis, Euclidean, etc.) as input for ordination, but pay attention to the data matrix with negative values (not suitable for Bray-Curtis distance).</p>
<blockquote>
<p>As PCA, PCoA uses eigenvalues to measure the importance of a set of returned orthogonal axes. The dimensionality of matrix is reduced by determining each eigenvector and eigenvalue. The principal coordinates are obtained by scaling each eigenvector.</p>
</blockquote>
<div id="running-pcoa" class="section level4 hasAnchor" number="8.7.2.1">
<h4><span class="header-section-number">8.7.2.1</span> Running PCoA<a href="beta-diversity.html#running-pcoa" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Different distance measures could be affected by different factors (eg, low abundance taxa for Bary Curtis distance), so we recommend users taking care for whether performing the preprocess before calculating the distance. Here, we coincided to the tactics of the PCA analysis.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="beta-diversity.html#cb138-1" aria-hidden="true" tabindex="-1"></a>ordination_PCoA <span class="ot">&lt;-</span> <span class="fu">run_ordination</span>(</span>
<span id="cb138-2"><a href="beta-diversity.html#cb138-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ps =</span> dada2_ps_genus_filter_trim,</span>
<span id="cb138-3"><a href="beta-diversity.html#cb138-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb138-4"><a href="beta-diversity.html#cb138-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;PCoA&quot;</span>)</span>
<span id="cb138-5"><a href="beta-diversity.html#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ordination_PCoA)</span></code></pre></div>
<pre><code>## [1] &quot;fit&quot;           &quot;dat&quot;           &quot;explains&quot;      &quot;eigvalue&quot;      &quot;PERMANOVA&quot;     &quot;axis_taxa_cor&quot;</code></pre>
</div>
<div id="visualization-1" class="section level4 hasAnchor" number="8.7.2.2">
<h4><span class="header-section-number">8.7.2.2</span> Visualization<a href="beta-diversity.html#visualization-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>side linechart of XVIZ package</li>
</ul>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="beta-diversity.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_Ordination</span>(ordination_PCoA, </span>
<span id="cb140-2"><a href="beta-diversity.html#cb140-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>, </span>
<span id="cb140-3"><a href="beta-diversity.html#cb140-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">circle_type =</span> <span class="st">&quot;ellipse&quot;</span>,</span>
<span id="cb140-4"><a href="beta-diversity.html#cb140-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">sidelinechart =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-64"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-64-1.png" alt="Principal Coordinate Analysis (PCoA): XVIZ package" width="768" />
<p class="caption">
Figure 8.8: Principal Coordinate Analysis (PCoA): XVIZ package
</p>
</div>
</div>
</div>
<div id="t-distributed-stochastic-neighbor-embedding-t-sne" class="section level3 hasAnchor" number="8.7.3">
<h3><span class="header-section-number">8.7.3</span> t-distributed stochastic neighbor embedding (t-SNE)<a href="beta-diversity.html#t-distributed-stochastic-neighbor-embedding-t-sne" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>t-distributed stochastic neighbor embedding (t-SNE) is a statistical method for visualizing high-dimensional data by giving each datapoint a location in a two or three-dimensional map. It is based on Stochastic Neighbor Embedding originally developed by Sam Roweis and Geoffrey Hinton, where Laurens van der Maaten proposed the t-distributed variant. It is a nonlinear dimensionality reduction technique well-suited for embedding high-dimensional data for visualization in a low-dimensional space of two or three dimensions. Specifically, it models each high-dimensional object by a two- or three-dimensional point in such a way that similar objects are modeled by nearby points and dissimilar objects are modeled by distant points with high probability.</p>
</blockquote>
<div id="running-tsne" class="section level4 hasAnchor" number="8.7.3.1">
<h4><span class="header-section-number">8.7.3.1</span> Running tSNE<a href="beta-diversity.html#running-tsne" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><em>Perplexity</em> parameter is for how many neighbors to be chosen.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="beta-diversity.html#cb141-1" aria-hidden="true" tabindex="-1"></a>ordination_tSNE <span class="ot">&lt;-</span> <span class="fu">run_ordination</span>(</span>
<span id="cb141-2"><a href="beta-diversity.html#cb141-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ps =</span> dada2_ps_genus_filter_trim,</span>
<span id="cb141-3"><a href="beta-diversity.html#cb141-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb141-4"><a href="beta-diversity.html#cb141-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;tSNE&quot;</span>,</span>
<span id="cb141-5"><a href="beta-diversity.html#cb141-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">para =</span><span class="fu">list</span>(<span class="at">Perplexity=</span><span class="dv">2</span>))</span>
<span id="cb141-6"><a href="beta-diversity.html#cb141-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-7"><a href="beta-diversity.html#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ordination_tSNE)</span></code></pre></div>
<pre><code>## [1] &quot;fit&quot;           &quot;dat&quot;           &quot;explains&quot;      &quot;eigvalue&quot;      &quot;PERMANOVA&quot;     &quot;axis_taxa_cor&quot;</code></pre>
</div>
<div id="visualization-2" class="section level4 hasAnchor" number="8.7.3.2">
<h4><span class="header-section-number">8.7.3.2</span> Visualization<a href="beta-diversity.html#visualization-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>plot_Ordination</code> provides too many parameters for users to display the ordination results by using ggplot2 format. Here is the ordinary pattern.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="beta-diversity.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_Ordination</span>(<span class="at">ResultList =</span> ordination_tSNE, </span>
<span id="cb143-2"><a href="beta-diversity.html#cb143-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb143-3"><a href="beta-diversity.html#cb143-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">circle_type =</span> <span class="st">&quot;ellipse&quot;</span>,</span>
<span id="cb143-4"><a href="beta-diversity.html#cb143-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">sideboxplot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-66"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-66-1.png" alt="t-distributed stochastic neighbor embedding (t-SNE): Ordinary pattern" width="480" />
<p class="caption">
Figure 8.9: t-distributed stochastic neighbor embedding (t-SNE): Ordinary pattern
</p>
</div>
</div>
</div>
<div id="uniform-manifold-approximation-and-projection-for-dimension-reduction-umap" class="section level3 hasAnchor" number="8.7.4">
<h3><span class="header-section-number">8.7.4</span> Uniform Manifold Approximation and Projection for Dimension Reduction (UMAP)<a href="beta-diversity.html#uniform-manifold-approximation-and-projection-for-dimension-reduction-umap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Uniform Manifold Approximation and Projection (UMAP) <span class="citation">(<a href="#ref-mcinnes2022uniform" role="doc-biblioref">McInnes et al. 2022</a>)</span> is a dimension reduction technique that can be used for visualisation similarly to t-SNE, but also for general non-linear dimension reduction. The algorithm is founded on three assumptions about the data.</p>
</blockquote>
<div id="running-umap" class="section level4 hasAnchor" number="8.7.4.1">
<h4><span class="header-section-number">8.7.4.1</span> Running UMAP<a href="beta-diversity.html#running-umap" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="beta-diversity.html#cb144-1" aria-hidden="true" tabindex="-1"></a>ordination_UMAP <span class="ot">&lt;-</span> <span class="fu">run_ordination</span>(</span>
<span id="cb144-2"><a href="beta-diversity.html#cb144-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ps =</span> dada2_ps_genus_filter_trim,</span>
<span id="cb144-3"><a href="beta-diversity.html#cb144-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb144-4"><a href="beta-diversity.html#cb144-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;UMAP&quot;</span>)</span>
<span id="cb144-5"><a href="beta-diversity.html#cb144-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-6"><a href="beta-diversity.html#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ordination_UMAP)</span></code></pre></div>
<pre><code>## [1] &quot;fit&quot;           &quot;dat&quot;           &quot;explains&quot;      &quot;eigvalue&quot;      &quot;PERMANOVA&quot;     &quot;axis_taxa_cor&quot;</code></pre>
</div>
<div id="visualization-3" class="section level4 hasAnchor" number="8.7.4.2">
<h4><span class="header-section-number">8.7.4.2</span> Visualization<a href="beta-diversity.html#visualization-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>plot_Ordination</code> provides too many parameters for users to display the ordination results by using ggplot2 format. Here is the ordinary pattern.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="beta-diversity.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_Ordination</span>(<span class="at">ResultList =</span> ordination_UMAP, </span>
<span id="cb146-2"><a href="beta-diversity.html#cb146-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb146-3"><a href="beta-diversity.html#cb146-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">circle_type =</span> <span class="st">&quot;ellipse&quot;</span>,</span>
<span id="cb146-4"><a href="beta-diversity.html#cb146-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">sideboxplot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-68"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-68-1.png" alt="Uniform Manifold Approximation and Projection for Dimension Reduction (UMAP): Ordinary pattern" width="480" />
<p class="caption">
Figure 8.10: Uniform Manifold Approximation and Projection for Dimension Reduction (UMAP): Ordinary pattern
</p>
</div>
</div>
</div>
</div>
<div id="systematic-information-5" class="section level2 hasAnchor" number="8.8">
<h2><span class="header-section-number">8.8</span> Systematic Information<a href="beta-diversity.html#systematic-information-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="beta-diversity.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.1.2 (2021-11-01)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Monterey 12.2.1
## 
## Matrix products: default
## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] ggpubr_0.4.0    ggplot2_3.3.5   phyloseq_1.38.0 tibble_3.1.6    dplyr_1.0.8     XMAS_2.1.0     
## 
## loaded via a namespace (and not attached):
##   [1] utf8_1.2.2                  reticulate_1.24             tidyselect_1.1.2            RSQLite_2.2.10             
##   [5] AnnotationDbi_1.56.2        htmlwidgets_1.5.4           grid_4.1.2                  BiocParallel_1.28.3        
##   [9] Rtsne_0.15                  munsell_0.5.0               codetools_0.2-18            umap_0.2.8.0               
##  [13] withr_2.5.0                 colorspace_2.0-3            Biobase_2.54.0              highr_0.9                  
##  [17] knitr_1.37                  rstudioapi_0.13             stats4_4.1.2                robustbase_0.93-9          
##  [21] ggsignif_0.6.3              MatrixGenerics_1.6.0        labeling_0.4.2              optparse_1.7.1             
##  [25] GenomeInfoDbData_1.2.7      lpsymphony_1.22.0           bit64_4.0.5                 farver_2.1.0               
##  [29] rhdf5_2.38.1                vctrs_0.3.8                 generics_0.1.2              TH.data_1.1-0              
##  [33] xfun_0.30                   Maaslin2_1.8.0              R6_2.5.1                    GenomeInfoDb_1.30.1        
##  [37] locfit_1.5-9.5              bitops_1.0-7                rhdf5filters_1.6.0          cachem_1.0.6               
##  [41] DelayedArray_0.20.0         assertthat_0.2.1            scales_1.1.1                multcomp_1.4-18            
##  [45] nnet_7.3-17                 gtable_0.3.0                sandwich_3.0-1              rlang_1.0.2                
##  [49] genefilter_1.76.0           splines_4.1.2               protoclust_1.6.3            rstatix_0.7.0              
##  [53] broom_0.7.12                checkmate_2.0.0             yaml_2.3.5                  reshape2_1.4.4             
##  [57] abind_1.4-5                 backports_1.4.1             qvalue_2.26.0               Hmisc_4.6-0                
##  [61] tools_4.1.2                 bookdown_0.24               ellipsis_0.3.2              gplots_3.1.1               
##  [65] jquerylib_0.1.4             biomformat_1.22.0           RColorBrewer_1.1-2          BiocGenerics_0.40.0        
##  [69] Rcpp_1.0.8.2                plyr_1.8.6                  base64enc_0.1-3             zlibbioc_1.40.0            
##  [73] purrr_0.3.4                 RCurl_1.98-1.6              rpart_4.1.16                openssl_2.0.0              
##  [77] Wrench_1.12.0               cowplot_1.1.1               S4Vectors_0.32.3            zoo_1.8-9                  
##  [81] SummarizedExperiment_1.24.0 ggrepel_0.9.1               cluster_2.1.2               magrittr_2.0.2             
##  [85] data.table_1.14.2           RSpectra_0.16-0             mvtnorm_1.1-3               matrixStats_0.61.0         
##  [89] corncob_0.2.0               RAIDA_1.0                   evaluate_0.15               xtable_1.8-4               
##  [93] XML_3.99-0.9                jpeg_0.1-9                  IRanges_2.28.0              gridExtra_2.3              
##  [97] shape_1.4.6                 compiler_4.1.2              KernSmooth_2.23-20          crayon_1.5.0               
## [101] htmltools_0.5.2             mgcv_1.8-39                 pcaPP_1.9-74                Formula_1.2-4              
## [105] tidyr_1.2.0                 geneplotter_1.72.0          libcoin_1.0-9               DBI_1.1.2                  
## [109] corrplot_0.92               biglm_0.9-2.1               MASS_7.3-55                 Matrix_1.4-0               
## [113] ade4_1.7-18                 getopt_1.20.3               car_3.0-12                  permute_0.9-7              
## [117] cli_3.2.0                   parallel_4.1.2              igraph_1.2.11               GenomicRanges_1.46.1       
## [121] pkgconfig_2.0.3             coin_1.4-2                  foreign_0.8-82              foreach_1.5.2              
## [125] annotate_1.72.0             bslib_0.3.1                 multtest_2.50.0             XVector_0.34.0             
## [129] stringr_1.4.0               digest_0.6.29               vegan_2.5-7                 Biostrings_2.62.0          
## [133] rmarkdown_2.13              htmlTable_2.4.0             edgeR_3.36.0                gtools_3.9.2               
## [137] modeltools_0.2-23           lifecycle_1.0.1             nlme_3.1-155                jsonlite_1.8.0             
## [141] Rhdf5lib_1.16.0             carData_3.0-5               askpass_1.1                 limma_3.50.1               
## [145] fansi_1.0.2                 pillar_1.7.0                lattice_0.20-45             KEGGREST_1.34.0            
## [149] fastmap_1.1.0               httr_1.4.2                  DEoptimR_1.0-10             survival_3.3-1             
## [153] glue_1.6.2                  png_0.1-7                   iterators_1.0.14            glmnet_4.1-3               
## [157] bit_4.0.4                   stringi_1.7.6               sass_0.4.0                  metagenomeSeq_1.36.0       
## [161] blob_1.2.2                  DESeq2_1.34.0               latticeExtra_0.6-29         caTools_1.18.2             
## [165] memoise_2.0.1               ape_5.6-2</code></pre>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-anderson2014permutational" class="csl-entry">
Anderson, Marti J. 2014. <span>“Permutational Multivariate Analysis of Variance (PERMANOVA).”</span> <em>Wiley Statsref: Statistics Reference Online</em>, 1–15.
</div>
<div id="ref-chen2012associating" class="csl-entry">
Chen, Jun, Kyle Bittinger, Emily S Charlson, Christian Hoffmann, James Lewis, Gary D Wu, Ronald G Collman, Frederic D Bushman, and Hongzhe Li. 2012. <span>“Associating Microbiome Composition with Environmental Covariates Using Generalized UniFrac Distances.”</span> <em>Bioinformatics</em> 28 (16): 2106–13.
</div>
<div id="ref-mcinnes2022uniform" class="csl-entry">
McInnes, L et al. 2022. <span>“Uniform Manifold Approximation and Projection for Dimension Reduction.”</span> <em>arXiv Preprint arXiv:1802.03426</em>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="aplha-diversity.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="composition.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/XbiomeAnalysis/XMAS_tutorial/blob/main/07-beta-diversity.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Data analysis based on XMAS package.pdf", "Data analysis based on XMAS package.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
