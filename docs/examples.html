<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Examples | Data analysis based on XMAS 2.0 package in microbiota data</title>
  <meta name="description" content="A tutorial of XMAS 2.0 package for in-house training" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Examples | Data analysis based on XMAS 2.0 package in microbiota data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A tutorial of XMAS 2.0 package for in-house training" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Examples | Data analysis based on XMAS 2.0 package in microbiota data" />
  
  <meta name="twitter:description" content="A tutorial of XMAS 2.0 package for in-house training" />
  

<meta name="author" content="Hua Zou" />


<meta name="date" content="2022-05-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="differential-analysis.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.13/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.21/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.9/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data analysis based on XMAS 2.0 package</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#preparing-for-the-tutorial"><i class="fa fa-check"></i><b>1.1</b> Preparing for the tutorial<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#microbiome"><i class="fa fa-check"></i><b>2.1</b> Microbiome<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#sequencing-technology"><i class="fa fa-check"></i><b>2.2</b> Sequencing technology<span></span></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction.html"><a href="introduction.html#amplicon-sequencing"><i class="fa fa-check"></i><b>2.2.1</b> Amplicon sequencing<span></span></a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction.html"><a href="introduction.html#whole-genome-shotgun-sequencing"><i class="fa fa-check"></i><b>2.2.2</b> Whole genome shotgun sequencing<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#the-gut-microbiome-relationships-with-disease-and-opportunities-for-therapy"><i class="fa fa-check"></i><b>2.3</b> The gut microbiome: Relationships with disease and opportunities for therapy<span></span></a></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#data-analysis-apply-for-discovering-the-potential-microbial-biomarkers"><i class="fa fa-check"></i><b>2.4</b> Data Analysis apply for discovering the potential microbial biomarkers<span></span></a></li>
<li class="chapter" data-level="2.5" data-path="introduction.html"><a href="introduction.html#book"><i class="fa fa-check"></i><b>2.5</b> Book<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html"><i class="fa fa-check"></i><b>3</b> Material in this tutorial<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#resources"><i class="fa fa-check"></i><b>3.1</b> Resources<span></span></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#dada2"><i class="fa fa-check"></i><b>3.1.1</b> DADA2<span></span></a></li>
<li class="chapter" data-level="3.1.2" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#metaphlan2"><i class="fa fa-check"></i><b>3.1.2</b> Metaphlan2<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#overview-of-the-design-of-xmas-package"><i class="fa fa-check"></i><b>3.2</b> Overview of the design of <strong>XMAS</strong> package<span></span></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#description"><i class="fa fa-check"></i><b>3.2.1</b> Description<span></span></a></li>
<li class="chapter" data-level="3.2.2" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#installation-of-dependent-packages"><i class="fa fa-check"></i><b>3.2.2</b> Installation of dependent packages<span></span></a></li>
<li class="chapter" data-level="3.2.3" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#installation"><i class="fa fa-check"></i><b>3.2.3</b> Installation<span></span></a></li>
<li class="chapter" data-level="3.2.4" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#vignette"><i class="fa fa-check"></i><b>3.2.4</b> Vignette<span></span></a></li>
<li class="chapter" data-level="3.2.5" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#authors"><i class="fa fa-check"></i><b>3.2.5</b> Authors<span></span></a></li>
<li class="chapter" data-level="3.2.6" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#library-package"><i class="fa fa-check"></i><b>3.2.6</b> library package<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#future-plan"><i class="fa fa-check"></i><b>3.3</b> Future plan<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="material-in-this-tutorial.html"><a href="material-in-this-tutorial.html#systematic-information"><i class="fa fa-check"></i><b>3.4</b> Systematic Information<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="convert-inputdata-into-phyloseq-object.html"><a href="convert-inputdata-into-phyloseq-object.html"><i class="fa fa-check"></i><b>4</b> Convert inputdata into phyloseq object<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="convert-inputdata-into-phyloseq-object.html"><a href="convert-inputdata-into-phyloseq-object.html#loading-packages"><i class="fa fa-check"></i><b>4.1</b> loading packages<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="convert-inputdata-into-phyloseq-object.html"><a href="convert-inputdata-into-phyloseq-object.html#dada2-1"><i class="fa fa-check"></i><b>4.2</b> DADA2<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="convert-inputdata-into-phyloseq-object.html"><a href="convert-inputdata-into-phyloseq-object.html#metaphlan23"><i class="fa fa-check"></i><b>4.3</b> Metaphlan2/3<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="convert-inputdata-into-phyloseq-object.html"><a href="convert-inputdata-into-phyloseq-object.html#systematic-information-1"><i class="fa fa-check"></i><b>4.4</b> Systematic Information<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="quality-evaluation.html"><a href="quality-evaluation.html"><i class="fa fa-check"></i><b>5</b> Quality Evaluation<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="quality-evaluation.html"><a href="quality-evaluation.html#reads-track"><i class="fa fa-check"></i><b>5.1</b> Reads’ track<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="quality-evaluation.html"><a href="quality-evaluation.html#spike-in-brs-sample-assessment"><i class="fa fa-check"></i><b>5.2</b> Spike-in (BRS) sample assessment<span></span></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="quality-evaluation.html"><a href="quality-evaluation.html#s-data"><i class="fa fa-check"></i><b>5.2.1</b> 16s data<span></span></a></li>
<li class="chapter" data-level="5.2.2" data-path="quality-evaluation.html"><a href="quality-evaluation.html#metagenomic-data"><i class="fa fa-check"></i><b>5.2.2</b> Metagenomic data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="quality-evaluation.html"><a href="quality-evaluation.html#rarefaction-curves"><i class="fa fa-check"></i><b>5.3</b> Rarefaction Curves<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="quality-evaluation.html"><a href="quality-evaluation.html#summarize-phyloseq-class-object"><i class="fa fa-check"></i><b>5.4</b> Summarize phyloseq-class object<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="quality-evaluation.html"><a href="quality-evaluation.html#systematic-information-2"><i class="fa fa-check"></i><b>5.5</b> Systematic Information<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="pre-processing.html"><a href="pre-processing.html"><i class="fa fa-check"></i><b>6</b> Pre-processing<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="pre-processing.html"><a href="pre-processing.html#transformation"><i class="fa fa-check"></i><b>6.1</b> Transformation<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="pre-processing.html"><a href="pre-processing.html#normalization"><i class="fa fa-check"></i><b>6.2</b> Normalization<span></span></a></li>
<li class="chapter" data-level="6.3" data-path="pre-processing.html"><a href="pre-processing.html#filtering"><i class="fa fa-check"></i><b>6.3</b> Filtering<span></span></a></li>
<li class="chapter" data-level="6.4" data-path="pre-processing.html"><a href="pre-processing.html#trimming"><i class="fa fa-check"></i><b>6.4</b> Trimming<span></span></a></li>
<li class="chapter" data-level="6.5" data-path="pre-processing.html"><a href="pre-processing.html#imputation"><i class="fa fa-check"></i><b>6.5</b> Imputation<span></span></a></li>
<li class="chapter" data-level="6.6" data-path="pre-processing.html"><a href="pre-processing.html#extracting-specific-taxa-phyloseq-class-object"><i class="fa fa-check"></i><b>6.6</b> Extracting specific taxa phyloseq-class object<span></span></a></li>
<li class="chapter" data-level="6.7" data-path="pre-processing.html"><a href="pre-processing.html#aggregating-low-relative-abundance-or-unclassified-taxa-into-others"><i class="fa fa-check"></i><b>6.7</b> Aggregating low relative abundance or unclassified taxa into others<span></span></a></li>
<li class="chapter" data-level="6.8" data-path="pre-processing.html"><a href="pre-processing.html#removing-samples-of-specific-group-in-phyloseq-class-object"><i class="fa fa-check"></i><b>6.8</b> Removing samples of specific group in phyloseq-class object<span></span></a></li>
<li class="chapter" data-level="6.9" data-path="pre-processing.html"><a href="pre-processing.html#checking-samples-name-whether-start-with-character"><i class="fa fa-check"></i><b>6.9</b> Checking samples’ name whether start with character<span></span></a></li>
<li class="chapter" data-level="6.10" data-path="pre-processing.html"><a href="pre-processing.html#systematic-information-3"><i class="fa fa-check"></i><b>6.10</b> Systematic Information<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="aplha-diversity.html"><a href="aplha-diversity.html"><i class="fa fa-check"></i><b>7</b> Aplha diversity<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="aplha-diversity.html"><a href="aplha-diversity.html#equal-sample-sums"><i class="fa fa-check"></i><b>7.1</b> Equal sample sums<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="aplha-diversity.html"><a href="aplha-diversity.html#diversities"><i class="fa fa-check"></i><b>7.2</b> Diversities<span></span></a></li>
<li class="chapter" data-level="7.3" data-path="aplha-diversity.html"><a href="aplha-diversity.html#rank-abundance"><i class="fa fa-check"></i><b>7.3</b> Rank Abundance<span></span></a></li>
<li class="chapter" data-level="7.4" data-path="aplha-diversity.html"><a href="aplha-diversity.html#systematic-information-4"><i class="fa fa-check"></i><b>7.4</b> Systematic Information<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="beta-diversity.html"><a href="beta-diversity.html"><i class="fa fa-check"></i><b>8</b> Beta diversity<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="beta-diversity.html"><a href="beta-diversity.html#phylogenetic-beta-diversity-metrics"><i class="fa fa-check"></i><b>8.1</b> Phylogenetic beta-diversity metrics<span></span></a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="beta-diversity.html"><a href="beta-diversity.html#unweighted-unifrac"><i class="fa fa-check"></i><b>8.1.1</b> Unweighted Unifrac<span></span></a></li>
<li class="chapter" data-level="8.1.2" data-path="beta-diversity.html"><a href="beta-diversity.html#weighted-unifrac"><i class="fa fa-check"></i><b>8.1.2</b> Weighted Unifrac<span></span></a></li>
<li class="chapter" data-level="8.1.3" data-path="beta-diversity.html"><a href="beta-diversity.html#generalized-unifrac-distance-metrics"><i class="fa fa-check"></i><b>8.1.3</b> Generalized UniFrac Distance Metrics<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="beta-diversity.html"><a href="beta-diversity.html#distance-dissimilarity-coefficients-bray-curtis-index"><i class="fa fa-check"></i><b>8.2</b> Distance (Dissimilarity) Coefficients: Bray-Curtis Index<span></span></a></li>
<li class="chapter" data-level="8.3" data-path="beta-diversity.html"><a href="beta-diversity.html#checking-the-homogeneity-condition"><i class="fa fa-check"></i><b>8.3</b> Checking the homogeneity condition<span></span></a></li>
<li class="chapter" data-level="8.4" data-path="beta-diversity.html"><a href="beta-diversity.html#permutational-multivariate-analysis-of-variance-permanova"><i class="fa fa-check"></i><b>8.4</b> Permutational Multivariate Analysis of Variance (PERMANOVA)<span></span></a></li>
<li class="chapter" data-level="8.5" data-path="beta-diversity.html"><a href="beta-diversity.html#analysis-of-similarity-anosim"><i class="fa fa-check"></i><b>8.5</b> Analysis of Similarity (ANOSIM)<span></span></a></li>
<li class="chapter" data-level="8.6" data-path="beta-diversity.html"><a href="beta-diversity.html#ordination"><i class="fa fa-check"></i><b>8.6</b> Ordination<span></span></a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="beta-diversity.html"><a href="beta-diversity.html#principal-component-analysis-pca"><i class="fa fa-check"></i><b>8.6.1</b> Principal Component Analysis (PCA)<span></span></a></li>
<li class="chapter" data-level="8.6.2" data-path="beta-diversity.html"><a href="beta-diversity.html#principal-coordinate-analysis-pcoa"><i class="fa fa-check"></i><b>8.6.2</b> Principal Coordinate Analysis (PCoA)<span></span></a></li>
<li class="chapter" data-level="8.6.3" data-path="beta-diversity.html"><a href="beta-diversity.html#t-distributed-stochastic-neighbor-embedding-t-sne"><i class="fa fa-check"></i><b>8.6.3</b> t-distributed stochastic neighbor embedding (t-SNE)<span></span></a></li>
<li class="chapter" data-level="8.6.4" data-path="beta-diversity.html"><a href="beta-diversity.html#uniform-manifold-approximation-and-projection-for-dimension-reduction-umap"><i class="fa fa-check"></i><b>8.6.4</b> Uniform Manifold Approximation and Projection for Dimension Reduction (UMAP)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="beta-diversity.html"><a href="beta-diversity.html#systematic-information-5"><i class="fa fa-check"></i><b>8.7</b> Systematic Information<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="composition.html"><a href="composition.html"><i class="fa fa-check"></i><b>9</b> Composition<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="composition.html"><a href="composition.html#loading-precessing-phyloseq-object"><i class="fa fa-check"></i><b>9.1</b> Loading &amp; precessing phyloseq object<span></span></a></li>
<li class="chapter" data-level="9.2" data-path="composition.html"><a href="composition.html#stacked-barplot"><i class="fa fa-check"></i><b>9.2</b> Stacked barplot<span></span></a></li>
<li class="chapter" data-level="9.3" data-path="composition.html"><a href="composition.html#heatmaps"><i class="fa fa-check"></i><b>9.3</b> Heatmaps<span></span></a></li>
<li class="chapter" data-level="9.4" data-path="composition.html"><a href="composition.html#systematic-information-6"><i class="fa fa-check"></i><b>9.4</b> Systematic Information<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="core-microbiota.html"><a href="core-microbiota.html"><i class="fa fa-check"></i><b>10</b> Core microbiota<span></span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="core-microbiota.html"><a href="core-microbiota.html#core-microbiota-anlaysis"><i class="fa fa-check"></i><b>10.1</b> Core microbiota anlaysis<span></span></a></li>
<li class="chapter" data-level="10.2" data-path="core-microbiota.html"><a href="core-microbiota.html#core-abundance-and-diversity"><i class="fa fa-check"></i><b>10.2</b> Core abundance and diversity<span></span></a></li>
<li class="chapter" data-level="10.3" data-path="core-microbiota.html"><a href="core-microbiota.html#core-visualization"><i class="fa fa-check"></i><b>10.3</b> Core visualization<span></span></a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="core-microbiota.html"><a href="core-microbiota.html#heatmap"><i class="fa fa-check"></i><b>10.3.1</b> heatmap<span></span></a></li>
<li class="chapter" data-level="10.3.2" data-path="core-microbiota.html"><a href="core-microbiota.html#linechart"><i class="fa fa-check"></i><b>10.3.2</b> linechart<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="core-microbiota.html"><a href="core-microbiota.html#systematic-information-7"><i class="fa fa-check"></i><b>10.4</b> Systematic Information<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="differential-analysis.html"><a href="differential-analysis.html"><i class="fa fa-check"></i><b>11</b> Differential analysis<span></span></a>
<ul>
<li class="chapter" data-level="11.1" data-path="differential-analysis.html"><a href="differential-analysis.html#amplicon-sequencing-microbial-data-16s"><i class="fa fa-check"></i><b>11.1</b> Amplicon sequencing microbial data (16s)<span></span></a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="differential-analysis.html"><a href="differential-analysis.html#aldex2"><i class="fa fa-check"></i><b>11.1.1</b> ALDEx2<span></span></a></li>
<li class="chapter" data-level="11.1.2" data-path="differential-analysis.html"><a href="differential-analysis.html#limma_voom"><i class="fa fa-check"></i><b>11.1.2</b> limma_voom<span></span></a></li>
<li class="chapter" data-level="11.1.3" data-path="differential-analysis.html"><a href="differential-analysis.html#mbzinb"><i class="fa fa-check"></i><b>11.1.3</b> mbzinb<span></span></a></li>
<li class="chapter" data-level="11.1.4" data-path="differential-analysis.html"><a href="differential-analysis.html#omnibus"><i class="fa fa-check"></i><b>11.1.4</b> omnibus<span></span></a></li>
<li class="chapter" data-level="11.1.5" data-path="differential-analysis.html"><a href="differential-analysis.html#raida"><i class="fa fa-check"></i><b>11.1.5</b> RAIDA<span></span></a></li>
<li class="chapter" data-level="11.1.6" data-path="differential-analysis.html"><a href="differential-analysis.html#wilcoxon-rank-sum-and-signed-rank-tests"><i class="fa fa-check"></i><b>11.1.6</b> Wilcoxon Rank Sum and Signed Rank Tests<span></span></a></li>
<li class="chapter" data-level="11.1.7" data-path="differential-analysis.html"><a href="differential-analysis.html#liner-discriminant-analysis-lda-effect-size-lefse"><i class="fa fa-check"></i><b>11.1.7</b> Liner discriminant analysis (LDA) effect size (LEfSe)<span></span></a></li>
<li class="chapter" data-level="11.1.8" data-path="differential-analysis.html"><a href="differential-analysis.html#t-test"><i class="fa fa-check"></i><b>11.1.8</b> t-test<span></span></a></li>
<li class="chapter" data-level="11.1.9" data-path="differential-analysis.html"><a href="differential-analysis.html#metagenomeseq"><i class="fa fa-check"></i><b>11.1.9</b> MetagenomeSeq<span></span></a></li>
<li class="chapter" data-level="11.1.10" data-path="differential-analysis.html"><a href="differential-analysis.html#deseq2"><i class="fa fa-check"></i><b>11.1.10</b> DESeq2<span></span></a></li>
<li class="chapter" data-level="11.1.11" data-path="differential-analysis.html"><a href="differential-analysis.html#edger"><i class="fa fa-check"></i><b>11.1.11</b> EdgeR<span></span></a></li>
<li class="chapter" data-level="11.1.12" data-path="differential-analysis.html"><a href="differential-analysis.html#ancom"><i class="fa fa-check"></i><b>11.1.12</b> ANCOM<span></span></a></li>
<li class="chapter" data-level="11.1.13" data-path="differential-analysis.html"><a href="differential-analysis.html#corncob"><i class="fa fa-check"></i><b>11.1.13</b> Corncob<span></span></a></li>
<li class="chapter" data-level="11.1.14" data-path="differential-analysis.html"><a href="differential-analysis.html#maaslin2-microbiome-multivariable-association-with-linear-models"><i class="fa fa-check"></i><b>11.1.14</b> Maaslin2 (Microbiome Multivariable Association with Linear Models)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="differential-analysis.html"><a href="differential-analysis.html#metagenomic-sequencing-microbial-data-metaphlan23"><i class="fa fa-check"></i><b>11.2</b> Metagenomic sequencing microbial data (metaphlan2/3)<span></span></a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="differential-analysis.html"><a href="differential-analysis.html#limma_voom-1"><i class="fa fa-check"></i><b>11.2.1</b> limma_voom<span></span></a></li>
<li class="chapter" data-level="11.2.2" data-path="differential-analysis.html"><a href="differential-analysis.html#wilcoxon-rank-sum-and-signed-rank-tests-1"><i class="fa fa-check"></i><b>11.2.2</b> Wilcoxon Rank Sum and Signed Rank Tests<span></span></a></li>
<li class="chapter" data-level="11.2.3" data-path="differential-analysis.html"><a href="differential-analysis.html#liner-discriminant-analysis-lda-effect-size-lefse-1"><i class="fa fa-check"></i><b>11.2.3</b> Liner discriminant analysis (LDA) effect size (LEfSe)<span></span></a></li>
<li class="chapter" data-level="11.2.4" data-path="differential-analysis.html"><a href="differential-analysis.html#t-test-1"><i class="fa fa-check"></i><b>11.2.4</b> t-test<span></span></a></li>
<li class="chapter" data-level="11.2.5" data-path="differential-analysis.html"><a href="differential-analysis.html#maaslin2-microbiome-multivariable-association-with-linear-models-1"><i class="fa fa-check"></i><b>11.2.5</b> Maaslin2 (Microbiome Multivariable Association with Linear Models)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="differential-analysis.html"><a href="differential-analysis.html#visualization-4"><i class="fa fa-check"></i><b>11.3</b> Visualization<span></span></a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="differential-analysis.html"><a href="differential-analysis.html#volcano-plot"><i class="fa fa-check"></i><b>11.3.1</b> Volcano plot<span></span></a></li>
<li class="chapter" data-level="11.3.2" data-path="differential-analysis.html"><a href="differential-analysis.html#barplot-in-lefse"><i class="fa fa-check"></i><b>11.3.2</b> barplot in lefse<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="differential-analysis.html"><a href="differential-analysis.html#dominant-taxa"><i class="fa fa-check"></i><b>11.4</b> Dominant taxa<span></span></a></li>
<li class="chapter" data-level="11.5" data-path="differential-analysis.html"><a href="differential-analysis.html#systematic-information-8"><i class="fa fa-check"></i><b>11.5</b> Systematic Information<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>12</b> Examples<span></span></a>
<ul>
<li class="chapter" data-level="12.1" data-path="examples.html"><a href="examples.html#workflow-description"><i class="fa fa-check"></i><b>12.1</b> Workflow description<span></span></a></li>
<li class="chapter" data-level="12.2" data-path="examples.html"><a href="examples.html#amplicon-sequencing-16s"><i class="fa fa-check"></i><b>12.2</b> Amplicon sequencing (16s)<span></span></a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="examples.html"><a href="examples.html#converting-inputs-into-phyloseq-class-object"><i class="fa fa-check"></i><b>12.2.1</b> Converting inputs into phyloseq-class object<span></span></a></li>
<li class="chapter" data-level="12.2.2" data-path="examples.html"><a href="examples.html#quality-control"><i class="fa fa-check"></i><b>12.2.2</b> Quality Control<span></span></a></li>
<li class="chapter" data-level="12.2.3" data-path="examples.html"><a href="examples.html#data-processing"><i class="fa fa-check"></i><b>12.2.3</b> Data processing<span></span></a></li>
<li class="chapter" data-level="12.2.4" data-path="examples.html"><a href="examples.html#diversity-analysis"><i class="fa fa-check"></i><b>12.2.4</b> Diversity analysis<span></span></a></li>
<li class="chapter" data-level="12.2.5" data-path="examples.html"><a href="examples.html#permanova-ordination"><i class="fa fa-check"></i><b>12.2.5</b> PERMANOVA + Ordination<span></span></a></li>
<li class="chapter" data-level="12.2.6" data-path="examples.html"><a href="examples.html#microbial-composition"><i class="fa fa-check"></i><b>12.2.6</b> Microbial composition<span></span></a></li>
<li class="chapter" data-level="12.2.7" data-path="examples.html"><a href="examples.html#differential-analysis-1"><i class="fa fa-check"></i><b>12.2.7</b> Differential Analysis<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="examples.html"><a href="examples.html#metagenomics"><i class="fa fa-check"></i><b>12.3</b> Metagenomics<span></span></a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="examples.html"><a href="examples.html#converting-inputs-into-phyloseq-class-object-1"><i class="fa fa-check"></i><b>12.3.1</b> Converting inputs into phyloseq-class object<span></span></a></li>
<li class="chapter" data-level="12.3.2" data-path="examples.html"><a href="examples.html#quality-control-1"><i class="fa fa-check"></i><b>12.3.2</b> Quality Control<span></span></a></li>
<li class="chapter" data-level="12.3.3" data-path="examples.html"><a href="examples.html#data-processing-1"><i class="fa fa-check"></i><b>12.3.3</b> Data processing<span></span></a></li>
<li class="chapter" data-level="12.3.4" data-path="examples.html"><a href="examples.html#diversity-analysis-1"><i class="fa fa-check"></i><b>12.3.4</b> Diversity analysis<span></span></a></li>
<li class="chapter" data-level="12.3.5" data-path="examples.html"><a href="examples.html#permanova-ordination-1"><i class="fa fa-check"></i><b>12.3.5</b> PERMANOVA + Ordination<span></span></a></li>
<li class="chapter" data-level="12.3.6" data-path="examples.html"><a href="examples.html#microbial-composition-1"><i class="fa fa-check"></i><b>12.3.6</b> Microbial composition<span></span></a></li>
<li class="chapter" data-level="12.3.7" data-path="examples.html"><a href="examples.html#differential-analysis-2"><i class="fa fa-check"></i><b>12.3.7</b> Differential Analysis<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="references.html#references">References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data analysis based on XMAS 2.0 package in microbiota data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="examples" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Chapter 12</span> Examples<a href="examples.html#examples" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Here, we give users two examples to practice the data analysis workflow by <strong>XMAS 2.0</strong>. By the way, we also recommend users handling your own microbiota data in a reasonable manner when you utilize this package or workflow. Pay attention to whether your data fit the methods this package provided.</p>
<p><strong>Loading packages</strong></p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="examples.html#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(XMAS)</span>
<span id="cb273-2"><a href="examples.html#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb273-3"><a href="examples.html#cb273-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb273-4"><a href="examples.html#cb273-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phyloseq)</span>
<span id="cb273-5"><a href="examples.html#cb273-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb273-6"><a href="examples.html#cb273-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span></code></pre></div>
<div id="workflow-description" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Workflow description<a href="examples.html#workflow-description" class="anchor-section" aria-label="Anchor link to header"></a></h2>
The standard data analysis of 16S and MGS data by <strong>XMAS 2.0</strong>.
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-140"></span>
<div id="htmlwidget-1a3c387efb410694fae2" style="width:672px;height:768px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-1a3c387efb410694fae2">{"x":{"diagram":"digraph flowchart { \n\n# initiate graph\ngraph [layout = dot, rankdir = TB, label = \"[dada2_res|metadata|tree]\n\n\", labelloc = t]\n\n\n# global node settings\nnode [shape = rectangle, style = filled, fillcolor = Linen, fontname = arial, width = 4]\n \ntab1 [label = \"Importing data: import_dada2()/summarize_phyloseq()\"]  \ntab2 [label = \"Quality Control(Rarefaction curves): plot_RarefCure()\"]  \ntab3 [label = \"Quality Control(Reads Track): plot_Dada2Track()\"]\ntab4 [label = \"Quality Control(RefCheck/Remove): summarize_taxa()/run_RefCheck()/get_GroupPhyloseq()\"]  \ntab5 [label = \"Quality Control(Variability): plot_taxa_cv()/plot_read_distribution()\"]  \ntab6 [label = \"Data processing(Rarefy): normalize()\"]\ntab7 [label = \"Data processing(Extract specific taxonomic level): summarize_taxa()\"]  \ntab8 [label = \"Data processing(Count2Relative): summarize_taxa(absolute = FALSE)\"]  \ntab9 [label = \"Data processing(Filter&trim): run_filter()/run_trim()\"]\ntab10 [label = \"GlobalView(Alpha diveristy): run_alpha_diversity()/plot_boxplot()\"]  \ntab11 [label = \"GlobalView(Beta diveristy): run_beta_diversity()/run_permanova()/run_ordination()/plot_Ordination()\"]  \ntab12 [label = \"GlobalView(microbial composition): plot_StackBarPlot()/plot_core_taxa()/core_members()\"]\ntab13 [label = \"DifferentialAnalysis: run_lefse()/plot_lefse()/run_wilcox()/plot_volcano()\"] \n \ntab1 -> tab2 -> tab3 -> tab4 -> tab5 -> tab6 -> tab7 -> tab8 -> tab9 -> tab10 -> tab11 -> tab12 -> tab13;  \n}  ","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 12.1: Functions of XMAS 2.0 in 16s
</p>
</div>
</div>
<div id="amplicon-sequencing-16s" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Amplicon sequencing (16s)<a href="examples.html#amplicon-sequencing-16s" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The upstream process is performed by in-house pipeline. and this example just shows how to perform downstream data analysis. In briefly, the example comprises the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Converting inputs into phyloseq object;</p></li>
<li><p>Quality Evaluation;</p></li>
<li><p>Pre-Processing Data;</p></li>
<li><p>Diversity analysis;</p></li>
<li><p>Ordination analysis;</p></li>
<li><p>Composition analysis;</p></li>
<li><p>Differential analysis.</p></li>
</ol>
<div id="converting-inputs-into-phyloseq-class-object" class="section level3 hasAnchor" number="12.2.1">
<h3><span class="header-section-number">12.2.1</span> Converting inputs into phyloseq-class object<a href="examples.html#converting-inputs-into-phyloseq-class-object" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>dada2</strong> result from standardized_analytics_workflow_R_function.</p>
<ol style="list-style-type: decimal">
<li><p>/home/xuxiaomin/project/standardized_analytics_workflow_R_function/demo_data/16S/process/xdada2/dada2_res.rds</p></li>
<li><p>/home/xuxiaomin/project/standardized_analytics_workflow_R_function/demo_data/16S/process/fasta2tree/tree.nwk</p></li>
<li><p>/home/xuxiaomin/project/standardized_analytics_workflow_R_function/demo_data/16S/metadata.txt</p></li>
</ol>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="examples.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dada2 results from in-house 16s pipeline</span></span>
<span id="cb274-2"><a href="examples.html#cb274-2" aria-hidden="true" tabindex="-1"></a>dada2_res <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(</span>
<span id="cb274-3"><a href="examples.html#cb274-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system.file</span>(</span>
<span id="cb274-4"><a href="examples.html#cb274-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;dada2_res.rds&quot;</span>,</span>
<span id="cb274-5"><a href="examples.html#cb274-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">package =</span> <span class="st">&quot;XMAS&quot;</span>    </span>
<span id="cb274-6"><a href="examples.html#cb274-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb274-7"><a href="examples.html#cb274-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb274-8"><a href="examples.html#cb274-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-9"><a href="examples.html#cb274-9" aria-hidden="true" tabindex="-1"></a><span class="co"># the metadata matches to dada2 result</span></span>
<span id="cb274-10"><a href="examples.html#cb274-10" aria-hidden="true" tabindex="-1"></a>sam_tab <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb274-11"><a href="examples.html#cb274-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">system.file</span>(</span>
<span id="cb274-12"><a href="examples.html#cb274-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;dada2_metadata.tsv&quot;</span>,</span>
<span id="cb274-13"><a href="examples.html#cb274-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">package =</span> <span class="st">&quot;XMAS&quot;</span></span>
<span id="cb274-14"><a href="examples.html#cb274-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb274-15"><a href="examples.html#cb274-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,</span>
<span id="cb274-16"><a href="examples.html#cb274-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb274-17"><a href="examples.html#cb274-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb274-18"><a href="examples.html#cb274-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb274-19"><a href="examples.html#cb274-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-20"><a href="examples.html#cb274-20" aria-hidden="true" tabindex="-1"></a><span class="co"># tree file from dada2 reference data silva</span></span>
<span id="cb274-21"><a href="examples.html#cb274-21" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">read_tree</span>(</span>
<span id="cb274-22"><a href="examples.html#cb274-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system.file</span>(</span>
<span id="cb274-23"><a href="examples.html#cb274-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;tree.nwk&quot;</span>,</span>
<span id="cb274-24"><a href="examples.html#cb274-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">package =</span> <span class="st">&quot;XMAS&quot;</span>    </span>
<span id="cb274-25"><a href="examples.html#cb274-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb274-26"><a href="examples.html#cb274-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb274-27"><a href="examples.html#cb274-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-28"><a href="examples.html#cb274-28" aria-hidden="true" tabindex="-1"></a>tax_tab <span class="ot">&lt;-</span> <span class="fu">import_dada2_taxa</span>(dada2_res<span class="sc">$</span>tax_tab)</span>
<span id="cb274-29"><a href="examples.html#cb274-29" aria-hidden="true" tabindex="-1"></a>otu_tab <span class="ot">&lt;-</span> dada2_res<span class="sc">$</span>seq_tab</span>
<span id="cb274-30"><a href="examples.html#cb274-30" aria-hidden="true" tabindex="-1"></a>sam_tab <span class="ot">&lt;-</span> sam_tab <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;seqID&quot;</span>)</span>
<span id="cb274-31"><a href="examples.html#cb274-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-32"><a href="examples.html#cb274-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Shouldn&#39;t use the Total Number as SampleID (wrong: 123456; right: X123456)</span></span>
<span id="cb274-33"><a href="examples.html#cb274-33" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu_tab) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;S&quot;</span>, <span class="fu">rownames</span>(otu_tab))</span>
<span id="cb274-34"><a href="examples.html#cb274-34" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(sam_tab) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;S&quot;</span>, <span class="fu">rownames</span>(sam_tab))</span>
<span id="cb274-35"><a href="examples.html#cb274-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-36"><a href="examples.html#cb274-36" aria-hidden="true" tabindex="-1"></a>dada2_ps <span class="ot">&lt;-</span> <span class="fu">import_dada2</span>(<span class="at">seq_tab =</span> otu_tab, <span class="at">tax_tab =</span> tax_tab, <span class="at">sam_tab =</span> sam_tab, <span class="at">phy_tree =</span> tree)</span>
<span id="cb274-37"><a href="examples.html#cb274-37" aria-hidden="true" tabindex="-1"></a>dada2_ps</span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 896 taxa and 24 samples ]
## sample_data() Sample Data:       [ 24 samples by 1 sample variables ]
## tax_table()   Taxonomy Table:    [ 896 taxa by 7 taxonomic ranks ]
## phy_tree()    Phylogenetic Tree: [ 896 tips and 893 internal nodes ]
## refseq()      DNAStringSet:      [ 896 reference sequences ]</code></pre>
<p>Here, the phyloseq object comprises five components (<em>OTU Table</em>, <em>Sample Data</em>, <em>Taxonomy Table</em>, <em>Phylogenetic Tree</em> and <em>DNAStringSet</em>).</p>
<div id="summarize-phyloseq-class-object-1" class="section level4 hasAnchor" number="12.2.1.1">
<h4><span class="header-section-number">12.2.1.1</span> Summarize phyloseq-class object<a href="examples.html#summarize-phyloseq-class-object-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="examples.html#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize_phyloseq</span>(dada2_ps)</span>
<span id="cb276-2"><a href="examples.html#cb276-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Compositional = NO2</span></span>
<span id="cb276-3"><a href="examples.html#cb276-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 1] Min. number of reads = 511812] Max. number of reads = 936223] Total number of reads = 15025374] Average number of reads = 62605.70833333335] Median number of reads = 619157] Sparsity = 0.8653738839285716] Any OTU sum to 1 or less? NO8] Number of singletons = 09] Percent of OTUs that are singletons</span></span>
<span id="cb276-4"><a href="examples.html#cb276-4" aria-hidden="true" tabindex="-1"></a><span class="do">##         (i.e. exactly one read detected across all samples)010] Number of sample variables are: 1Group2</span></span>
<span id="cb276-5"><a href="examples.html#cb276-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb276-6"><a href="examples.html#cb276-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;1] Min. number of reads = 51181&quot;</span></span>
<span id="cb276-7"><a href="examples.html#cb276-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb276-8"><a href="examples.html#cb276-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [[2]]</span></span>
<span id="cb276-9"><a href="examples.html#cb276-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;2] Max. number of reads = 93622&quot;</span></span>
<span id="cb276-10"><a href="examples.html#cb276-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb276-11"><a href="examples.html#cb276-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [[3]]</span></span>
<span id="cb276-12"><a href="examples.html#cb276-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;3] Total number of reads = 1502537&quot;</span></span>
<span id="cb276-13"><a href="examples.html#cb276-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb276-14"><a href="examples.html#cb276-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [[4]]</span></span>
<span id="cb276-15"><a href="examples.html#cb276-15" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;4] Average number of reads = 62605.7083333333&quot;</span></span>
<span id="cb276-16"><a href="examples.html#cb276-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb276-17"><a href="examples.html#cb276-17" aria-hidden="true" tabindex="-1"></a><span class="do">## [[5]]</span></span>
<span id="cb276-18"><a href="examples.html#cb276-18" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;5] Median number of reads = 61915&quot;</span></span>
<span id="cb276-19"><a href="examples.html#cb276-19" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb276-20"><a href="examples.html#cb276-20" aria-hidden="true" tabindex="-1"></a><span class="do">## [[6]]</span></span>
<span id="cb276-21"><a href="examples.html#cb276-21" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;7] Sparsity = 0.865373883928571&quot;</span></span>
<span id="cb276-22"><a href="examples.html#cb276-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb276-23"><a href="examples.html#cb276-23" aria-hidden="true" tabindex="-1"></a><span class="do">## [[7]]</span></span>
<span id="cb276-24"><a href="examples.html#cb276-24" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;6] Any OTU sum to 1 or less? NO&quot;</span></span>
<span id="cb276-25"><a href="examples.html#cb276-25" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb276-26"><a href="examples.html#cb276-26" aria-hidden="true" tabindex="-1"></a><span class="do">## [[8]]</span></span>
<span id="cb276-27"><a href="examples.html#cb276-27" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;8] Number of singletons = 0&quot;</span></span>
<span id="cb276-28"><a href="examples.html#cb276-28" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb276-29"><a href="examples.html#cb276-29" aria-hidden="true" tabindex="-1"></a><span class="do">## [[9]]</span></span>
<span id="cb276-30"><a href="examples.html#cb276-30" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;9] Percent of OTUs that are singletons\n        (i.e. exactly one read detected across all samples)0&quot;</span></span>
<span id="cb276-31"><a href="examples.html#cb276-31" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb276-32"><a href="examples.html#cb276-32" aria-hidden="true" tabindex="-1"></a><span class="do">## [[10]]</span></span>
<span id="cb276-33"><a href="examples.html#cb276-33" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;10] Number of sample variables are: 1&quot;</span></span>
<span id="cb276-34"><a href="examples.html#cb276-34" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb276-35"><a href="examples.html#cb276-35" aria-hidden="true" tabindex="-1"></a><span class="do">## [[11]]</span></span>
<span id="cb276-36"><a href="examples.html#cb276-36" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Group&quot;</span></span></code></pre></div>
<p>The minus account of the OTU counts is <em>51181</em> in the phyloseq object, and we can use it as the threshold to rarefy.</p>
<p>Notice the <strong>Sparsity (0.865)</strong>, indicating the data has many zeros and pay attention to the downstream data analysis. A common property of amplicon based microbiota data generated by sequencing.</p>
</div>
</div>
<div id="quality-control" class="section level3 hasAnchor" number="12.2.2">
<h3><span class="header-section-number">12.2.2</span> Quality Control<a href="examples.html#quality-control" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Quality control of DADA2 results will help us have more rational determinations on the further data analysis.</p>
<div id="rarefaction-curves-1" class="section level4 hasAnchor" number="12.2.2.1">
<h4><span class="header-section-number">12.2.2.1</span> Rarefaction curves<a href="examples.html#rarefaction-curves-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="examples.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_RarefCure</span>(<span class="at">ps =</span> dada2_ps,</span>
<span id="cb277-2"><a href="examples.html#cb277-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">taxa_level =</span> <span class="st">&quot;OTU&quot;</span>,</span>
<span id="cb277-3"><a href="examples.html#cb277-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">step =</span> <span class="dv">100</span>,</span>
<span id="cb277-4"><a href="examples.html#cb277-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">label =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb277-5"><a href="examples.html#cb277-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb277-6"><a href="examples.html#cb277-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb277-7"><a href="examples.html#cb277-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">se =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-143"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-143-1.png" alt="Rarefaction curves (16s example)" width="576" />
<p class="caption">
Figure 12.2: Rarefaction curves (16s example)
</p>
</div>
<p>The result showed that all the samples had <strong>different sequence depth</strong> but had the full sample richness.</p>
</div>
<div id="reads-track-by-dada2" class="section level4 hasAnchor" number="12.2.2.2">
<h4><span class="header-section-number">12.2.2.2</span> Reads’ track by DADA2<a href="examples.html#reads-track-by-dada2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="examples.html#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_Dada2Track</span>(</span>
<span id="cb278-2"><a href="examples.html#cb278-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>dada2_res<span class="sc">$</span>reads_track,</span>
<span id="cb278-3"><a href="examples.html#cb278-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode=</span><span class="st">&quot;PE&quot;</span>,</span>
<span id="cb278-4"><a href="examples.html#cb278-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">relative_abundance=</span><span class="cn">TRUE</span>,</span>
<span id="cb278-5"><a href="examples.html#cb278-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend_position=</span><span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-144"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-144-1.png" alt="Reads' track by DADA2 (16s example)" width="576" />
<p class="caption">
Figure 12.3: Reads’ track by DADA2 (16s example)
</p>
</div>
<p>The percentage of the final remained read counts approximate <strong>70%</strong>, indicating that we should consider the sequence depth for analysis when we build the sequence library.</p>
</div>
<div id="spike-in-sample-brs-assessment" class="section level4 hasAnchor" number="12.2.2.3">
<h4><span class="header-section-number">12.2.2.3</span> Spike-in sample (BRS) assessment<a href="examples.html#spike-in-sample-brs-assessment" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="examples.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting the genus level phyloseq  </span></span>
<span id="cb279-2"><a href="examples.html#cb279-2" aria-hidden="true" tabindex="-1"></a>dada2_ps_genus <span class="ot">&lt;-</span> <span class="fu">summarize_taxa</span>(<span class="at">ps =</span> dada2_ps, <span class="at">taxa_level =</span> <span class="st">&quot;Genus&quot;</span>)</span>
<span id="cb279-3"><a href="examples.html#cb279-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-4"><a href="examples.html#cb279-4" aria-hidden="true" tabindex="-1"></a>RefCheck_16s <span class="ot">&lt;-</span> <span class="fu">run_RefCheck</span>(</span>
<span id="cb279-5"><a href="examples.html#cb279-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ps=</span>dada2_ps_genus,</span>
<span id="cb279-6"><a href="examples.html#cb279-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">group=</span><span class="st">&quot;Group&quot;</span>,</span>
<span id="cb279-7"><a href="examples.html#cb279-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">group_names=</span><span class="st">&quot;QC&quot;</span>,</span>
<span id="cb279-8"><a href="examples.html#cb279-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Reference=</span><span class="cn">NULL</span>,</span>
<span id="cb279-9"><a href="examples.html#cb279-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ref_type=</span><span class="st">&quot;16s&quot;</span>,</span>
<span id="cb279-10"><a href="examples.html#cb279-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Save=</span><span class="cn">NULL</span>)</span>
<span id="cb279-11"><a href="examples.html#cb279-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Noting: the Reference Matrix is for 16s</span></span>
<span id="cb279-12"><a href="examples.html#cb279-12" aria-hidden="true" tabindex="-1"></a><span class="do">## S8005 is in the Reference Matrix&#39;s samples and remove it to run</span></span>
<span id="cb279-13"><a href="examples.html#cb279-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb279-14"><a href="examples.html#cb279-14" aria-hidden="true" tabindex="-1"></a><span class="do">## #########Matched baterica of the Spike-in sample###########</span></span>
<span id="cb279-15"><a href="examples.html#cb279-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Checking out all the taxa of the Reference Matrix are in the sequencing dataset </span></span>
<span id="cb279-16"><a href="examples.html#cb279-16" aria-hidden="true" tabindex="-1"></a><span class="do">## g__Bifidobacterium</span></span>
<span id="cb279-17"><a href="examples.html#cb279-17" aria-hidden="true" tabindex="-1"></a><span class="do">## g__Bacteroides</span></span>
<span id="cb279-18"><a href="examples.html#cb279-18" aria-hidden="true" tabindex="-1"></a><span class="do">## g__Faecalibacterium</span></span>
<span id="cb279-19"><a href="examples.html#cb279-19" aria-hidden="true" tabindex="-1"></a><span class="do">## g__Lactobacillus</span></span>
<span id="cb279-20"><a href="examples.html#cb279-20" aria-hidden="true" tabindex="-1"></a><span class="do">## g__Parabacteroides</span></span>
<span id="cb279-21"><a href="examples.html#cb279-21" aria-hidden="true" tabindex="-1"></a><span class="do">## g__Collinsella</span></span>
<span id="cb279-22"><a href="examples.html#cb279-22" aria-hidden="true" tabindex="-1"></a><span class="do">## g__Coprococcus_3</span></span>
<span id="cb279-23"><a href="examples.html#cb279-23" aria-hidden="true" tabindex="-1"></a><span class="do">## g__Dorea</span></span>
<span id="cb279-24"><a href="examples.html#cb279-24" aria-hidden="true" tabindex="-1"></a><span class="do">## g__Streptococcus</span></span>
<span id="cb279-25"><a href="examples.html#cb279-25" aria-hidden="true" tabindex="-1"></a><span class="do">## g__Roseburia</span></span>
<span id="cb279-26"><a href="examples.html#cb279-26" aria-hidden="true" tabindex="-1"></a><span class="do">## g__Anaerostipes</span></span>
<span id="cb279-27"><a href="examples.html#cb279-27" aria-hidden="true" tabindex="-1"></a><span class="do">## g__Escherichia/Shigella</span></span>
<span id="cb279-28"><a href="examples.html#cb279-28" aria-hidden="true" tabindex="-1"></a><span class="do">## g__Enterococcus</span></span>
<span id="cb279-29"><a href="examples.html#cb279-29" aria-hidden="true" tabindex="-1"></a><span class="do">## g__Prevotella_9</span></span>
<span id="cb279-30"><a href="examples.html#cb279-30" aria-hidden="true" tabindex="-1"></a><span class="do">## g__Eggerthella</span></span>
<span id="cb279-31"><a href="examples.html#cb279-31" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb279-32"><a href="examples.html#cb279-32" aria-hidden="true" tabindex="-1"></a><span class="do">## The number of the additional Taxa in the sequencing dataset is 1</span></span>
<span id="cb279-33"><a href="examples.html#cb279-33" aria-hidden="true" tabindex="-1"></a><span class="do">## ###########################################################</span></span>
<span id="cb279-34"><a href="examples.html#cb279-34" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb279-35"><a href="examples.html#cb279-35" aria-hidden="true" tabindex="-1"></a><span class="do">## ##############Value of the Reference sample###############</span></span>
<span id="cb279-36"><a href="examples.html#cb279-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Correlation Coefficient of the Reference sample is: 0.9714</span></span>
<span id="cb279-37"><a href="examples.html#cb279-37" aria-hidden="true" tabindex="-1"></a><span class="do">## Bray Curtis of the Reference sample is: 0.07607</span></span>
<span id="cb279-38"><a href="examples.html#cb279-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Impurity of the Reference sample is: 0.06409</span></span>
<span id="cb279-39"><a href="examples.html#cb279-39" aria-hidden="true" tabindex="-1"></a><span class="do">## ###########################################################</span></span>
<span id="cb279-40"><a href="examples.html#cb279-40" aria-hidden="true" tabindex="-1"></a><span class="do">## #####Final Evaluation Results of the Spike-in sample#######</span></span>
<span id="cb279-41"><a href="examples.html#cb279-41" aria-hidden="true" tabindex="-1"></a><span class="do">## The spike-in sample of sequencing dataset passed the cutoff of the Reference Matrix </span></span>
<span id="cb279-42"><a href="examples.html#cb279-42" aria-hidden="true" tabindex="-1"></a><span class="do">## Cutoff of Coefficient is 0.8946</span></span>
<span id="cb279-43"><a href="examples.html#cb279-43" aria-hidden="true" tabindex="-1"></a><span class="do">## Cutoff of BrayCurtis is 0.3878</span></span>
<span id="cb279-44"><a href="examples.html#cb279-44" aria-hidden="true" tabindex="-1"></a><span class="do">## Cutoff of Impurity is 0.1565</span></span>
<span id="cb279-45"><a href="examples.html#cb279-45" aria-hidden="true" tabindex="-1"></a><span class="do">## ###########################################################</span></span></code></pre></div>
</div>
<div id="spike-in-samples-remove" class="section level4 hasAnchor" number="12.2.2.4">
<h4><span class="header-section-number">12.2.2.4</span> Spike-in sample’s remove<a href="examples.html#spike-in-samples-remove" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="examples.html#cb280-1" aria-hidden="true" tabindex="-1"></a>dada2_ps_NoQC <span class="ot">&lt;-</span> <span class="fu">get_GroupPhyloseq</span>(</span>
<span id="cb280-2"><a href="examples.html#cb280-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ps =</span> dada2_ps,</span>
<span id="cb280-3"><a href="examples.html#cb280-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb280-4"><a href="examples.html#cb280-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group_names =</span> <span class="st">&quot;QC&quot;</span>,</span>
<span id="cb280-5"><a href="examples.html#cb280-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">discard =</span> <span class="cn">TRUE</span></span>
<span id="cb280-6"><a href="examples.html#cb280-6" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb280-7"><a href="examples.html#cb280-7" aria-hidden="true" tabindex="-1"></a>dada2_ps_NoQC</span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 896 taxa and 23 samples ]
## sample_data() Sample Data:       [ 23 samples by 1 sample variables ]
## tax_table()   Taxonomy Table:    [ 896 taxa by 7 taxonomic ranks ]
## phy_tree()    Phylogenetic Tree: [ 896 tips and 893 internal nodes ]
## refseq()      DNAStringSet:      [ 896 reference sequences ]</code></pre>
</div>
</div>
<div id="data-processing" class="section level3 hasAnchor" number="12.2.3">
<h3><span class="header-section-number">12.2.3</span> Data processing<a href="examples.html#data-processing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This part has too may procedures and we only choose some of them. Please go to <strong>Chapter 6</strong> to see more approaches and details for being familiar with this part.</p>
<div id="rarefy-otu-counts" class="section level4 hasAnchor" number="12.2.3.1">
<h4><span class="header-section-number">12.2.3.1</span> Rarefy otu counts<a href="examples.html#rarefy-otu-counts" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>From previous results of quality evaluation, the sequence depth of samples are different which have effects on the downstream analysis. Here, choosing the <strong>rarefy</strong> (Normaliztion method: random subsampling counts to the smallest library size) to get the equal sample sums.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="examples.html#cb282-1" aria-hidden="true" tabindex="-1"></a>dada2_ps_rare <span class="ot">&lt;-</span> <span class="fu">normalize</span>(dada2_ps_NoQC, <span class="at">method =</span> <span class="st">&quot;rarefy&quot;</span>)</span>
<span id="cb282-2"><a href="examples.html#cb282-2" aria-hidden="true" tabindex="-1"></a>dada2_ps_rare</span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 892 taxa and 23 samples ]
## sample_data() Sample Data:       [ 23 samples by 1 sample variables ]
## tax_table()   Taxonomy Table:    [ 892 taxa by 7 taxonomic ranks ]
## phy_tree()    Phylogenetic Tree: [ 892 tips and 889 internal nodes ]
## refseq()      DNAStringSet:      [ 892 reference sequences ]</code></pre>
<p>In addition, we could also perform some other normalization methods on the rarefied phyloseq object. By the way, we didn’t transform the data by using log algorithm because the count matrix is required by the following data analysis methods.</p>
</div>
<div id="extracting-specific-taxonomic-level" class="section level4 hasAnchor" number="12.2.3.2">
<h4><span class="header-section-number">12.2.3.2</span> Extracting specific taxonomic level<a href="examples.html#extracting-specific-taxonomic-level" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="examples.html#cb284-1" aria-hidden="true" tabindex="-1"></a>dada2_ps_rare_genus <span class="ot">&lt;-</span> <span class="fu">summarize_taxa</span>(dada2_ps_rare, <span class="at">taxa_level =</span> <span class="st">&quot;Genus&quot;</span>)</span>
<span id="cb284-2"><a href="examples.html#cb284-2" aria-hidden="true" tabindex="-1"></a>dada2_ps_rare_genus</span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 198 taxa and 23 samples ]
## sample_data() Sample Data:       [ 23 samples by 1 sample variables ]
## tax_table()   Taxonomy Table:    [ 198 taxa by 6 taxonomic ranks ]</code></pre>
</div>
<div id="filtering-the-low-relative-abundance-or-unclassified-taxa-by-the-threshold-total-counts-10" class="section level4 hasAnchor" number="12.2.3.3">
<h4><span class="header-section-number">12.2.3.3</span> Filtering the low relative abundance or unclassified taxa by the threshold (total counts &lt; 10)<a href="examples.html#filtering-the-low-relative-abundance-or-unclassified-taxa-by-the-threshold-total-counts-10" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="examples.html#cb286-1" aria-hidden="true" tabindex="-1"></a>dada2_ps_rare_genus_filter <span class="ot">&lt;-</span> <span class="fu">run_filter</span>(dada2_ps_rare_genus, <span class="at">cutoff =</span> <span class="dv">10</span>, <span class="at">unclass =</span> <span class="cn">TRUE</span>)</span>
<span id="cb286-2"><a href="examples.html#cb286-2" aria-hidden="true" tabindex="-1"></a>dada2_ps_rare_genus_filter </span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 149 taxa and 23 samples ]
## sample_data() Sample Data:       [ 23 samples by 1 sample variables ]
## tax_table()   Taxonomy Table:    [ 149 taxa by 6 taxonomic ranks ]</code></pre>
</div>
<div id="trimming-the-taxa-with-low-occurrence-less-than-threshold" class="section level4 hasAnchor" number="12.2.3.4">
<h4><span class="header-section-number">12.2.3.4</span> Trimming the taxa with low occurrence less than threshold<a href="examples.html#trimming-the-taxa-with-low-occurrence-less-than-threshold" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="examples.html#cb288-1" aria-hidden="true" tabindex="-1"></a>dada2_ps_rare_genus_filter_trim <span class="ot">&lt;-</span> <span class="fu">run_trim</span>(dada2_ps_rare_genus_filter, <span class="at">cutoff =</span> <span class="fl">0.2</span>, <span class="at">trim =</span> <span class="st">&quot;feature&quot;</span>)</span>
<span id="cb288-2"><a href="examples.html#cb288-2" aria-hidden="true" tabindex="-1"></a>dada2_ps_final <span class="ot">&lt;-</span> dada2_ps_rare_genus_filter_trim</span>
<span id="cb288-3"><a href="examples.html#cb288-3" aria-hidden="true" tabindex="-1"></a>dada2_ps_final</span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 99 taxa and 23 samples ]
## sample_data() Sample Data:       [ 23 samples by 1 sample variables ]
## tax_table()   Taxonomy Table:    [ 99 taxa by 6 taxonomic ranks ]</code></pre>
<p>Finally, we obtained the final phyloseq-class object <em>dada2_ps_rare_genus_filter_trim</em> and changed its name.</p>
</div>
</div>
<div id="diversity-analysis" class="section level3 hasAnchor" number="12.2.4">
<h3><span class="header-section-number">12.2.4</span> Diversity analysis<a href="examples.html#diversity-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="alpha-diveristy" class="section level4 hasAnchor" number="12.2.4.1">
<h4><span class="header-section-number">12.2.4.1</span> Alpha diveristy<a href="examples.html#alpha-diveristy" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Calculate the alpha diversity</li>
</ul>
<p><strong>Notes:</strong> the otu table must be counts matrix (<em>rarefied but not trim counts matrix</em>) when you choose <em>Observed</em> etc measures.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="examples.html#cb290-1" aria-hidden="true" tabindex="-1"></a>dada_ps_rare_genus_alpha <span class="ot">&lt;-</span> <span class="fu">run_alpha_diversity</span>(<span class="at">ps=</span>dada2_ps_rare_genus, <span class="at">measures =</span> <span class="fu">c</span>(<span class="st">&quot;Shannon&quot;</span>, <span class="st">&quot;Chao1&quot;</span>, <span class="st">&quot;Observed&quot;</span>))</span>
<span id="cb290-2"><a href="examples.html#cb290-2" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(dada_ps_rare_genus_alpha)</span></code></pre></div>
<div id="htmlwidget-ba39a042bc91b2b0f803" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ba39a042bc91b2b0f803">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],["S6030","S6032","S6033","S6035","S6036","S6037","S6040","S6043","S6045","S6046","S6048","S6049","S6050","S6054","S6055","S6058","S6059","S6060","S6061","S6063","S6065","S6066","S6068"],["BB","BB","BB","AA","BB","AA","BB","AA","BB","BB","BB","AA","BB","BB","BB","BB","AA","AA","AA","BB","AA","AA","BB"],[74,38,80,36,95,35,58,65,60,70,66,60,53,84,75,37,71,48,80,38,77,67,40],[74,38,80,36,95,35,58,65,60,70,66,60,53,84,75,37,71,48,80,38,77,67,40],[0.124152532601439,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,0.496655480858378,-0,-0,0.123691063406645,-0,-0,-0,-0,-0],[2.62033828789643,1.71046367908714,2.7178260173712,1.94782374725317,2.94118853023012,1.93386811804821,2.49344362443866,2.10434998133963,2.91847230212687,2.26445513711632,2.63008344765473,2.51114433123924,2.43133430567794,2.77318269379375,2.29312438643925,2.2603002794234,2.68333432133409,1.88209741084225,3.08575537094739,1.53894537555875,2.87853125259435,2.63833480661453,2.09920259186206]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>SampleID<\/th>\n      <th>Group<\/th>\n      <th>Observed<\/th>\n      <th>Chao1<\/th>\n      <th>se.chao1<\/th>\n      <th>Shannon<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<ul>
<li>visualization</li>
</ul>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="examples.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_boxplot</span>(<span class="at">data=</span>dada_ps_rare_genus_alpha,</span>
<span id="cb291-2"><a href="examples.html#cb291-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">y_index =</span> <span class="fu">c</span>(<span class="st">&quot;Shannon&quot;</span>, <span class="st">&quot;Chao1&quot;</span>, <span class="st">&quot;Observed&quot;</span>),</span>
<span id="cb291-3"><a href="examples.html#cb291-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb291-4"><a href="examples.html#cb291-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">group_names =</span> <span class="fu">c</span>(<span class="st">&quot;AA&quot;</span>, <span class="st">&quot;BB&quot;</span>),</span>
<span id="cb291-5"><a href="examples.html#cb291-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">group_color =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb291-6"><a href="examples.html#cb291-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">do_test =</span> <span class="cn">TRUE</span>,</span>
<span id="cb291-7"><a href="examples.html#cb291-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">method =</span> <span class="st">&quot;wilcox.test&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-152"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-152-1.png" alt="Alpha diversity (16s example)" width="576" />
<p class="caption">
Figure 12.4: Alpha diversity (16s example)
</p>
</div>
</div>
<div id="beta-diversity-1" class="section level4 hasAnchor" number="12.2.4.2">
<h4><span class="header-section-number">12.2.4.2</span> Beta diversity<a href="examples.html#beta-diversity-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>beta dipersion</li>
</ul>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="examples.html#cb292-1" aria-hidden="true" tabindex="-1"></a>dada2_ps_beta <span class="ot">&lt;-</span> <span class="fu">run_beta_diversity</span>(<span class="at">ps=</span>dada2_ps_final, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>, <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Permutation test for homogeneity of multivariate dispersions
## Permutation: free
## Number of permutations: 999
## 
## Response: Distances
##           Df   Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
## Groups     1 0.014165 0.0141653 1.6825    999  0.217
## Residuals 21 0.176808 0.0084194                     
## 
## Pairwise comparisons:
## (Observed p-value below diagonal, permuted p-value above diagonal)
##         AA    BB
## AA         0.218
## BB 0.20867</code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="examples.html#cb294-1" aria-hidden="true" tabindex="-1"></a>dada2_ps_beta<span class="sc">$</span>BetaDispersion</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-153"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-153-1.png" alt="Beta diversity (16s example)" width="480" />
<p class="caption">
Figure 12.5: Beta diversity (16s example)
</p>
</div>
</div>
</div>
<div id="permanova-ordination" class="section level3 hasAnchor" number="12.2.5">
<h3><span class="header-section-number">12.2.5</span> PERMANOVA + Ordination<a href="examples.html#permanova-ordination" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="permanova" class="section level4 hasAnchor" number="12.2.5.1">
<h4><span class="header-section-number">12.2.5.1</span> PERMANOVA<a href="examples.html#permanova" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="examples.html#cb295-1" aria-hidden="true" tabindex="-1"></a>dada2_ps_per <span class="ot">&lt;-</span> <span class="fu">run_permanova</span>(<span class="at">ps=</span>dada2_ps_final, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb295-2"><a href="examples.html#cb295-2" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(dada2_ps_per)</span></code></pre></div>
<div id="htmlwidget-5e901b8c7135a9d96d40" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-5e901b8c7135a9d96d40">{"x":{"filter":"none","vertical":false,"data":[["SampleID","Group"],[23,23],[22,1],[3.84124991127819,0.230022591056708],[0.174602268694463,0.230022591056708],[0,1.33762679107518],[1,0.059882224892826],[1,0.219],[1,0.438]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>SumsOfSample<\/th>\n      <th>Df<\/th>\n      <th>SumsOfSqs<\/th>\n      <th>MeanSqs<\/th>\n      <th>F.Model<\/th>\n      <th>R2<\/th>\n      <th>Pr(&gt;F)<\/th>\n      <th>AdjustedPvalue<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>The PERMANOVA result of the Group (AdjustedPvalue &gt; 0.05) revealed that the two groups had not the distinct patterns of microbial community.</p>
</div>
<div id="ordination-1" class="section level4 hasAnchor" number="12.2.5.2">
<h4><span class="header-section-number">12.2.5.2</span> Ordination<a href="examples.html#ordination-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We performed ordination by using Principal Coordinate Analysis (PCoA). If you want to try other methods please go to see <strong>Chapter 8</strong> for more details.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="examples.html#cb296-1" aria-hidden="true" tabindex="-1"></a>dada2_ps_ordination <span class="ot">&lt;-</span> <span class="fu">run_ordination</span>(</span>
<span id="cb296-2"><a href="examples.html#cb296-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ps =</span> dada2_ps_final,</span>
<span id="cb296-3"><a href="examples.html#cb296-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb296-4"><a href="examples.html#cb296-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;PCoA&quot;</span>)</span>
<span id="cb296-5"><a href="examples.html#cb296-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-6"><a href="examples.html#cb296-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_Ordination</span>(<span class="at">ResultList =</span> dada2_ps_ordination, </span>
<span id="cb296-7"><a href="examples.html#cb296-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>, </span>
<span id="cb296-8"><a href="examples.html#cb296-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">group_names =</span> <span class="fu">c</span>(<span class="st">&quot;AA&quot;</span>, <span class="st">&quot;BB&quot;</span>),</span>
<span id="cb296-9"><a href="examples.html#cb296-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">group_color =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb296-10"><a href="examples.html#cb296-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">circle_type =</span> <span class="st">&quot;ellipse_line&quot;</span>,</span>
<span id="cb296-11"><a href="examples.html#cb296-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">sideboxplot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb296-12"><a href="examples.html#cb296-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">sample =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-155"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-155-1.png" alt="PCoA (16s example)" width="576" />
<p class="caption">
Figure 12.6: PCoA (16s example)
</p>
</div>
</div>
</div>
<div id="microbial-composition" class="section level3 hasAnchor" number="12.2.6">
<h3><span class="header-section-number">12.2.6</span> Microbial composition<a href="examples.html#microbial-composition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A whole picture of the microbial composition.</p>
<div id="stacked-barplot-1" class="section level4 hasAnchor" number="12.2.6.1">
<h4><span class="header-section-number">12.2.6.1</span> Stacked barplot<a href="examples.html#stacked-barplot-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="examples.html#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_StackBarPlot</span>(</span>
<span id="cb297-2"><a href="examples.html#cb297-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">ps=</span>dada2_ps_final,</span>
<span id="cb297-3"><a href="examples.html#cb297-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">taxa_level=</span><span class="st">&quot;Phylum&quot;</span>,</span>
<span id="cb297-4"><a href="examples.html#cb297-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb297-5"><a href="examples.html#cb297-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">cluster =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-156"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-156-1.png" alt="Microbial composition (16s example)" width="768" />
<p class="caption">
Figure 12.7: Microbial composition (16s example)
</p>
</div>
</div>
<div id="core-microbiota-1" class="section level4 hasAnchor" number="12.2.6.2">
<h4><span class="header-section-number">12.2.6.2</span> Core microbiota<a href="examples.html#core-microbiota-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>convert absolute abundance into relative abundance</li>
</ul>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="examples.html#cb298-1" aria-hidden="true" tabindex="-1"></a>dada2_ps_final_rb <span class="ot">&lt;-</span> <span class="fu">normalize</span>(dada2_ps_final, <span class="at">method =</span> <span class="st">&quot;TSS&quot;</span>)</span>
<span id="cb298-2"><a href="examples.html#cb298-2" aria-hidden="true" tabindex="-1"></a>dada2_ps_final_rb</span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 99 taxa and 23 samples ]
## sample_data() Sample Data:       [ 23 samples by 1 sample variables ]
## tax_table()   Taxonomy Table:    [ 99 taxa by 6 taxonomic ranks ]</code></pre>
<ul>
<li>visualization</li>
</ul>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="examples.html#cb300-1" aria-hidden="true" tabindex="-1"></a>prevalences <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="dv">1</span>, <span class="fl">0.05</span>)</span>
<span id="cb300-2"><a href="examples.html#cb300-2" aria-hidden="true" tabindex="-1"></a>detections <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="fu">log10</span>(<span class="fl">1e-3</span>), <span class="fu">log10</span>(<span class="fl">0.2</span>), <span class="at">length =</span> <span class="dv">10</span>)</span>
<span id="cb300-3"><a href="examples.html#cb300-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-4"><a href="examples.html#cb300-4" aria-hidden="true" tabindex="-1"></a>pl_core <span class="ot">&lt;-</span> <span class="fu">plot_core_taxa</span>(dada2_ps_final_rb, </span>
<span id="cb300-5"><a href="examples.html#cb300-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot.type =</span> <span class="st">&quot;heatmap&quot;</span>, </span>
<span id="cb300-6"><a href="examples.html#cb300-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">colours =</span> <span class="fu">gray</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length=</span><span class="dv">5</span>)),</span>
<span id="cb300-7"><a href="examples.html#cb300-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">prevalences =</span> prevalences, </span>
<span id="cb300-8"><a href="examples.html#cb300-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">detections =</span> detections, </span>
<span id="cb300-9"><a href="examples.html#cb300-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">min.prevalence =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb300-10"><a href="examples.html#cb300-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Detection Threshold (Relative Abundance (%))&quot;</span>)</span>
<span id="cb300-11"><a href="examples.html#cb300-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-12"><a href="examples.html#cb300-12" aria-hidden="true" tabindex="-1"></a>pl_core</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-158"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-158-1.png" alt="Core taxa (16s example)" width="768" />
<p class="caption">
Figure 12.8: Core taxa (16s example)
</p>
</div>
<p>The degree of color indicates the size of abundance and prevalence.</p>
<ul>
<li>Use <code>core_members</code> to obtain the core taxa. detection for abundance and prevalence for occurrence.</li>
</ul>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="examples.html#cb301-1" aria-hidden="true" tabindex="-1"></a>core_taxa_name <span class="ot">&lt;-</span> <span class="fu">core_members</span>(dada2_ps_final_rb, <span class="at">detection =</span> <span class="fl">0.01</span>, <span class="at">prevalence =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-2"><a href="examples.html#cb301-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(core_taxa_name)</span></code></pre></div>
<pre><code>## [1] &quot;g__Bifidobacterium&quot; &quot;g__Blautia&quot;</code></pre>
<p><strong>Result</strong>:</p>
<p>Only 2 genera (g__Bifidobacterium and g__Blautia) passed the threshold of detection and prevalence which we choose.</p>
</div>
</div>
<div id="differential-analysis-1" class="section level3 hasAnchor" number="12.2.7">
<h3><span class="header-section-number">12.2.7</span> Differential Analysis<a href="examples.html#differential-analysis-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are more than 10 approaches to perform differential analysis. Here, we choose two of them and recommend users going to <strong>Chapter 10</strong> to see more detials.</p>
<div id="liner-discriminant-analysis-lda-effect-size-lefse-2" class="section level4 hasAnchor" number="12.2.7.1">
<h4><span class="header-section-number">12.2.7.1</span> Liner discriminant analysis (LDA) effect size (LEfSe)<a href="examples.html#liner-discriminant-analysis-lda-effect-size-lefse-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Calculation</li>
</ul>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="examples.html#cb303-1" aria-hidden="true" tabindex="-1"></a>dada2_ps_lefse <span class="ot">&lt;-</span> <span class="fu">run_lefse</span>(</span>
<span id="cb303-2"><a href="examples.html#cb303-2" aria-hidden="true" tabindex="-1"></a>                    dada2_ps_final_rb,</span>
<span id="cb303-3"><a href="examples.html#cb303-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb303-4"><a href="examples.html#cb303-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">group_names =</span> <span class="fu">c</span>(<span class="st">&quot;AA&quot;</span>, <span class="st">&quot;BB&quot;</span>),</span>
<span id="cb303-5"><a href="examples.html#cb303-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">transform =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb303-6"><a href="examples.html#cb303-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">norm =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb303-7"><a href="examples.html#cb303-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">kw.p =</span> <span class="fl">0.05</span>,</span>
<span id="cb303-8"><a href="examples.html#cb303-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">wl.p =</span> <span class="fl">0.05</span>,</span>
<span id="cb303-9"><a href="examples.html#cb303-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Lda =</span> <span class="dv">0</span>)</span>
<span id="cb303-10"><a href="examples.html#cb303-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dada2_ps_lefse)</span></code></pre></div>
<pre><code>##  [1] &quot;TaxaID&quot;                            &quot;Block&quot;                            
##  [3] &quot;Enrichment&quot;                        &quot;LDA_Score&quot;                        
##  [5] &quot;EffectSize&quot;                        &quot;Log2FoldChange (Median)\nAA_vs_BB&quot;
##  [7] &quot;Median Abundance\n(All)&quot;           &quot;Median Abundance\nAA&quot;             
##  [9] &quot;Median Abundance\nBB&quot;              &quot;Log2FoldChange (Mean)\nAA_vs_BB&quot;  
## [11] &quot;Mean Abundance\n(All)&quot;             &quot;Mean Abundance\nAA&quot;               
## [13] &quot;Mean Abundance\nBB&quot;                &quot;Occurrence (100%)\n(All)&quot;         
## [15] &quot;Occurrence (100%)\nAA&quot;             &quot;Occurrence (100%)\nBB&quot;            
## [17] &quot;Odds Ratio (95% CI)&quot;</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="examples.html#cb305-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(dada2_ps_lefse)</span></code></pre></div>
<div id="htmlwidget-f07f03a25fab0e5af72d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f07f03a25fab0e5af72d">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],["g__Parasutterella","g__Intestinibacter","g__Clostridium_sensu_stricto_1","g__Romboutsia","g__Odoribacter","g__Lactobacillus"],["9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB"],["AA","AA","BB","BB","BB","BB"],[-0.00164335667495188,-0.00033487301466407,0.000605326342208924,0.00256149493493623,0.00292753816436145,0.00539996045441882],[0.988766218970677,1.93646388079109,1.76576054015392,0.0903260391108538,1.65017953572966,1.57178573353465],[5.1094067925717,null,null,-6.32359537281917,null,-3.13926309498725],[0.000203814237880332,0.000328686077405571,0.000163776690482527,0.00214956906258317,6.58082348037818e-05,0.00123067622419898],[0.00105927623330019,0,0,7.55401117993655e-05,0.0006156750877337,0.000600961538461538],[3.06848866704852e-05,0.00152800387903691,0.00113036401106323,0.00605019693029388,0,0.00529491550239659],[4.3584648967539,-1.92384945016795,-4.85339431204819,-3.40163102983603,2.10653263474183,-5.15752358136444],[0.00382959751566048,0.00185631171826346,0.00586785157008349,0.00707928819726839,0.000580376782782315,0.0201574190022403],[0.00909690574535213,0.000687292897319953,0.000326219259823728,0.00103740996364125,0.00108961035319702,0.000911407969182292],[0.000443470796572986,0.00260782381744143,0.0094303294838219,0.0109633527760287,0.000253012344658579,0.0325298546663491],[65.22,60.87,60.87,78.26,52.17,86.96],[88.89,22.22,22.22,55.56,77.78,77.78],[50,85.71,85.71,92.86,35.71,92.86],["0.0043 (-11;11)","3.2 (5.6;0.94)","8700 (8700;8700)","90 (99;81)","0.31 (-2;2.6)","2.2e+08 (2.2e+08;2.2e+08)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>TaxaID<\/th>\n      <th>Block<\/th>\n      <th>Enrichment<\/th>\n      <th>LDA_Score<\/th>\n      <th>EffectSize<\/th>\n      <th>Log2FoldChange (Median)\nAA_vs_BB<\/th>\n      <th>Median Abundance\n(All)<\/th>\n      <th>Median Abundance\nAA<\/th>\n      <th>Median Abundance\nBB<\/th>\n      <th>Log2FoldChange (Mean)\nAA_vs_BB<\/th>\n      <th>Mean Abundance\n(All)<\/th>\n      <th>Mean Abundance\nAA<\/th>\n      <th>Mean Abundance\nBB<\/th>\n      <th>Occurrence (100%)\n(All)<\/th>\n      <th>Occurrence (100%)\nAA<\/th>\n      <th>Occurrence (100%)\nBB<\/th>\n      <th>Odds Ratio (95% CI)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,5,6,7,8,9,10,11,12,13,14,15,16]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<ul>
<li>Visualization</li>
</ul>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="examples.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_lefse</span>(</span>
<span id="cb306-2"><a href="examples.html#cb306-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">da_res =</span> dada2_ps_lefse,</span>
<span id="cb306-3"><a href="examples.html#cb306-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_index =</span> <span class="st">&quot;LDA_Score&quot;</span>,</span>
<span id="cb306-4"><a href="examples.html#cb306-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_index_cutoff =</span> <span class="dv">1</span>,</span>
<span id="cb306-5"><a href="examples.html#cb306-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">group_color =</span> <span class="fu">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-161"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-161-1.png" alt="Lefse analysis (16s example)" width="576" />
<p class="caption">
Figure 12.9: Lefse analysis (16s example)
</p>
</div>
</div>
<div id="wilcoxon-rank-sum-test" class="section level4 hasAnchor" number="12.2.7.2">
<h4><span class="header-section-number">12.2.7.2</span> Wilcoxon Rank-Sum test<a href="examples.html#wilcoxon-rank-sum-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Calculation</li>
</ul>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="examples.html#cb307-1" aria-hidden="true" tabindex="-1"></a>dada2_ps_wilcox <span class="ot">&lt;-</span> <span class="fu">run_wilcox</span>(</span>
<span id="cb307-2"><a href="examples.html#cb307-2" aria-hidden="true" tabindex="-1"></a>                    dada2_ps_final_rb,</span>
<span id="cb307-3"><a href="examples.html#cb307-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb307-4"><a href="examples.html#cb307-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">group_names =</span> <span class="fu">c</span>(<span class="st">&quot;AA&quot;</span>, <span class="st">&quot;BB&quot;</span>),</span>
<span id="cb307-5"><a href="examples.html#cb307-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">transform =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb307-6"><a href="examples.html#cb307-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">norm =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb307-7"><a href="examples.html#cb307-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">p_adjust =</span> <span class="st">&quot;BH&quot;</span>,</span>
<span id="cb307-8"><a href="examples.html#cb307-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pvalue_cutoff =</span> <span class="fl">0.05</span>)</span>
<span id="cb307-9"><a href="examples.html#cb307-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-10"><a href="examples.html#cb307-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dada2_ps_wilcox)</span></code></pre></div>
<pre><code>##  [1] &quot;TaxaID&quot;                            &quot;Block&quot;                            
##  [3] &quot;Enrichment&quot;                        &quot;EffectSize&quot;                       
##  [5] &quot;Statistic&quot;                         &quot;Pvalue&quot;                           
##  [7] &quot;AdjustedPvalue&quot;                    &quot;Log2FoldChange (Median)\nAA_vs_BB&quot;
##  [9] &quot;Median Abundance\n(All)&quot;           &quot;Median Abundance\nAA&quot;             
## [11] &quot;Median Abundance\nBB&quot;              &quot;Log2FoldChange (Rank)\nAA_vs_BB&quot;  
## [13] &quot;Mean Rank Abundance\nAA&quot;           &quot;Mean Rank Abundance\nBB&quot;          
## [15] &quot;Occurrence (100%)\n(All)&quot;          &quot;Occurrence (100%)\nAA&quot;            
## [17] &quot;Occurrence (100%)\nBB&quot;             &quot;Odds Ratio (95% CI)&quot;</code></pre>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="examples.html#cb309-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(dada2_ps_wilcox)</span></code></pre></div>
<div id="htmlwidget-c77ebcfe84f50eae167e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c77ebcfe84f50eae167e">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99"],["g__Acidaminococcus","g__Actinomyces","g__Adlercreutzia","g__Agathobacter","g__Akkermansia","g__Alistipes","g__Allisonella","g__Anaerofustis","g__Anaerostipes","g__Bacteroides","g__Barnesiella","g__Bifidobacterium","g__Bilophila","g__Blautia","g__Butyricicoccus","g__Butyricimonas","g__CAG.56","g__Candidatus_Soleaferrea","g__Candidatus_Stoquefichus","g__Christensenellaceae_R.7_group","g__Clostridium_sensu_stricto_1","g__Collinsella","g__Coprococcus_1","g__Coprococcus_3","g__Corynebacterium","g__Dialister","g__Dorea","g__Eggerthella","g__Enterococcus","g__Erysipelatoclostridium","g__Erysipelotrichaceae_UCG.003","g__Escherichia.Shigella","g__Eubacterium","g__F0332","g__Faecalibacterium","g__Faecalitalea","g__Family_XIII_AD3011_group","g__Family_XIII_UCG.001","g__Flavonifractor","g__Fusicatenibacter","g__Fusobacterium","g__GCA.900066225","g__GCA.900066575","g__Gemella","g__Gordonibacter","g__Granulicatella","g__Haemophilus","g__Holdemania","g__Hungatella","g__Intestinibacter","g__Intestinimonas","g__Klebsiella","g__Lachnoclostridium","g__Lachnospira","g__Lachnospiraceae_FCS020_group","g__Lachnospiraceae_ND3007_group","g__Lachnospiraceae_NK4A136_group","g__Lachnospiraceae_UCG.001","g__Lachnospiraceae_UCG.004","g__Lachnospiraceae_UCG.010","g__Lactobacillus","g__Lactococcus","g__Marvinbryantia","g__Megasphaera","g__Mogibacterium","g__Odoribacter","g__Olsenella","g__Oscillibacter","g__Parabacteroides","g__Paraprevotella","g__Parasutterella","g__Peptostreptococcus","g__Phascolarctobacterium","g__Romboutsia","g__Roseburia","g__Rothia","g__Ruminiclostridium_5","g__Ruminiclostridium_9","g__Ruminococcaceae_NK4A214_group","g__Ruminococcaceae_UCG.002","g__Ruminococcaceae_UCG.003","g__Ruminococcaceae_UCG.004","g__Ruminococcaceae_UCG.005","g__Ruminococcaceae_UCG.013","g__Ruminococcaceae_UCG.014","g__Ruminococcus_1","g__Ruminococcus_2","g__Sellimonas","g__Solobacterium","g__Streptococcus","g__Subdoligranulum","g__Sutterella","g__Terrisporobacter","g__Turicibacter","g__Tyzzerella","g__Tyzzerella_4","g__UBA1819","g__Veillonella","g__Weissella"],["9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB","9_AA vs 14_BB"],["Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif"],[0.351067091505899,1.24541789258339,0.0328474338194665,0.984114701452806,0.116884848820747,0.44725489804849,0.355321594262234,1.93895548971222,0.940825570265939,0.949337652086745,1.21607041541101,0.90632762537376,0.387354695086838,0.0763342300373258,0.194934530373848,0.014523695806578,0.264627865673045,0.754513431652828,0.0135754981941468,0.759458918813728,1.76576054015392,1.11398524251183,0.506183992894821,0.097557372053707,0.955482665607194,0.648206340444553,0.188423923225191,0.217201167387914,1.22567789705104,1.06671261288849,0.0238329198266113,1.06969729629702,1.11705408471631,1.92736945297062,0.753909257957606,0.123985741699757,0.684287031602621,0.507007687521312,1.25761860324351,0.0682435292605851,0.995498049905501,1.11979069219672,0.689312509877303,0.106147939690073,2.08327067136222,0.66929396666025,0.882531845229306,1.52443021120083,0.652968314822514,1.93646388079109,0.394864067200335,0.646594427769016,0.139498951178672,1.01598982271099,0.0976684663336369,0.121771878760874,0.925651254504529,0.955138790478283,0.0636869292470512,0.556002532407089,1.57178573353465,0.237027415498765,0.318323061192548,0.419157728385525,0.207985734497744,1.65017953572966,0.513499154643453,1.13233566411709,1.01268318660401,0.149626603026294,0.988766218970677,0.965924338939145,1.15745438959573,0.0903260391108538,0.417886665516122,1.26350670379677,1.37059512719979,1.67717734265198,0.981137037027281,0.50506693648722,0.623774034961692,0.997630333516965,0.737252641187352,0.631664278035217,0.119788773868628,0.152145906703519,0.244833208095791,1.18732059563593,1.22726274817012,1.21476270769602,0.411710370691621,0.162709952828813,1.39546638478468,1.16781788641954,0.971972326378045,1.36276159752544,0.984854414527017,1.99446556894068,0.177571566421726],[63.5,46.5,44,71,64.5,65,60,82,59,86,79.5,48,74,75,70,67,66,46,53.5,67,20,61.5,81.5,46.5,52.5,40,78.5,67,46,60,62.5,84,78.5,42,81,66,47,72,57,62,58,75,56,56.5,72,57.5,53,85,67,23,62.5,62,78,58.5,59.5,72,68,54,68,87,29,58,45,68,44,97,54.5,72,74,66,97.5,52,79.5,22,35.5,49.5,41,88,79.5,74,76,100,74,43,64.5,53.5,76,55,49,43,76.5,43,39,51,87,39,44.5,35.5,59],[1,0.312301575701766,0.198152007825862,0.629397089516132,0.930470669827365,0.924061560726317,0.838470421850829,0.1314284451001,0.829075245658904,0.15944639557508,0.216133999769745,0.368580134362878,0.483546753883731,0.476706763420991,0.677961592645618,0.807652817256383,0.846754172240083,0.25108533513945,0.486590781534907,0.795449850554815,0.0057743634901065,0.947592587897687,0.164079060140954,0.292944548929254,0.43949514483593,0.117566757969275,0.324155803743014,0.825328005999552,0.278121392911908,0.874244755559272,1,0.19612986257346,0.246224315443745,0.113024432324794,0.263579437351936,0.861946769563302,0.292026049489345,0.488252262242792,0.727695979771933,0.974093708425079,0.763977918561373,0.315665121096948,0.651174603928536,0.683362509409789,0.570605438087561,0.699109364165374,0.481649394124717,0.07958256661888,0.775344960504122,0.0103033206720371,1,0.974653115180391,0.368580134362878,0.792611467731272,0.838400776362366,0.570605438087561,0.770080304592245,0.458300788759842,0.727937283362317,0.0926925118681337,0.0346530107106623,0.713670722996252,0.234185129576082,0.738901093642829,0.170602610440109,0.0253991100829378,0.536287434866014,0.570605438087561,0.507912010807012,0.846754172240083,0.0286931992148827,0.359586603139656,0.309279732784238,0.0103485641166895,0.082339127079676,0.352311305778168,0.175510800159201,0.107312493044943,0.216133999769745,0.475358124255667,0.275423201650802,0.0148731961480917,0.436733595407211,0.205333160208626,0.930470669827365,0.486590781534907,0.384583158445056,0.610157427405238,0.317345927715731,0.224378663468716,0.392831742710791,0.184969987050324,0.0817513777374036,0.43435087909605,0.0817513777374036,0.0817513777374036,0.246789975964743,0.0759446650162133,0.775344960504122],[1,0.746312199315312,0.746312199315312,0.930004654658166,0.990501035622679,0.990501035622679,0.952598443770094,0.722856448050549,0.952598443770094,0.746312199315312,0.746312199315312,0.776370921317551,0.805616232700606,0.805616232700606,0.952598443770094,0.952598443770094,0.952598443770094,0.746312199315312,0.805616232700606,0.952598443770094,0.341502615850752,0.997996448956075,0.746312199315312,0.746312199315312,0.805616232700606,0.684653472879896,0.746312199315312,0.952598443770094,0.746312199315312,0.961669231115199,1,0.746312199315312,0.746312199315312,0.684653472879896,0.746312199315312,0.958794721199628,0.746312199315312,0.805616232700606,0.952598443770094,1,0.952598443770094,0.746312199315312,0.948033614543016,0.952598443770094,0.869075974933362,0.952598443770094,0.805616232700606,0.627044121606763,0.952598443770094,0.341502615850752,1,1,0.776370921317551,0.952598443770094,0.952598443770094,0.869075974933362,0.952598443770094,0.805616232700606,0.952598443770094,0.655468476781803,0.490092580050796,0.952598443770094,0.746312199315312,0.952598443770094,0.746312199315312,0.473437787045564,0.856329936318313,0.869075974933362,0.824316214260561,0.952598443770094,0.473437787045564,0.776370921317551,0.746312199315312,0.341502615850752,0.627044121606763,0.776370921317551,0.746312199315312,0.684653472879896,0.746312199315312,0.805616232700606,0.746312199315312,0.36811160466527,0.805616232700606,0.746312199315312,0.990501035622679,0.805616232700606,0.793202764292928,0.915236141107857,0.746312199315312,0.746312199315312,0.793680459762618,0.746312199315312,0.627044121606763,0.805616232700606,0.627044121606763,0.627044121606763,0.746312199315312,0.627044121606763,0.952598443770094],[null,-1.3311167032088,null,0.0831672257775516,null,-0.324006140696379,null,null,0.764052565125261,1.54540019882683,null,-0.432031638917639,4.26441962839463,0.0219657410509749,2.02489663533828,null,null,null,null,null,null,-0.181277903575787,null,null,null,null,1.4868355581883,1.16789401277888,null,0.119980042466489,null,2.4975481355715,null,null,2.30053778448279,null,null,null,-0.0139631792407967,0.0735146321526736,null,null,null,null,null,null,null,null,null,null,null,1.04677804807035,0.673294355627672,null,null,2.06702996412364,-0.557957803744353,null,null,null,-3.13926309498725,null,null,null,null,null,null,null,1.79924965356514,null,5.1094067925717,null,1.88289346268476,-6.32359537281917,null,null,-0.50020946100658,null,null,null,null,null,null,-2.81127091082714,null,null,null,null,null,-1.05734642569605,1.64726529287322,null,null,null,null,null,-1.94614448238367,null,null],[0,0.000751201923076923,0,0.00649168690453951,0,0.00140776912586336,0,0,0.0122015259629939,0.0853716917044703,0,0.154756361445123,8.73489590915708e-05,0.178217415395982,0.00672378266999241,0,0,0,0,0,0.000163776690482527,0.00792906644924582,0,0.00184361782886889,0,0,0.0100758305752231,0.000964023464741355,0.000820662456972211,0.00164180023395653,0,0.00151325176185741,0,0,0.030332259322347,0,0,0,0.000675578848240424,0.0103362934925025,4.7142015321155e-05,0,0,0,5.00801282051282e-05,0,0,0,0,0.000328686077405571,0,0.00111203780928552,0.00884936557857065,0.000216178823122487,0,0.000931722230310089,0.000387535049125767,0,0,0,0.00123067622419898,0,0,0,0,6.58082348037818e-05,0,0.000102360431551579,0.00417170082294208,0,0.000203814237880332,0,0.000574311851335275,0.00214956906258317,0.00261845908919519,0,0.00101731987080038,0.000167581381708492,0,0,0,0.0002412968609472,0,0.000701954504573672,0,0,0,0,0,0.0217347756410256,0.0140556179290094,0,0,0,0,0,0.000264981655116184,0.000282718207052534,0],[0,0.000553960819862013,0,0.00681720474133519,0,0.00139881482235052,0,0,0.0199533053742055,0.197765968983841,0,0.119352328245925,0.000839355538722951,0.178217415395982,0.00711373827965756,0,0,0,0,0,0,0.00792906644924582,0,0,0,0,0.0141199436069841,0.00188343194054906,0,0.00164180023395653,0,0.00618489583333333,0,0,0.0978635722806637,0,0,0,0.000675578848240424,0.0103549656275671,0,0,0,0,7.07130229817325e-05,0,0,0,0,0,0,0.00196722729041463,0.0107215654300856,0,0,0.00195206593644941,0.000281032470059233,0,0,0.00069302894415002,0.000600961538461538,0,0,0,0,0.0006156750877337,0,0.000390413187289882,0.00479046819661392,0,0.00105927623330019,0,0.0016870624968525,7.55401117993655e-05,0,0,0.000944035134525007,0.000451495064338047,0,0.000102360431551579,0,0.00252209781968179,0,0.000285364859355891,0,0,0.00718287602355983,0,0,0.0135140644109254,0.022013860578883,0,0,0,7.51201923076923e-05,0,8.67584860644182e-05,0,0],[0,0.00139375072000114,0.00019485580670304,0.0064353253409353,0,0.00175103889404836,0,0,0.0117493031354882,0.0677547498729874,0,0.161022059759656,4.36744795457854e-05,0.175524520005539,0.00174800736334087,0,0,2.5701655186594e-05,0,0,0.00113036401106323,0.00899067179445217,0,0.00468897238484591,0,0.00184453647645527,0.00503791528761155,0.000838260113059856,0.00119348947369649,0.00151078519939455,0.000378512156063474,0.00109520516979951,0,0,0.019865073914512,0,0.000581177959577008,0,0.00068214920846524,0.00984053141731978,0.000137902630929432,0,4.36744795457854e-05,8.56677803478112e-05,0,0,0,0,0,0.00152800387903691,0,0.000952232388751385,0.00672320576816234,0.000450383219214918,0.000252264900081164,0.000465861115155044,0.000413731450479033,0,0,0,0.00529491550239659,0,0.000484618712063516,0,0,0,0,0,0.00137641642303935,0,3.06848866704852e-05,0,0.000457429069363729,0.00605019693029388,0.00517325303556696,4.63349087202298e-05,0.00133526113949728,0,0,0,0,0,0,0.00200298345475004,0,0,0,0.000201735051351092,0,0.0281241220827511,0.00702780896450471,0.00028554410898065,0.000151994163424125,9.58032879963053e-05,0,0.000102582807121526,0.000334318053894777,0.000977916274741227,0],[0.0120125177019796,-0.374030691150552,-0.433877581714941,0.173426860147173,0.0335804529680726,0.0431402752727261,-0.0652586392800552,0.407219837096075,-0.0883435178719827,0.490986352512142,0.354100657323679,-0.339418886930374,0.237935898702265,0.258927547748941,0.152253975115257,0.0872454096293871,0.0646090814230765,-0.385847469343813,-0.212942007346851,0.0872454096293871,-1.06160867471065,-0.0337487913545403,0.396684947384981,-0.374030691150552,-0.235464004137893,-0.530984879662331,0.333276527455905,0.0872454096293871,-0.385847469343813,-0.0652586392800552,-0.012032555494897,0.448649281708661,0.333276527455905,-0.481371612461352,0.386468347082073,0.0646090814230765,-0.362570079384708,0.194548788411135,-0.133678435231969,-0.0216769610093656,-0.111591691125985,0.258927547748941,-0.155855418940656,-0.143537000625208,0.194548788411135,-0.12140844043249,-0.222960076288052,0.469331584367405,0.0872454096293871,-0.974975976317524,-0.012032555494897,-0.0216769610093656,0.322719841934155,-0.0993683948631638,-0.0774137770243665,0.194548788411135,0.109745405983343,-0.200492939765081,0.109745405983343,0.511625888779422,-0.811861000809515,-0.111591691125985,-0.410341104614087,0.109745405983343,-0.433877581714941,0.721506375527433,-0.189216890093513,0.194548788411135,0.237935898702265,0.0646090814230765,0.73060008413167,-0.246659086129131,0.354100657323679,-1.00483963902651,-0.642952205026335,-0.30367639033114,-0.505338197438106,0.533663403268349,0.354100657323679,0.237935898702265,0.279877915997208,0.783376059123164,0.237935898702265,-0.457552934475209,0.0335804529680726,-0.212942007346851,0.279877915997208,-0.178125833031416,-0.316389911345932,-0.457552934475209,0.290219235160024,-0.457552934475209,-0.555279584927467,-0.269330466503522,0.511625888779422,-0.555279584927467,-0.422276325508976,-0.642952205026335,-0.0883435178719827],[12.06,10.17,9.89,12.89,12.17,12.22,11.67,14.11,11.56,14.56,13.83,10.33,13.22,13.33,12.78,12.44,12.33,10.11,10.94,12.44,7.22,11.83,14.06,10.17,10.83,9.44,13.72,12.44,10.11,11.67,11.94,14.33,13.72,9.67,14,12.33,10.22,13,11.33,11.89,11.44,13.33,11.22,11.28,13,11.39,10.89,14.44,12.44,7.56,11.94,11.89,13.67,11.5,11.61,13,12.56,11,12.56,14.67,8.22,11.44,10,12.56,9.89,15.78,11.06,13,13.22,12.33,15.83,10.78,13.83,7.44,8.94,10.5,9.56,14.78,13.83,13.22,13.44,16.11,13.22,9.78,12.17,10.94,13.44,11.11,10.44,9.78,13.5,9.78,9.33,10.67,14.67,9.33,9.94,8.94,11.56],[11.96,13.18,13.36,11.43,11.89,11.86,12.21,10.64,12.29,10.36,10.82,13.07,11.21,11.14,11.5,11.71,11.79,13.21,12.68,11.71,15.07,12.11,10.68,13.18,12.75,13.64,10.89,11.71,13.21,12.21,12.04,10.5,10.89,13.5,10.71,11.79,13.14,11.36,12.43,12.07,12.36,11.14,12.5,12.46,11.36,12.39,12.71,10.43,11.71,14.86,12.04,12.07,10.93,12.32,12.25,11.36,11.64,12.64,11.64,10.29,14.43,12.36,13.29,11.64,13.36,9.57,12.61,11.36,11.21,11.79,9.54,12.79,10.82,14.93,13.96,12.96,13.57,10.21,10.82,11.21,11.07,9.36,11.21,13.43,11.89,12.68,11.07,12.57,13,13.43,11.04,13.43,13.71,12.86,10.29,13.71,13.32,13.96,12.29],[21.74,82.61,43.48,65.22,21.74,73.91,26.09,26.09,95.65,100,30.43,100,52.17,100,69.57,43.48,30.43,43.48,30.43,34.78,60.87,56.52,30.43,56.52,30.43,43.48,56.52,86.96,56.52,78.26,47.83,86.96,30.43,30.43,69.57,43.48,47.83,26.09,78.26,60.87,52.17,21.74,43.48,47.83,52.17,30.43,34.78,26.09,26.09,60.87,21.74,73.91,95.65,56.52,47.83,52.17,60.87,21.74,30.43,39.13,86.96,26.09,47.83,34.78,34.78,52.17,30.43,52.17,86.96,30.43,65.22,21.74,73.91,78.26,65.22,39.13,91.3,56.52,30.43,47.83,21.74,52.17,34.78,60.87,21.74,30.43,43.48,47.83,34.78,100,56.52,47.83,34.78,47.83,34.78,34.78,65.22,56.52,26.09],[22.22,88.89,33.33,55.56,22.22,77.78,22.22,44.44,100,100,44.44,100,55.56,100,77.78,44.44,33.33,33.33,22.22,33.33,22.22,66.67,44.44,44.44,22.22,22.22,66.67,88.89,33.33,88.89,44.44,88.89,44.44,11.11,66.67,44.44,33.33,33.33,88.89,55.56,44.44,33.33,33.33,44.44,66.67,22.22,22.22,44.44,33.33,22.22,22.22,77.78,100,44.44,44.44,55.56,55.56,11.11,33.33,55.56,77.78,22.22,33.33,33.33,22.22,77.78,22.22,66.67,100,33.33,88.89,11.11,88.89,55.56,44.44,22.22,100,77.78,44.44,55.56,33.33,77.78,44.44,55.56,22.22,22.22,55.56,33.33,22.22,100,66.67,33.33,11.11,33.33,55.56,11.11,66.67,22.22,22.22],[21.43,78.57,50,71.43,21.43,71.43,28.57,14.29,92.86,100,21.43,100,50,100,64.29,42.86,28.57,50,35.71,35.71,85.71,50,21.43,64.29,35.71,57.14,50,85.71,71.43,71.43,50,85.71,21.43,42.86,71.43,42.86,57.14,21.43,71.43,64.29,57.14,14.29,50,50,42.86,35.71,42.86,14.29,21.43,85.71,21.43,71.43,92.86,64.29,50,50,64.29,28.57,28.57,28.57,92.86,28.57,57.14,35.71,42.86,35.71,35.71,42.86,78.57,28.57,50,28.57,64.29,92.86,78.57,50,85.71,42.86,21.43,42.86,14.29,35.71,28.57,64.29,21.43,35.71,35.71,57.14,42.86,100,50,57.14,50,57.14,21.43,50,64.29,78.57,28.57],["0.68 (-0.091;1.4)","4.4 (7.3;1.5)","12 (17;7.2)","0.38 (-1.5;2.3)","1.5 (2.3;0.7)","0.93 (0.78;1.1)","1.1 (1.2;0.93)","0.53 (-0.69;1.8)","1.1 (1.2;0.93)","0.49 (-0.92;1.9)","0.5 (-0.88;1.9)","1.6 (2.4;0.69)","0.42 (-1.3;2.1)","0.65 (-0.19;1.5)","0.79 (0.33;1.3)","0.77 (0.25;1.3)","0.92 (0.77;1.1)","3.8 (6.4;1.2)","1.7 (2.7;0.66)","0.62 (-0.32;1.6)","8700 (8700;8700)","2 (3.4;0.64)","0.38 (-1.5;2.3)","2.9 (5;0.81)","1.4 (2.2;0.72)","2.2 (3.7;0.65)","0.51 (-0.79;1.8)","1.7 (2.7;0.66)","2.3 (4;0.67)","2.3 (3.9;0.66)","0.9 (0.68;1.1)","0.92 (0.76;1.1)","0.38 (-1.5;2.3)","2.7 (4.6;0.74)","0.39 (-1.5;2.2)","0.65 (-0.2;1.5)","2 (3.3;0.64)","0.52 (-0.77;1.8)","1.9 (3.1;0.64)","0.89 (0.66;1.1)","0.81 (0.41;1.2)","1 (1;0.99)","1.2 (1.5;0.86)","1.1 (1.2;0.94)","0.99 (0.98;1)","0.89 (0.66;1.1)","0.63 (-0.27;1.5)","0.13 (-3.8;4.1)","2.3 (4;0.67)","3.2 (5.6;0.94)","68 (77;60)","2 (3.4;0.64)","0.67 (-0.12;1.5)","0.73 (0.13;1.3)","1.1 (1.3;0.92)","0.73 (0.11;1.3)","0.42 (-1.3;2.1)","0.48 (-0.95;1.9)","0.76 (0.22;1.3)","0.3 (-2.1;2.7)","2.2e+08 (2.2e+08;2.2e+08)","1.2 (1.6;0.84)","3.8 (6.4;1.2)","0.52 (-0.75;1.8)","2e+55 (2e+55;2e+55)","0.31 (-2;2.6)","1.8 (3;0.65)","0.96 (0.87;1)","1.3 (1.7;0.81)","1.3 (1.7;0.81)","0.0043 (-11;11)","2.4 (4.1;0.68)","1.3 (1.8;0.8)","90 (99;81)","81 (90;72)","1.1 (1.4;0.88)","2.5 (4.3;0.71)","0.57 (-0.55;1.7)","1.2 (1.5;0.85)","0.65 (-0.21;1.5)","0.18 (-3.2;3.5)","0.16 (-3.4;3.7)","0.82 (0.43;1.2)","3 (5.1;0.84)","1.4 (2.1;0.73)","1.7 (2.8;0.66)","0.63 (-0.27;1.5)","1.3 (1.7;0.8)","1.9 (3.1;0.64)","2.9 (5;0.82)","0.73 (0.098;1.4)","1.9 (3.1;0.64)","3.3 (5.6;0.96)","0.91 (0.72;1.1)","0.41 (-1.4;2.2)","2.1 (3.5;0.64)","3.6 (6;1.1)","1.4 (2;0.76)","0.95 (0.84;1.1)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>TaxaID<\/th>\n      <th>Block<\/th>\n      <th>Enrichment<\/th>\n      <th>EffectSize<\/th>\n      <th>Statistic<\/th>\n      <th>Pvalue<\/th>\n      <th>AdjustedPvalue<\/th>\n      <th>Log2FoldChange (Median)\nAA_vs_BB<\/th>\n      <th>Median Abundance\n(All)<\/th>\n      <th>Median Abundance\nAA<\/th>\n      <th>Median Abundance\nBB<\/th>\n      <th>Log2FoldChange (Rank)\nAA_vs_BB<\/th>\n      <th>Mean Rank Abundance\nAA<\/th>\n      <th>Mean Rank Abundance\nBB<\/th>\n      <th>Occurrence (100%)\n(All)<\/th>\n      <th>Occurrence (100%)\nAA<\/th>\n      <th>Occurrence (100%)\nBB<\/th>\n      <th>Odds Ratio (95% CI)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,5,6,7,8,9,10,11,12,13,14,15,16,17]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<ul>
<li>Volcano</li>
</ul>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="examples.html#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_volcano</span>(</span>
<span id="cb310-2"><a href="examples.html#cb310-2" aria-hidden="true" tabindex="-1"></a>    dada2_ps_wilcox,</span>
<span id="cb310-3"><a href="examples.html#cb310-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">group_names =</span> <span class="fu">c</span>(<span class="st">&quot;AA&quot;</span>, <span class="st">&quot;BB&quot;</span>),</span>
<span id="cb310-4"><a href="examples.html#cb310-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_index =</span> <span class="st">&quot;Log2FoldChange (Rank)</span><span class="sc">\n</span><span class="st">AA_vs_BB&quot;</span>,</span>
<span id="cb310-5"><a href="examples.html#cb310-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_index_cutoff =</span> <span class="fl">0.5</span>,</span>
<span id="cb310-6"><a href="examples.html#cb310-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_index =</span> <span class="st">&quot;Pvalue&quot;</span>,</span>
<span id="cb310-7"><a href="examples.html#cb310-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_index_cutoff =</span> <span class="fl">0.05</span>,</span>
<span id="cb310-8"><a href="examples.html#cb310-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">group_color =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;grey&quot;</span>, <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb310-9"><a href="examples.html#cb310-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">topN =</span> <span class="dv">5</span>,</span>
<span id="cb310-10"><a href="examples.html#cb310-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">taxa_name =</span> <span class="cn">NULL</span></span>
<span id="cb310-11"><a href="examples.html#cb310-11" aria-hidden="true" tabindex="-1"></a>   )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-163"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-163-1.png" alt="Wilcoxon Rank-Sum test (16s example)" width="768" />
<p class="caption">
Figure 12.10: Wilcoxon Rank-Sum test (16s example)
</p>
</div>
</div>
</div>
</div>
<div id="metagenomics" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Metagenomics<a href="examples.html#metagenomics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The metagenomic data analysis pipeline is just the same as 16s. In briefly, the example comprises the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Converting inputs into phyloseq object;</p></li>
<li><p>Quality Evaluation;</p></li>
<li><p>Pre-Processing Data;</p></li>
<li><p>Diversity analysis;</p></li>
<li><p>Ordination analysis;</p></li>
<li><p>Composition analysis;</p></li>
</ol>
<div id="converting-inputs-into-phyloseq-class-object-1" class="section level3 hasAnchor" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> Converting inputs into phyloseq-class object<a href="examples.html#converting-inputs-into-phyloseq-class-object-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The result of the in-house <strong><a href="https://huttenhower.sph.harvard.edu/metaphlan2">Metaphlan2/3</a></strong> pipeline:</p>
<ol style="list-style-type: decimal">
<li><p>/home/xuxiaomin/project/standardized_analytics_workflow_R_function/demo_data/MGS/metaphlan2_merged.tsv</p></li>
<li><p>/home/xuxiaomin/project/standardized_analytics_workflow_R_function/demo_data/MGS/metadata.txt</p></li>
</ol>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="examples.html#cb311-1" aria-hidden="true" tabindex="-1"></a>metaphlan2_res <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb311-2"><a href="examples.html#cb311-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">system.file</span>(</span>
<span id="cb311-3"><a href="examples.html#cb311-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;metaphlan2_merged.tsv&quot;</span>,</span>
<span id="cb311-4"><a href="examples.html#cb311-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">package =</span> <span class="st">&quot;XMAS&quot;</span></span>
<span id="cb311-5"><a href="examples.html#cb311-5" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb311-6"><a href="examples.html#cb311-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cn">TRUE</span>, </span>
<span id="cb311-7"><a href="examples.html#cb311-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb311-8"><a href="examples.html#cb311-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb311-9"><a href="examples.html#cb311-9" aria-hidden="true" tabindex="-1"></a>metaphlan2_sam <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb311-10"><a href="examples.html#cb311-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">system.file</span>(</span>
<span id="cb311-11"><a href="examples.html#cb311-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;metaphlan2_metadata.tsv&quot;</span>,</span>
<span id="cb311-12"><a href="examples.html#cb311-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">package =</span> <span class="st">&quot;XMAS&quot;</span></span>
<span id="cb311-13"><a href="examples.html#cb311-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb311-14"><a href="examples.html#cb311-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,</span>
<span id="cb311-15"><a href="examples.html#cb311-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb311-16"><a href="examples.html#cb311-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb311-17"><a href="examples.html#cb311-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb311-18"><a href="examples.html#cb311-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-19"><a href="examples.html#cb311-19" aria-hidden="true" tabindex="-1"></a>metaphlan2_res_list <span class="ot">&lt;-</span> <span class="fu">import_metaphlan_taxa</span>(metaphlan2_res, <span class="at">taxa_level =</span> <span class="st">&quot;Species&quot;</span>)</span>
<span id="cb311-20"><a href="examples.html#cb311-20" aria-hidden="true" tabindex="-1"></a>otu_tab <span class="ot">&lt;-</span> metaphlan2_res_list<span class="sc">$</span>abu_tab</span>
<span id="cb311-21"><a href="examples.html#cb311-21" aria-hidden="true" tabindex="-1"></a>tax_tab <span class="ot">&lt;-</span> metaphlan2_res_list<span class="sc">$</span>tax_tab</span>
<span id="cb311-22"><a href="examples.html#cb311-22" aria-hidden="true" tabindex="-1"></a>sam_tab <span class="ot">&lt;-</span> metaphlan2_sam <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb311-23"><a href="examples.html#cb311-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-24"><a href="examples.html#cb311-24" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps <span class="ot">&lt;-</span> <span class="fu">import_metaphlan2</span>(<span class="at">otu_tab =</span> otu_tab, </span>
<span id="cb311-25"><a href="examples.html#cb311-25" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">sam_tab =</span> sam_tab,</span>
<span id="cb311-26"><a href="examples.html#cb311-26" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">tax_tab =</span> tax_tab)</span>
<span id="cb311-27"><a href="examples.html#cb311-27" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps</span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 326 taxa and 23 samples ]
## sample_data() Sample Data:       [ 23 samples by 2 sample variables ]
## tax_table()   Taxonomy Table:    [ 326 taxa by 7 taxonomic ranks ]</code></pre>
<p>Here, the phyloseq object comprises three components (<em>OTU Table</em>, <em>Sample Data</em> and <em>Taxonomy Table</em>).</p>
<div id="summarize-phyloseq-class-object-2" class="section level4 hasAnchor" number="12.3.1.1">
<h4><span class="header-section-number">12.3.1.1</span> Summarize phyloseq-class object<a href="examples.html#summarize-phyloseq-class-object-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="examples.html#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize_phyloseq</span>(metaphlan2_ps)</span></code></pre></div>
<pre><code>## Compositional = NO2</code></pre>
<pre><code>## 1] Min. number of reads = 0.98218212] Max. number of reads = 1.00000053] Total number of reads = 22.94511414] Average number of reads = 0.9976136565217395] Median number of reads = 0.99980247] Sparsity = 0.7131234995998936] Any OTU sum to 1 or less? YES8] Number of singletons = 3239] Percent of OTUs that are singletons
##         (i.e. exactly one read detected across all samples)010] Number of sample variables are: 2Groupphynotype2</code></pre>
<pre><code>## [[1]]
## [1] &quot;1] Min. number of reads = 0.9821821&quot;
## 
## [[2]]
## [1] &quot;2] Max. number of reads = 1.0000005&quot;
## 
## [[3]]
## [1] &quot;3] Total number of reads = 22.9451141&quot;
## 
## [[4]]
## [1] &quot;4] Average number of reads = 0.997613656521739&quot;
## 
## [[5]]
## [1] &quot;5] Median number of reads = 0.9998024&quot;
## 
## [[6]]
## [1] &quot;7] Sparsity = 0.713123499599893&quot;
## 
## [[7]]
## [1] &quot;6] Any OTU sum to 1 or less? YES&quot;
## 
## [[8]]
## [1] &quot;8] Number of singletons = 323&quot;
## 
## [[9]]
## [1] &quot;9] Percent of OTUs that are singletons\n        (i.e. exactly one read detected across all samples)0&quot;
## 
## [[10]]
## [1] &quot;10] Number of sample variables are: 2&quot;
## 
## [[11]]
## [1] &quot;Group&quot;     &quot;phynotype&quot;</code></pre>
<p>Notice the <strong>Sparsity (0.713)</strong>, indicating the data has many zeros and pay attention to the downstream data analysis.</p>
</div>
</div>
<div id="quality-control-1" class="section level3 hasAnchor" number="12.3.2">
<h3><span class="header-section-number">12.3.2</span> Quality Control<a href="examples.html#quality-control-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="spike-in-sample-brs-assessment-1" class="section level4 hasAnchor" number="12.3.2.1">
<h4><span class="header-section-number">12.3.2.1</span> Spike-in sample (BRS) assessment<a href="examples.html#spike-in-sample-brs-assessment-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="examples.html#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting the genus level phyloseq  </span></span>
<span id="cb317-2"><a href="examples.html#cb317-2" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps_species <span class="ot">&lt;-</span> <span class="fu">summarize_taxa</span>(metaphlan2_ps, <span class="at">taxa_level =</span> <span class="st">&quot;Species&quot;</span>)</span>
<span id="cb317-3"><a href="examples.html#cb317-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-4"><a href="examples.html#cb317-4" aria-hidden="true" tabindex="-1"></a>RefCheck_MGS <span class="ot">&lt;-</span> <span class="fu">run_RefCheck</span>(</span>
<span id="cb317-5"><a href="examples.html#cb317-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ps=</span>metaphlan2_ps_species,</span>
<span id="cb317-6"><a href="examples.html#cb317-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">group=</span><span class="st">&quot;Group&quot;</span>,</span>
<span id="cb317-7"><a href="examples.html#cb317-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">group_names=</span><span class="st">&quot;QC&quot;</span>,</span>
<span id="cb317-8"><a href="examples.html#cb317-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Reference=</span><span class="cn">NULL</span>,</span>
<span id="cb317-9"><a href="examples.html#cb317-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ref_type=</span><span class="st">&quot;MGS&quot;</span>,</span>
<span id="cb317-10"><a href="examples.html#cb317-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Save=</span><span class="cn">NULL</span></span>
<span id="cb317-11"><a href="examples.html#cb317-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb317-12"><a href="examples.html#cb317-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Noting: the Reference Matrix is for MGS</span></span>
<span id="cb317-13"><a href="examples.html#cb317-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb317-14"><a href="examples.html#cb317-14" aria-hidden="true" tabindex="-1"></a><span class="do">## #########Matched baterica of the Spike-in sample###########</span></span>
<span id="cb317-15"><a href="examples.html#cb317-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Identifying some taxa of the Reference Matrix are not in the dataset </span></span>
<span id="cb317-16"><a href="examples.html#cb317-16" aria-hidden="true" tabindex="-1"></a><span class="do">## s__Lactobacillus_salivarius</span></span>
<span id="cb317-17"><a href="examples.html#cb317-17" aria-hidden="true" tabindex="-1"></a><span class="do">## s__Bacteroides_fragilis</span></span>
<span id="cb317-18"><a href="examples.html#cb317-18" aria-hidden="true" tabindex="-1"></a><span class="do">## s__Parabacteroides_goldsteinii</span></span>
<span id="cb317-19"><a href="examples.html#cb317-19" aria-hidden="true" tabindex="-1"></a><span class="do">## s__Escherichia_coli</span></span>
<span id="cb317-20"><a href="examples.html#cb317-20" aria-hidden="true" tabindex="-1"></a><span class="do">## s__Enterococcus_faecalis</span></span>
<span id="cb317-21"><a href="examples.html#cb317-21" aria-hidden="true" tabindex="-1"></a><span class="do">## s__Bifidobacterium_bifidum</span></span>
<span id="cb317-22"><a href="examples.html#cb317-22" aria-hidden="true" tabindex="-1"></a><span class="do">## s__Lactobacillus_pentosus</span></span>
<span id="cb317-23"><a href="examples.html#cb317-23" aria-hidden="true" tabindex="-1"></a><span class="do">## s__Bacteroides_intestinalis</span></span>
<span id="cb317-24"><a href="examples.html#cb317-24" aria-hidden="true" tabindex="-1"></a><span class="do">## s__Eggerthella_unclassified</span></span>
<span id="cb317-25"><a href="examples.html#cb317-25" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb317-26"><a href="examples.html#cb317-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Checking out the additional Taxa are in the sequencing dataset</span></span>
<span id="cb317-27"><a href="examples.html#cb317-27" aria-hidden="true" tabindex="-1"></a><span class="do">## ###########################################################</span></span>
<span id="cb317-28"><a href="examples.html#cb317-28" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb317-29"><a href="examples.html#cb317-29" aria-hidden="true" tabindex="-1"></a><span class="do">## ##############Value of the Reference sample###############</span></span>
<span id="cb317-30"><a href="examples.html#cb317-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Correlation Coefficient of the Reference sample is: -0.06471</span></span>
<span id="cb317-31"><a href="examples.html#cb317-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Bray Curtis of the Reference sample is: 0.8752</span></span>
<span id="cb317-32"><a href="examples.html#cb317-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Impurity of the Reference sample is: 32.69</span></span>
<span id="cb317-33"><a href="examples.html#cb317-33" aria-hidden="true" tabindex="-1"></a><span class="do">## ###########################################################</span></span>
<span id="cb317-34"><a href="examples.html#cb317-34" aria-hidden="true" tabindex="-1"></a><span class="do">## #####Final Evaluation Results of the Spike-in sample#######</span></span>
<span id="cb317-35"><a href="examples.html#cb317-35" aria-hidden="true" tabindex="-1"></a><span class="do">## The spike-in sample of sequencing dataset didn&#39;t pass the cutoff of the Reference Matrix</span></span>
<span id="cb317-36"><a href="examples.html#cb317-36" aria-hidden="true" tabindex="-1"></a><span class="do">## ###########################################################</span></span></code></pre></div>
<p>The spike-in samples didn’t pass the cutoff and failed to add the the Reference Matrix.</p>
</div>
<div id="spike-in-samples-remove-1" class="section level4 hasAnchor" number="12.3.2.2">
<h4><span class="header-section-number">12.3.2.2</span> Spike-in sample’s remove<a href="examples.html#spike-in-samples-remove-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="examples.html#cb318-1" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps_NoQC <span class="ot">&lt;-</span> <span class="fu">get_GroupPhyloseq</span>(</span>
<span id="cb318-2"><a href="examples.html#cb318-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ps =</span> metaphlan2_ps,</span>
<span id="cb318-3"><a href="examples.html#cb318-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb318-4"><a href="examples.html#cb318-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group_names =</span> <span class="st">&quot;QC&quot;</span>,</span>
<span id="cb318-5"><a href="examples.html#cb318-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">discard =</span> <span class="cn">TRUE</span></span>
<span id="cb318-6"><a href="examples.html#cb318-6" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb318-7"><a href="examples.html#cb318-7" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps_NoQC</span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 326 taxa and 22 samples ]
## sample_data() Sample Data:       [ 22 samples by 2 sample variables ]
## tax_table()   Taxonomy Table:    [ 326 taxa by 7 taxonomic ranks ]</code></pre>
</div>
<div id="variability" class="section level4 hasAnchor" number="12.3.2.3">
<h4><span class="header-section-number">12.3.2.3</span> Variability<a href="examples.html#variability" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><strong>Coefficient of variation (C.V)</strong>, i.e. sd(x)/mean(x) is a widely used approach to measure heterogeneity in OTU/ASV abundance data.</li>
</ul>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="examples.html#cb320-1" aria-hidden="true" tabindex="-1"></a>pl <span class="ot">&lt;-</span> <span class="fu">plot_taxa_cv</span>(metaphlan2_ps_NoQC, <span class="at">plot.type =</span> <span class="st">&quot;scatter&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-168"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-168-1.png" alt="Density of the Taxa Mean abundance (MGS example)" width="672" />
<p class="caption">
Figure 12.11: Density of the Taxa Mean abundance (MGS example)
</p>
</div>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="examples.html#cb321-1" aria-hidden="true" tabindex="-1"></a>pl <span class="sc">+</span> <span class="fu">scale_x_log10</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-169"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-169-1.png" alt="Coefficient of variation (MGS example)" width="672" />
<p class="caption">
Figure 12.12: Coefficient of variation (MGS example)
</p>
</div>
<p>From the above two plots, we see that there are several species which have high C.V. and low mean.</p>
<ul>
<li>Checking for distribution of number of sequences</li>
</ul>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="examples.html#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_read_distribution</span>(metaphlan2_ps_NoQC, <span class="at">group=</span><span class="st">&quot;Group&quot;</span>, <span class="at">plot.type =</span> <span class="st">&quot;density&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-170"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-170-1.png" alt="Distribution of number of sequences (MGS example)" width="672" />
<p class="caption">
Figure 12.13: Distribution of number of sequences (MGS example)
</p>
</div>
<p>Different distribution of number of sequences between group <em>AA</em> and <em>BB</em>.</p>
</div>
</div>
<div id="data-processing-1" class="section level3 hasAnchor" number="12.3.3">
<h3><span class="header-section-number">12.3.3</span> Data processing<a href="examples.html#data-processing-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This part has too may procedures and we only choose some of them. Please go to <strong>Chapter 6</strong> to see more approaches and details for being familiar with this part.</p>
<div id="extracting-specific-taxonomic-level-1" class="section level4 hasAnchor" number="12.3.3.1">
<h4><span class="header-section-number">12.3.3.1</span> Extracting specific taxonomic level<a href="examples.html#extracting-specific-taxonomic-level-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="examples.html#cb323-1" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps_species <span class="ot">&lt;-</span> <span class="fu">summarize_taxa</span>(metaphlan2_ps_NoQC, <span class="at">taxa_level =</span> <span class="st">&quot;Species&quot;</span>)</span>
<span id="cb323-2"><a href="examples.html#cb323-2" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps_species</span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 325 taxa and 22 samples ]
## sample_data() Sample Data:       [ 22 samples by 2 sample variables ]
## tax_table()   Taxonomy Table:    [ 325 taxa by 7 taxonomic ranks ]</code></pre>
</div>
<div id="filtering-the-low-relative-abundance-or-unclassified-taxa-by-the-threshold-total-counts-1e-4" class="section level4 hasAnchor" number="12.3.3.2">
<h4><span class="header-section-number">12.3.3.2</span> Filtering the low relative abundance or unclassified taxa by the threshold (total counts &lt; 1e-4)<a href="examples.html#filtering-the-low-relative-abundance-or-unclassified-taxa-by-the-threshold-total-counts-1e-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="examples.html#cb325-1" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps_species_filter <span class="ot">&lt;-</span> <span class="fu">run_filter</span>(metaphlan2_ps_species, <span class="at">cutoff =</span> <span class="fl">1e-4</span>, <span class="at">unclass =</span> <span class="cn">TRUE</span>)</span>
<span id="cb325-2"><a href="examples.html#cb325-2" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps_species_filter </span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 233 taxa and 22 samples ]
## sample_data() Sample Data:       [ 22 samples by 2 sample variables ]
## tax_table()   Taxonomy Table:    [ 233 taxa by 7 taxonomic ranks ]</code></pre>
</div>
<div id="trimming-the-taxa-with-low-occurrence-less-than-threshold-1" class="section level4 hasAnchor" number="12.3.3.3">
<h4><span class="header-section-number">12.3.3.3</span> Trimming the taxa with low occurrence less than threshold<a href="examples.html#trimming-the-taxa-with-low-occurrence-less-than-threshold-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="examples.html#cb327-1" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps_species_filter_trim <span class="ot">&lt;-</span> <span class="fu">run_trim</span>(metaphlan2_ps_species_filter, <span class="at">cutoff =</span> <span class="fl">0.2</span>, <span class="at">trim =</span> <span class="st">&quot;feature&quot;</span>)</span>
<span id="cb327-2"><a href="examples.html#cb327-2" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps_final <span class="ot">&lt;-</span> metaphlan2_ps_species_filter_trim</span>
<span id="cb327-3"><a href="examples.html#cb327-3" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps_final</span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 144 taxa and 22 samples ]
## sample_data() Sample Data:       [ 22 samples by 2 sample variables ]
## tax_table()   Taxonomy Table:    [ 144 taxa by 7 taxonomic ranks ]</code></pre>
<p>Finally, we obtained the final phyloseq-class object <em>metaphlan2_ps_species_filter_trim</em> and changed its name.</p>
</div>
</div>
<div id="diversity-analysis-1" class="section level3 hasAnchor" number="12.3.4">
<h3><span class="header-section-number">12.3.4</span> Diversity analysis<a href="examples.html#diversity-analysis-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="alpha-diveristy-1" class="section level4 hasAnchor" number="12.3.4.1">
<h4><span class="header-section-number">12.3.4.1</span> Alpha diveristy<a href="examples.html#alpha-diveristy-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Calculate the alpha diversity</li>
</ul>
<p><strong>Notes:</strong> choosing the measures (<em>Shannon, Simpson and InvSimpson</em>) only for relative abundance.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="examples.html#cb329-1" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps_genus_alpha <span class="ot">&lt;-</span> <span class="fu">run_alpha_diversity</span>(<span class="at">ps=</span>metaphlan2_ps_NoQC, <span class="at">measures =</span> <span class="fu">c</span>(<span class="st">&quot;Shannon&quot;</span>, <span class="st">&quot;Simpson&quot;</span>, <span class="st">&quot;InvSimpson&quot;</span>))</span>
<span id="cb329-2"><a href="examples.html#cb329-2" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(metaphlan2_ps_genus_alpha)</span></code></pre></div>
<div id="htmlwidget-13d3113b03f1b846a059" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-13d3113b03f1b846a059">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22"],["s1","s2","s3","s4","s5","s6","s7","s8","s9","s10","s11","s12","s13","s14","s15","s16","s17","s18","s19","s20","s21","s22"],["BB","AA","BB","AA","AA","AA","BB","BB","BB","BB","BB","BB","BB","BB","BB","BB","AA","BB","BB","BB","AA","AA"],[0,2.5,0,1.25,30,15,8.75,0,3.75,2.5,15,2.5,2.5,0,1.07,2.5,5,35,7.5,15,3.75,3.75],[2.87600158768499,2.04539233869885,3.44117611994772,2.7469172562596,1.45072169425927,2.6199509193286,2.89751908665775,2.97172006041627,3.02066180013859,3.18502591655083,3.06736907722589,3.04704459677349,2.7838992417821,2.96614439261485,3.34506490182498,2.91391100078963,2.81277952299149,1.97816224774278,1.91166100940612,3.15434082279347,2.22525500416406,3.38676763871053],[0.910885740721574,0.810574170417666,0.943937119774493,0.829076757317215,0.641217839699691,0.89503686117821,0.919240703875622,0.888601335158955,0.894822383475912,0.930550291751187,0.921001492615739,0.902804899430806,0.881418103127103,0.920236736855303,0.94171938037692,0.921691174156033,0.886562457342054,0.794122962312653,0.730419204261905,0.925996371376016,0.83760976311228,0.929564684333857],[11.2215486959907,5.27911110224463,17.837114254166,5.85057938466505,2.78720658564232,9.52715411548276,12.3824754299479,8.97676827120772,9.50772638749593,14.3989085802544,12.6584670155328,10.2885844465801,8.43299041734728,12.5370999201214,17.1583625305862,12.7699526742047,8.81542368222266,4.85726825698085,3.70946304710639,13.5128509046638,6.15800567303452,14.1974234166836]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>SampleID<\/th>\n      <th>Group<\/th>\n      <th>phynotype<\/th>\n      <th>Shannon<\/th>\n      <th>Simpson<\/th>\n      <th>InvSimpson<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<ul>
<li>visualization</li>
</ul>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="examples.html#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_boxplot</span>(<span class="at">data=</span>metaphlan2_ps_genus_alpha,</span>
<span id="cb330-2"><a href="examples.html#cb330-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">y_index =</span> <span class="fu">c</span>(<span class="st">&quot;Shannon&quot;</span>, <span class="st">&quot;Simpson&quot;</span>, <span class="st">&quot;InvSimpson&quot;</span>),</span>
<span id="cb330-3"><a href="examples.html#cb330-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb330-4"><a href="examples.html#cb330-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">group_names =</span> <span class="fu">c</span>(<span class="st">&quot;AA&quot;</span>, <span class="st">&quot;BB&quot;</span>),</span>
<span id="cb330-5"><a href="examples.html#cb330-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">group_color =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb330-6"><a href="examples.html#cb330-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">do_test =</span> <span class="cn">TRUE</span>,</span>
<span id="cb330-7"><a href="examples.html#cb330-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">method =</span> <span class="st">&quot;wilcox.test&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-175"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-175-1.png" alt="Alpha diversity (MGS example)" width="576" />
<p class="caption">
Figure 12.14: Alpha diversity (MGS example)
</p>
</div>
</div>
<div id="beta-diversity-2" class="section level4 hasAnchor" number="12.3.4.2">
<h4><span class="header-section-number">12.3.4.2</span> Beta diversity<a href="examples.html#beta-diversity-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>beta dipersion</li>
</ul>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="examples.html#cb331-1" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps_beta <span class="ot">&lt;-</span> <span class="fu">run_beta_diversity</span>(<span class="at">ps=</span>metaphlan2_ps_final, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>, <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Permutation test for homogeneity of multivariate dispersions
## Permutation: free
## Number of permutations: 999
## 
## Response: Distances
##           Df  Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
## Groups     1 0.00725 0.0072500 0.8423    999  0.354
## Residuals 20 0.17215 0.0086076                     
## 
## Pairwise comparisons:
## (Observed p-value below diagonal, permuted p-value above diagonal)
##         AA    BB
## AA         0.369
## BB 0.36968</code></pre>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="examples.html#cb333-1" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps_beta<span class="sc">$</span>BetaDispersion</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-176"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-176-1.png" alt="Beta diversity (MGS example)" width="480" />
<p class="caption">
Figure 12.15: Beta diversity (MGS example)
</p>
</div>
</div>
</div>
<div id="permanova-ordination-1" class="section level3 hasAnchor" number="12.3.5">
<h3><span class="header-section-number">12.3.5</span> PERMANOVA + Ordination<a href="examples.html#permanova-ordination-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="permanova-1" class="section level4 hasAnchor" number="12.3.5.1">
<h4><span class="header-section-number">12.3.5.1</span> PERMANOVA<a href="examples.html#permanova-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="examples.html#cb334-1" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps_per <span class="ot">&lt;-</span> <span class="fu">run_permanova</span>(<span class="at">ps=</span>metaphlan2_ps_final, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb334-2"><a href="examples.html#cb334-2" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(metaphlan2_ps_per)</span></code></pre></div>
<div id="htmlwidget-74e676fb3d221427e838" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-74e676fb3d221427e838">{"x":{"filter":"none","vertical":false,"data":[["SampleID","Group","phynotype"],[22,22,22],[21,1,10],[6.86882919889401,0.864659030474406,3.50343060254529],[0.327087104709239,0.864659030474406,0.350343060254529],[0,2.88019495190956,1.14511655973855],[1,0.125881573909805,0.51004770989347],[1,0.002,0.173],[1,0.006,0.2595]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>SumsOfSample<\/th>\n      <th>Df<\/th>\n      <th>SumsOfSqs<\/th>\n      <th>MeanSqs<\/th>\n      <th>F.Model<\/th>\n      <th>R2<\/th>\n      <th>Pr(&gt;F)<\/th>\n      <th>AdjustedPvalue<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>The PERMANOVA result of the Group (AdjustedPvalue &lt; 0.05) revealed that the two groups had the distinct patterns of microbial community.</p>
</div>
<div id="ordination-2" class="section level4 hasAnchor" number="12.3.5.2">
<h4><span class="header-section-number">12.3.5.2</span> Ordination<a href="examples.html#ordination-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We performed ordination by using Uniform Manifold Approximation and Projection for Dimension Reduction (UMAP). If you want to try other methods please go to see <strong>Chapter 8</strong> for more details.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="examples.html#cb335-1" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps_ordination <span class="ot">&lt;-</span> <span class="fu">run_ordination</span>(</span>
<span id="cb335-2"><a href="examples.html#cb335-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ps =</span> metaphlan2_ps_final,</span>
<span id="cb335-3"><a href="examples.html#cb335-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb335-4"><a href="examples.html#cb335-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;UMAP&quot;</span>)</span>
<span id="cb335-5"><a href="examples.html#cb335-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-6"><a href="examples.html#cb335-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_Ordination</span>(<span class="at">ResultList =</span> metaphlan2_ps_ordination, </span>
<span id="cb335-7"><a href="examples.html#cb335-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>, </span>
<span id="cb335-8"><a href="examples.html#cb335-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">group_names =</span> <span class="fu">c</span>(<span class="st">&quot;AA&quot;</span>, <span class="st">&quot;BB&quot;</span>),</span>
<span id="cb335-9"><a href="examples.html#cb335-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">group_color =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb335-10"><a href="examples.html#cb335-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">circle_type =</span> <span class="st">&quot;ellipse_groups&quot;</span>,</span>
<span id="cb335-11"><a href="examples.html#cb335-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">sideboxplot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb335-12"><a href="examples.html#cb335-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">sample =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-178"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-178-1.png" alt="PCoA (MGS example)" width="576" />
<p class="caption">
Figure 12.16: PCoA (MGS example)
</p>
</div>
</div>
</div>
<div id="microbial-composition-1" class="section level3 hasAnchor" number="12.3.6">
<h3><span class="header-section-number">12.3.6</span> Microbial composition<a href="examples.html#microbial-composition-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="stacked-barplot-2" class="section level4 hasAnchor" number="12.3.6.1">
<h4><span class="header-section-number">12.3.6.1</span> Stacked barplot<a href="examples.html#stacked-barplot-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="examples.html#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_StackBarPlot</span>(</span>
<span id="cb336-2"><a href="examples.html#cb336-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">ps=</span>metaphlan2_ps_final,</span>
<span id="cb336-3"><a href="examples.html#cb336-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">taxa_level=</span><span class="st">&quot;Phylum&quot;</span>,</span>
<span id="cb336-4"><a href="examples.html#cb336-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb336-5"><a href="examples.html#cb336-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">cluster =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-179"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-179-1.png" alt="Microbial composition (MGS example)" width="768" />
<p class="caption">
Figure 12.17: Microbial composition (MGS example)
</p>
</div>
</div>
<div id="core-microbiota-2" class="section level4 hasAnchor" number="12.3.6.2">
<h4><span class="header-section-number">12.3.6.2</span> Core microbiota<a href="examples.html#core-microbiota-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>visualization</li>
</ul>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="examples.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb337-2"><a href="examples.html#cb337-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-3"><a href="examples.html#cb337-3" aria-hidden="true" tabindex="-1"></a>prevalences <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="dv">1</span>, <span class="fl">0.05</span>)</span>
<span id="cb337-4"><a href="examples.html#cb337-4" aria-hidden="true" tabindex="-1"></a>detections <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="fu">log10</span>(<span class="fl">1e-3</span>), <span class="fu">log10</span>(.<span class="dv">2</span>), <span class="at">length =</span> <span class="dv">10</span>)</span>
<span id="cb337-5"><a href="examples.html#cb337-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-6"><a href="examples.html#cb337-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_core_taxa</span>(metaphlan2_ps_final, </span>
<span id="cb337-7"><a href="examples.html#cb337-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot.type =</span> <span class="st">&quot;heatmap&quot;</span>, </span>
<span id="cb337-8"><a href="examples.html#cb337-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">colours =</span> <span class="fu">rev</span>(<span class="fu">brewer.pal</span>(<span class="dv">5</span>, <span class="st">&quot;Spectral&quot;</span>)),</span>
<span id="cb337-9"><a href="examples.html#cb337-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">prevalences =</span> prevalences, </span>
<span id="cb337-10"><a href="examples.html#cb337-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">detections =</span> detections, </span>
<span id="cb337-11"><a href="examples.html#cb337-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">min.prevalence =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb337-12"><a href="examples.html#cb337-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Detection Threshold (Relative Abundance (%))&quot;</span>) <span class="sc">+</span></span>
<span id="cb337-13"><a href="examples.html#cb337-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-180"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-180-1.png" alt="Core taxa (MGS example)" width="768" />
<p class="caption">
Figure 12.18: Core taxa (MGS example)
</p>
</div>
<p>The degree of color indicates the size of abundance and prevalence.</p>
<ul>
<li>Use <code>core_members</code> to obtain the core taxa. detection for abundance and prevalence for occurrence.</li>
</ul>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="examples.html#cb338-1" aria-hidden="true" tabindex="-1"></a>core_taxa_name <span class="ot">&lt;-</span> <span class="fu">core_members</span>(metaphlan2_ps_final, <span class="at">detection =</span> <span class="fl">0.001</span>, <span class="at">prevalence =</span> <span class="fl">0.5</span>)</span>
<span id="cb338-2"><a href="examples.html#cb338-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(core_taxa_name)</span></code></pre></div>
<pre><code>##  [1] &quot;s__Bacteroides_ovatus&quot;               
##  [2] &quot;s__Bacteroides_thetaiotaomicron&quot;     
##  [3] &quot;s__Bacteroides_uniformis&quot;            
##  [4] &quot;s__Bacteroides_vulgatus&quot;             
##  [5] &quot;s__Bifidobacterium_longum&quot;           
##  [6] &quot;s__Bifidobacterium_pseudocatenulatum&quot;
##  [7] &quot;s__Collinsella_aerofaciens&quot;          
##  [8] &quot;s__Escherichia_coli&quot;                 
##  [9] &quot;s__Eubacterium_eligens&quot;              
## [10] &quot;s__Eubacterium_hallii&quot;               
## [11] &quot;s__Faecalibacterium_prausnitzii&quot;     
## [12] &quot;s__Roseburia_inulinivorans&quot;          
## [13] &quot;s__Ruminococcus_gnavus&quot;              
## [14] &quot;s__Ruminococcus_obeum&quot;               
## [15] &quot;s__Ruminococcus_sp_5_1_39BFAA&quot;       
## [16] &quot;s__Ruminococcus_torques&quot;             
## [17] &quot;s__Streptococcus_salivarius&quot;</code></pre>
<p><strong>Result</strong>:</p>
<p>17 species passed the threshold of detection and prevalence which we choose.</p>
</div>
</div>
<div id="differential-analysis-2" class="section level3 hasAnchor" number="12.3.7">
<h3><span class="header-section-number">12.3.7</span> Differential Analysis<a href="examples.html#differential-analysis-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are more than 10 approaches to perform differential analysis. Here, we choose two of them and recommend users going to <strong>Chapter 10</strong> to see more detials.</p>
<div id="liner-discriminant-analysis-lda-effect-size-lefse-3" class="section level4 hasAnchor" number="12.3.7.1">
<h4><span class="header-section-number">12.3.7.1</span> Liner discriminant analysis (LDA) effect size (LEfSe)<a href="examples.html#liner-discriminant-analysis-lda-effect-size-lefse-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Calculation</li>
</ul>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="examples.html#cb340-1" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps_lefse <span class="ot">&lt;-</span> <span class="fu">run_lefse</span>(</span>
<span id="cb340-2"><a href="examples.html#cb340-2" aria-hidden="true" tabindex="-1"></a>                    metaphlan2_ps_final,</span>
<span id="cb340-3"><a href="examples.html#cb340-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb340-4"><a href="examples.html#cb340-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">group_names =</span> <span class="fu">c</span>(<span class="st">&quot;AA&quot;</span>, <span class="st">&quot;BB&quot;</span>),</span>
<span id="cb340-5"><a href="examples.html#cb340-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">transform =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb340-6"><a href="examples.html#cb340-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">norm =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb340-7"><a href="examples.html#cb340-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">kw.p =</span> <span class="fl">0.05</span>,</span>
<span id="cb340-8"><a href="examples.html#cb340-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">wl.p =</span> <span class="fl">0.05</span>,</span>
<span id="cb340-9"><a href="examples.html#cb340-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Lda =</span> <span class="dv">0</span>)</span>
<span id="cb340-10"><a href="examples.html#cb340-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(metaphlan2_ps_lefse)</span></code></pre></div>
<pre><code>##  [1] &quot;TaxaID&quot;                            &quot;Block&quot;                            
##  [3] &quot;Enrichment&quot;                        &quot;LDA_Score&quot;                        
##  [5] &quot;EffectSize&quot;                        &quot;Log2FoldChange (Median)\nAA_vs_BB&quot;
##  [7] &quot;Median Abundance\n(All)&quot;           &quot;Median Abundance\nAA&quot;             
##  [9] &quot;Median Abundance\nBB&quot;              &quot;Log2FoldChange (Mean)\nAA_vs_BB&quot;  
## [11] &quot;Mean Abundance\n(All)&quot;             &quot;Mean Abundance\nAA&quot;               
## [13] &quot;Mean Abundance\nBB&quot;                &quot;Occurrence (100%)\n(All)&quot;         
## [15] &quot;Occurrence (100%)\nAA&quot;             &quot;Occurrence (100%)\nBB&quot;            
## [17] &quot;Odds Ratio (95% CI)&quot;</code></pre>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="examples.html#cb342-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(metaphlan2_ps_lefse)</span></code></pre></div>
<div id="htmlwidget-7cd5acd0266f463c8e34" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-7cd5acd0266f463c8e34">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14"],["s__Bacteroides_thetaiotaomicron","s__Streptococcus_mutans","s__Dorea_longicatena","s__Clostridium_bartlettii","s__Streptococcus_mitis_oralis_pneumoniae","s__Eubacterium_hallii","s__Megamonas_rupellensis","s__Ruminococcus_obeum","s__Collinsella_aerofaciens","s__Ruminococcus_torques","s__Streptococcus_salivarius","s__Ruminococcus_sp_5_1_39BFAA","s__Bifidobacterium_longum","s__Faecalibacterium_prausnitzii"],["7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB"],["AA","AA","AA","AA","BB","BB","BB","BB","BB","BB","BB","BB","BB","BB"],[-0.0113320366913114,-0.000772936081595531,-0.000321974176751594,-0.000136065335270355,0.000177819615867319,0.00151566108461804,0.0018152618590105,0.00232739047014688,0.00250265217007945,0.00258897741471741,0.00379362842358036,0.00504610133081308,0.0114708766549846,0.0143512767111103],[1.34149263781366,2.75663163345055,1.92379304558984,0.514945955678602,2.62814082216171,0.948434293115322,0.985337536149965,1.45692007557241,0.971128974130095,2.82386083299322,4.3446961703697,0.43358051831361,3.45602627157229,1.71846108430988],[5.50585824843926,null,null,null,null,null,null,-4.82186088218386,null,-2.25396903627389,-4.89730355143934,null,-4.97973158213444,-4.01156160939027],[0.00247415,4.8e-06,0.00078795,0.00025355,0,0.00436885,0,0.00720275,0.00738145,0.00375175,0.00565725,0.01159115,0.01039305,0.0534688],[0.0453799,0,0,0,0,0,0.00056,0.0003467,0,0.0009419,0.0003221,0,0.000909,0.0047826],[0.0009987,4.48e-05,0.0081496,0.000447,2.02e-05,0.0109294,0,0.0098057,0.011248,0.0044928,0.009599,0.020093,0.0286822,0.0771373],[3.32776560890711,-3.29189585891708,-7.30709468006983,-3.82189452867615,-3.25731838950159,-3.78146538135764,5.02006898795237,-2.59685596322637,-3.33657051481402,-2.40796385117013,-1.7782490557838,-2.60632503710509,-3.71666338160977,-3.99213083553346],[0.0219183272727273,0.000907068181818182,0.00654555,0.00122028181818182,3.44818181818182e-05,0.0087429,0.000898918181818182,0.00887613636363636,0.0118099818181818,0.00867178181818182,0.0251036045454545,0.0213080272727273,0.0368540045454545,0.0575035181818182],[0.0567702428571429,0.000129657142857143,6.04428571428571e-05,0.000122514285714286,5.04285714285714e-06,0.0009019,0.00265015714285714,0.0019978,0.00163892857142857,0.00220277142857143,0.00944851428571429,0.00476677142857143,0.00397045714285714,0.00514898571428571],[0.0056541,0.00126986,0.00957193333333333,0.00173257333333333,4.822e-05,0.0124020333333333,8.16733333333333e-05,0.0120860266666667,0.0165564733333333,0.0116906533333333,0.0324093133333333,0.02902728,0.05219966,0.0819356333333333],[90.91,54.55,63.64,68.18,45.45,63.64,31.82,90.91,63.64,100,100,68.18,86.36,77.27],[100,14.29,42.86,42.86,14.29,42.86,57.14,71.43,42.86,100,100,28.57,85.71,57.14],[86.67,73.33,73.33,80,60,73.33,20,100,73.33,100,100,86.67,86.67,86.67],["0.038 (-6.4;6.4)","11 (15;6)","8.9e+12 (8.9e+12;8.9e+12)","600 (610;580)","8.4 (13;4.2)","110 (120;100)","0.0055 (-10;10)","23 (29;17)","41 (48;34)","410 (430;400)","2.9 (5;0.83)","12 (17;7.3)","290 (300;270)","75 (83;66)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>TaxaID<\/th>\n      <th>Block<\/th>\n      <th>Enrichment<\/th>\n      <th>LDA_Score<\/th>\n      <th>EffectSize<\/th>\n      <th>Log2FoldChange (Median)\nAA_vs_BB<\/th>\n      <th>Median Abundance\n(All)<\/th>\n      <th>Median Abundance\nAA<\/th>\n      <th>Median Abundance\nBB<\/th>\n      <th>Log2FoldChange (Mean)\nAA_vs_BB<\/th>\n      <th>Mean Abundance\n(All)<\/th>\n      <th>Mean Abundance\nAA<\/th>\n      <th>Mean Abundance\nBB<\/th>\n      <th>Occurrence (100%)\n(All)<\/th>\n      <th>Occurrence (100%)\nAA<\/th>\n      <th>Occurrence (100%)\nBB<\/th>\n      <th>Odds Ratio (95% CI)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,5,6,7,8,9,10,11,12,13,14,15,16]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<ul>
<li>Visualization</li>
</ul>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="examples.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_lefse</span>(</span>
<span id="cb343-2"><a href="examples.html#cb343-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">da_res =</span> metaphlan2_ps_lefse,</span>
<span id="cb343-3"><a href="examples.html#cb343-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_index =</span> <span class="st">&quot;LDA_Score&quot;</span>,</span>
<span id="cb343-4"><a href="examples.html#cb343-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_index_cutoff =</span> <span class="dv">1</span>,</span>
<span id="cb343-5"><a href="examples.html#cb343-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">group_color =</span> <span class="fu">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-183"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-183-1.png" alt="Lefse analysis (MGS example)" width="768" />
<p class="caption">
Figure 12.19: Lefse analysis (MGS example)
</p>
</div>
</div>
<div id="wilcoxon-rank-sum-test-1" class="section level4 hasAnchor" number="12.3.7.2">
<h4><span class="header-section-number">12.3.7.2</span> Wilcoxon Rank-Sum test<a href="examples.html#wilcoxon-rank-sum-test-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Calculation</li>
</ul>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="examples.html#cb344-1" aria-hidden="true" tabindex="-1"></a>metaphlan2_ps_wilcox <span class="ot">&lt;-</span> <span class="fu">run_wilcox</span>(</span>
<span id="cb344-2"><a href="examples.html#cb344-2" aria-hidden="true" tabindex="-1"></a>                    metaphlan2_ps_final,</span>
<span id="cb344-3"><a href="examples.html#cb344-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb344-4"><a href="examples.html#cb344-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">group_names =</span> <span class="fu">c</span>(<span class="st">&quot;AA&quot;</span>, <span class="st">&quot;BB&quot;</span>),</span>
<span id="cb344-5"><a href="examples.html#cb344-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">transform =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb344-6"><a href="examples.html#cb344-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">norm =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb344-7"><a href="examples.html#cb344-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">p_adjust =</span> <span class="st">&quot;BH&quot;</span>,</span>
<span id="cb344-8"><a href="examples.html#cb344-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pvalue_cutoff =</span> <span class="fl">0.05</span>)</span>
<span id="cb344-9"><a href="examples.html#cb344-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-10"><a href="examples.html#cb344-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(metaphlan2_ps_wilcox)</span></code></pre></div>
<pre><code>##  [1] &quot;TaxaID&quot;                            &quot;Block&quot;                            
##  [3] &quot;Enrichment&quot;                        &quot;EffectSize&quot;                       
##  [5] &quot;Statistic&quot;                         &quot;Pvalue&quot;                           
##  [7] &quot;AdjustedPvalue&quot;                    &quot;Log2FoldChange (Median)\nAA_vs_BB&quot;
##  [9] &quot;Median Abundance\n(All)&quot;           &quot;Median Abundance\nAA&quot;             
## [11] &quot;Median Abundance\nBB&quot;              &quot;Log2FoldChange (Rank)\nAA_vs_BB&quot;  
## [13] &quot;Mean Rank Abundance\nAA&quot;           &quot;Mean Rank Abundance\nBB&quot;          
## [15] &quot;Occurrence (100%)\n(All)&quot;          &quot;Occurrence (100%)\nAA&quot;            
## [17] &quot;Occurrence (100%)\nBB&quot;             &quot;Odds Ratio (95% CI)&quot;</code></pre>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="examples.html#cb346-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(metaphlan2_ps_wilcox)</span></code></pre></div>
<div id="htmlwidget-76ef85e580b409310ebb" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-76ef85e580b409310ebb">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136"],["s__Adlercreutzia_equolifaciens","s__Alistipes_finegoldii","s__Alistipes_indistinctus","s__Alistipes_onderdonkii","s__Alistipes_putredinis","s__Alistipes_senegalensis","s__Alistipes_shahii","s__Anaerostipes_caccae","s__Anaerostipes_hadrus","s__Anaerotruncus_colihominis","s__Bacteroidales_bacterium_ph8","s__Bacteroides_caccae","s__Bacteroides_cellulosilyticus","s__Bacteroides_clarus","s__Bacteroides_dorei","s__Bacteroides_eggerthii","s__Bacteroides_faecis","s__Bacteroides_finegoldii","s__Bacteroides_fragilis","s__Bacteroides_intestinalis","s__Bacteroides_massiliensis","s__Bacteroides_nordii","s__Bacteroides_ovatus","s__Bacteroides_plebeius","s__Bacteroides_stercoris","s__Bacteroides_thetaiotaomicron","s__Bacteroides_uniformis","s__Bacteroides_vulgatus","s__Bacteroides_xylanisolvens","s__Barnesiella_intestinihominis","s__Bifidobacterium_bifidum","s__Bifidobacterium_dentium","s__Bifidobacterium_longum","s__Bifidobacterium_pseudocatenulatum","s__Bilophila_wadsworthia","s__Blautia_producta","s__Burkholderiales_bacterium_1_1_47","s__Clostridiales_bacterium_1_7_47FAA","s__Clostridium_asparagiforme","s__Clostridium_bartlettii","s__Clostridium_bolteae","s__Clostridium_citroniae","s__Clostridium_clostridioforme","s__Clostridium_hathewayi","s__Clostridium_innocuum","s__Clostridium_leptum","s__Clostridium_nexile","s__Clostridium_perfringens","s__Clostridium_ramosum","s__Clostridium_symbiosum","s__Collinsella_aerofaciens","s__Coprobacter_fastidiosus","s__Coprococcus_catus","s__Coprococcus_comes","s__Desulfovibrio_piger","s__Dialister_invisus","s__Dorea_formicigenerans","s__Dorea_longicatena","s__Eggerthella_lenta","s__Enterobacter_cloacae","s__Enterococcus_avium","s__Enterococcus_faecalis","s__Enterococcus_faecium","s__Erysipelotrichaceae_bacterium_21_3","s__Erysipelotrichaceae_bacterium_2_2_44A","s__Escherichia_coli","s__Eubacterium_eligens","s__Eubacterium_hallii","s__Eubacterium_limosum","s__Eubacterium_ramulus","s__Eubacterium_ventriosum","s__Faecalibacterium_prausnitzii","s__Flavonifractor_plautii","s__Fusobacterium_ulcerans","s__Gordonibacter_pamelaeae","s__Granulicatella_adiacens","s__Haemophilus_parainfluenzae","s__Holdemania_filiformis","s__Klebsiella_pneumoniae","s__Lachnospiraceae_bacterium_1_1_57FAA","s__Lachnospiraceae_bacterium_1_4_56FAA","s__Lachnospiraceae_bacterium_2_1_58FAA","s__Lachnospiraceae_bacterium_3_1_46FAA","s__Lachnospiraceae_bacterium_4_1_37FAA","s__Lachnospiraceae_bacterium_5_1_63FAA","s__Lachnospiraceae_bacterium_6_1_63FAA","s__Lachnospiraceae_bacterium_7_1_58FAA","s__Lachnospiraceae_bacterium_9_1_43BFAA","s__Lactobacillus_crispatus","s__Lactobacillus_gasseri","s__Lactobacillus_mucosae","s__Lactobacillus_salivarius","s__Lactococcus_lactis","s__Megamonas_funiformis","s__Megamonas_hypermegale","s__Megamonas_rupellensis","s__Megasphaera_micronuciformis","s__Odoribacter_splanchnicus","s__Parabacteroides_distasonis","s__Parabacteroides_goldsteinii","s__Parabacteroides_johnsonii","s__Parabacteroides_merdae","s__Paraprevotella_clara","s__Paraprevotella_xylaniphila","s__Parasutterella_excrementihominis","s__Phascolarctobacterium_succinatutens","s__Prevotella_copri","s__Roseburia_hominis","s__Roseburia_intestinalis","s__Roseburia_inulinivorans","s__Rothia_mucilaginosa","s__Ruminococcus_bromii","s__Ruminococcus_callidus","s__Ruminococcus_gnavus","s__Ruminococcus_obeum","s__Ruminococcus_sp_5_1_39BFAA","s__Ruminococcus_torques","s__Streptococcus_anginosus","s__Streptococcus_australis","s__Streptococcus_cristatus","s__Streptococcus_gordonii","s__Streptococcus_infantis","s__Streptococcus_intermedius","s__Streptococcus_macedonicus","s__Streptococcus_mitis_oralis_pneumoniae","s__Streptococcus_mutans","s__Streptococcus_parasanguinis","s__Streptococcus_salivarius","s__Streptococcus_sanguinis","s__Streptococcus_thermophilus","s__Streptococcus_tigurinus","s__Streptococcus_vestibularis","s__Veillonella_atypica","s__Veillonella_dispar","s__Veillonella_parvula","s__Weissella_confusa"],["7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB","7_AA vs 15_BB"],["Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif","Nonsignif"],[0.453094462398023,0.832043004280731,0.460088282979102,0.737279733721884,1.14889839498472,0.344694427008232,0.662133202146267,0.656421427181561,0.312913600671977,0.648217051831355,0.276955897321974,0.749443055908792,0.390958444970927,0.431433811210359,1.50926307382285,0.645865254011648,0.870939757391336,0.537408753335805,0.724595844328375,0.161451636056916,0.0465060435662114,0.341263419268368,1.08876700155997,0.235197996397903,1.35180589196033,1.34149263781366,1.98710805453889,0.326879877193717,2.94166324943469,0.516229434997015,0.322375342743637,0.638803365165336,3.45602627157229,0.790480765357276,0.352757302368347,0.539584074044176,0.704444821069718,0.10215054794627,1.20561649313999,0.514945955678602,0.129021070802869,0.724740540622555,0.998097526481469,1.44948909396095,1.37126284518579,1.52871610615012,0.433764988172554,0.0590759490886387,0.626123397661122,1.13931591592518,0.971128974130095,0.687735779304869,1.0390298513979,0.408838575131738,0.152670687675247,1.16059856349938,0.284361984506366,1.92379304558984,1.37933354863303,1.10144409621764,0.295375597870391,0.14058270864573,1.12357168740573,0.974304168521756,0.1105665184219,0.28627475646379,0.184363571012119,0.948434293115322,0.618741832036624,0.737660392079201,0.501160666784615,1.71846108430988,0.638724926347002,1.22198926829486,2.84486441357169,3.47500166123147,1.42569469452752,0.772850756598854,0.0782862260576931,0.487593416825338,0.500330024747051,1.50519418986303,0.844432095767572,0.355360416086937,0.726764315941844,0.771075293306843,1.11039834597257,1.54600861392023,0.322777058146853,0.0190399624196437,0.999189644880088,1.09268636185347,0.830392639436041,0.531312788100016,0.740252307911405,0.985337536149965,0.220683578697727,0.794153328874048,2.22638992828341,2.12318576453974,0.771227646607055,0.105124490952097,1.30487198324565,0.470624701088193,0.499305989166808,0.261400927454785,0.555775372719254,0.309366990972553,0.3900399410425,1.13602588021945,0.973919999125939,0.154358602320905,0.454837432076069,0.622071872714056,1.45692007557241,0.43358051831361,2.82386083299322,2.5413334798841,0.253565847816873,1.15192677989554,0.419568636745883,0.0660851253895672,0.768837085116148,0.986571743705661,2.62814082216171,2.75663163345055,0.392653582930494,4.3446961703697,3.25918359913486,2.084610974161,1.64627217131424,1.72809845464221,0.391676804650773,0.146466481681852,0.739560604853735,0.110911206421004],[28,73.5,66,63.5,54,53.5,71,52.5,30.5,47.5,37,60,43,64,51,40,47,47.5,47,39,64,51,61.5,68,49,92,74.5,71.5,60.5,45,43,33,22,27,65,50.5,69,65,74,24,64.5,60,63,63.5,35.5,31,44,41,44,68,23,47,35,36,58,58,29.5,20,26.5,51,44,55.5,39,43,25.5,61,40,20,47,39,37,15,46.5,69,29,30,36.5,40,63,27.5,46,52,38.5,44,29,53,59,49,46,40,32,34,47,59,64.5,76,44,36,48,60,44,46,63,67,64.5,48,58,44,35,30.5,39,51.5,42.5,42,11,15,16,30.5,48.5,47,45.5,47,46,55,27,21,25,18,31,59.5,35,28,42,53,51,49],[0.057690716045913,0.114544766205117,0.267781542588521,0.437014313696331,0.9409918286742,0.964182679986379,0.175150578102989,1,0.125830609575146,0.712887079355093,0.201011164436652,0.609314029811486,0.476610138518989,0.348400786297196,0.9409918286742,0.306335826308371,0.669943652456615,0.712887079355093,0.711295610206119,0.30390025142041,0.323191976334444,0.932066561404856,0.548945843127769,0.177927668150187,0.824259420076098,0.0059610679552545,0.129524682403785,0.190949272837496,0.593246584840937,0.529561080184032,0.418919089999765,0.120256141083579,0.0342501440174861,0.0733239411015447,0.390016000189866,0.902375961960831,0.205742131416964,0.386110513207887,0.0734303727199457,0.0448876091354934,0.416251380481112,0.61821306880599,0.429031349625384,0.454715504796988,0.204023870474437,0.0967565054188865,0.526942472751125,0.384335742636453,0.537999935058029,0.266848314629344,0.0362148502277012,0.631252213167486,0.200364395686102,0.172592400067575,0.631252213167486,0.669943652456615,0.095808115424534,0.0208229138749944,0.0590803840321376,0.9409918286742,0.442520365313581,0.822347100972876,0.267781542588521,0.476610138518989,0.0591951336185568,0.581492166244488,0.380980755215298,0.0208229138749944,0.669943652456615,0.30390025142041,0.273466997032728,0.00871566513377988,0.691194864289975,0.124565777398631,0.0766370896777306,0.090348774239489,0.273208211082012,0.281154006354912,0.451303557409944,0.0832878675898947,0.64416722268371,1,0.29869755599497,0.442520365313581,0.103974384736478,1,0.64416722268371,0.812458898904756,0.564643493783356,0.281154006354912,0.113717932649658,0.141040935046812,0.631252213167486,0.62367973930489,0.376010803629976,0.0499214323312468,0.442520365313581,0.205742131416964,0.776740945561939,0.529561080184032,0.442520365313581,0.656941421815966,0.429031349625384,0.232700635813053,0.376010803629976,0.700999144330552,0.692529148786502,0.553725662833019,0.164482702381978,0.120465170328832,0.342570667574205,0.964182679986379,0.437247456406432,0.478373075405932,0.00384095661964329,0.00803971405620634,0.00852565906745473,0.120465170328832,0.774718984923304,0.631252213167486,0.595052434175601,0.706454693191086,0.564643493783356,0.847753142139741,0.0542918283668546,0.0217490066118742,0.0569378673872664,0.0137207993245145,0.125236772732666,0.616814408971861,0.164482702381978,0.0874978587816339,0.473791543201782,1,0.943739606666612,0.798155308620601],[0.447252120673541,0.48894179720628,0.682802586861928,0.761807211172747,0.987296819281994,0.993400336955664,0.576146734962509,1,0.48894179720628,0.828655066600792,0.582936039014733,0.825483663372867,0.765396920649491,0.752103284705059,0.987296819281994,0.694361206298974,0.828293970309997,0.828655066600792,0.828655066600792,0.694361206298974,0.720559160352203,0.987296819281994,0.825483663372867,0.576146734962509,0.911376269352433,0.237066091638813,0.489315466858745,0.582936039014733,0.825483663372867,0.818412578466232,0.761807211172747,0.48894179720628,0.447252120673541,0.48894179720628,0.761807211172747,0.981785046613385,0.582936039014733,0.761807211172747,0.48894179720628,0.447252120673541,0.761807211172747,0.825483663372867,0.761807211172747,0.763472946325808,0.582936039014733,0.48894179720628,0.818412578466232,0.761807211172747,0.822112260313392,0.682802586861928,0.447252120673541,0.825483663372867,0.582936039014733,0.576146734962509,0.825483663372867,0.828293970309997,0.48894179720628,0.328651655468322,0.447252120673541,0.987296819281994,0.761807211172747,0.911376269352433,0.682802586861928,0.765396920649491,0.447252120673541,0.825483663372867,0.761807211172747,0.328651655468322,0.828293970309997,0.694361206298974,0.682802586861928,0.237066091638813,0.828655066600792,0.48894179720628,0.48894179720628,0.48894179720628,0.682802586861928,0.682802586861928,0.763472946325808,0.48894179720628,0.826478700801741,1,0.694361206298974,0.761807211172747,0.48894179720628,1,0.826478700801741,0.911376269352433,0.825483663372867,0.682802586861928,0.48894179720628,0.51842073422612,0.825483663372867,0.825483663372867,0.761807211172747,0.447252120673541,0.761807211172747,0.582936039014733,0.887703937785073,0.818412578466232,0.761807211172747,0.828293970309997,0.761807211172747,0.645862989195413,0.761807211172747,0.828655066600792,0.828655066600792,0.825483663372867,0.573580705742282,0.48894179720628,0.751445335324063,0.993400336955664,0.761807211172747,0.765396920649491,0.237066091638813,0.237066091638813,0.237066091638813,0.48894179720628,0.887703937785073,0.825483663372867,0.825483663372867,0.828655066600792,0.825483663372867,0.929793768798425,0.447252120673541,0.328651655468322,0.447252120673541,0.311004784688995,0.48894179720628,0.825483663372867,0.573580705742282,0.48894179720628,0.765396920649491,1,0.987296819281994,0.904576016436681],[null,null,null,5.81915722367497,null,null,null,null,-3.90086680798075,null,null,4.4594316186373,null,null,null,null,null,null,null,null,null,null,0.658033457911271,null,null,5.50585824843926,4.17840476746062,2.54545557935931,4.37250105512395,null,null,null,-4.97973158213444,null,0.87582058877927,null,null,4.49690632405596,null,null,2.35882462102503,3.35859680493476,null,1.85147747528991,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,-4.7714894695006,0.433080312731137,null,null,null,null,null,-4.01156160939027,0.0328521604806676,null,null,null,-3,null,null,-3.61521127461932,null,0.284162713994813,null,null,-2.17413725272923,null,null,null,null,null,null,null,null,null,null,null,null,null,1.45572283772446,null,null,null,null,null,null,null,null,null,null,null,-3.81942775435818,null,null,-2.31804988007643,-4.82186088218386,null,-2.25396903627389,null,null,null,null,null,null,null,null,null,-3.54154914729085,-4.89730355143934,null,null,null,null,-3.85581641101425,0.633056788922201,-1.64566607071506,null],[0,0,0,8.25e-06,0.00016915,0,0.0001258,0,0.00013665,0,0,0.00021735,0,0,8.455e-05,0,0,0,9.9e-05,0,0,0,0.003982,0,0.00013465,0.00247415,0.01447805,0.01956875,9.1e-05,0,0,0,0.01039305,0.0025906,3.23e-05,0,0,3.7e-05,0,0.00025355,0.00056725,5.055e-05,0,3.955e-05,0,0,0,0,0,6.865e-05,0.00738145,0,4.37e-05,0,0,0,0.0014254,0.00078795,3.545e-05,6.545e-05,0,0,0,0,2.425e-05,0.0029282,0.00123585,0.00436885,0,0,0.00125955,0.0534688,5.27e-05,0,0,0,0.00033685,0,1.27e-05,0.00061035,0,9.27e-05,0,0,0.00061095,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0011334,0,0,0.00010365,0,0,0,0,0,1.945e-05,0,0.0012082,1.28e-05,0,0,0.00166885,0.00720275,0.01159115,0.00375175,0.0001151,0,0,0,6.5e-07,0,0,0,4.8e-06,0.00116795,0.00565725,1.45e-06,0,0,0.0001543,0.0001368,3.01e-05,0.00070535,0],[0,0.0027362,0,0.0002823,0,0,0.0062474,0,1.44e-05,0,0,0.0004158,0,0,0,0,0,0,0,0,0,0,0.0048747,0,0,0.0453799,0.0318233,0.0281855,0.0011641,0,0,0,0.000909,0,5.34e-05,0,0.0002556,8.58e-05,0.0002386,0,0.0009782,0.0002072,4.23e-05,4.98e-05,0,0,0,0,0,0.0001541,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.6e-06,0.0038782,0,0,0,0,0,0.0047826,5.33e-05,0,0,0,6.45e-05,0,0.0006532,0.0002407,0,0.0001018,0,0,0.0001672,0,0,0,0,0,0,0,0,0,0.0001068,0.00056,0,0,0.0018065,0,0,0,0,0,9.64e-05,0,0,0,0,0,1.7e-06,0,0,0.0003576,0.0003467,0,0.0009419,0,0,0,0,0,0,0,0,0,0.0001459,0.0003221,0,5.7e-06,0,0,1.38e-05,3.66e-05,0.0002358,0],[5.58e-05,0,0,5e-06,0.00022,0,0,0,0.0002151,0,0,1.89e-05,0,0,0.000168,0,0,0,0.0001254,0,0,0,0.0030893,0,0.0002636,0.0009987,0.0017576,0.004828,5.62e-05,0,0,0,0.0286822,0.0089661,2.91e-05,0,0,3.8e-06,0,0.000447,0.0001907,2.02e-05,0,1.38e-05,1.22e-05,1.14e-05,0,0,0,0,0.011248,0,0.0023357,0,0,0,0.0038363,0.0081496,0.0001392,0.0001048,0,0,0,0,4.37e-05,0.0028725,0.0022496,0.0109294,0,0,0.0020078,0.0771373,5.21e-05,0,1.93e-05,2e-06,0.000516,0,0,0.0029496,0,8.36e-05,1.71e-05,0,0.0007546,0,0,0,0,0,5.5e-06,0,0,0,0,0,0,0.0011013,0.0006586,0,0,0.0013409,0,0,0,0,0,0.0002079,0,0.0014529,2.4e-05,0,0,0.0017832,0.0098057,0.020093,0.0044928,0.0002496,0,0,0,1.16e-05,0,0,2.02e-05,4.48e-05,0.0016989,0.009599,3.3e-06,0,0,0.0002348,0.0001998,2.36e-05,0.0007378,0],[-0.714795011118162,0.52169760726314,0.341395039976881,0.279240891251226,0.038707251449111,0.0262656546938057,0.461345938491204,0,-0.633603632170817,-0.132755208851772,-0.431635912939208,0.192481126008486,-0.25852189811717,0.292315199565808,-0.0390793192419337,-0.344629598983647,-0.148361454891651,-0.132755208851772,-0.148361454891651,-0.373749290788212,0.292315199565808,-0.0390793192419337,0.230688129217348,0.388967128848417,-0.0926994896164866,0.950361099811436,0.545593947671862,0.474100409497452,0.20443293777391,-0.202295247976115,-0.25852189811717,-0.555399186288498,-0.922165859947437,-0.747936711987209,0.31678092845175,-0.0530648186677916,0.414343729108759,0.31678092845175,0.532937194057728,-0.850798884806539,0.304019669958319,0.192481126008486,0.267480310864986,0.279240891251226,-0.47768018325903,-0.617117738868172,-0.230182693861053,-0.315475697284994,-0.230182693861053,0.388967128848417,-0.885759131135366,-0.148361454891651,-0.493419617923772,-0.463157663329209,0.143031323030702,0.143031323030702,-0.66638295679033,-0.994732761433248,-0.764117828217008,-0.0390793192419337,-0.230182693861053,0.0782712703926777,-0.373749290788212,-0.25852189811717,-0.799781702352803,0.217670629333054,-0.344629598983647,-0.994732761433248,-0.148361454891651,-0.373749290788212,-0.431635912939208,-1.18911626646215,-0.161463422694116,0.414343729108759,-0.683158441529186,-0.649067616420066,-0.448711588329172,-0.344629598983647,0.267480310864986,-0.731862574552536,-0.174618666312545,-0.0125671094372935,-0.387826877834175,-0.230182693861053,-0.683158441529186,0.0125234730916649,0.167171074270933,-0.0926994896164866,-0.174618666312545,-0.344629598983647,-0.586644944108202,-0.52285381534634,-0.148361454891651,0.167171074270933,0.304019669958319,0.581568493010222,-0.230182693861053,-0.463157663329209,-0.119762756444842,0.192481126008486,-0.230182693861053,-0.174618666312545,0.267480310864986,0.365915284393137,0.304019669958319,-0.119762756444842,0.143031323030702,-0.230182693861053,-0.493419617923772,-0.633603632170817,-0.373749290788212,-0.026426029602808,-0.273265484706944,-0.286881147788162,-1.35723610213573,-1.18911626646215,-1.14706333572196,-0.633603632170817,-0.10682091936654,-0.148361454891651,-0.189033824390017,-0.148361454891651,-0.174618666312545,0.065956148725488,-0.747936711987209,-0.958179824305373,-0.816311575103241,-1.0707029913432,-0.617117738868172,0.180495303958067,-0.493419617923772,-0.714795011118162,-0.286881147788162,0.0125234730916649,-0.0390793192419337,-0.0926994896164866],[8,14.5,13.43,13.07,11.71,11.64,14.14,11.5,8.36,10.79,9.29,12.57,10.14,13.14,11.29,9.71,10.71,10.79,10.71,9.57,13.14,11.29,12.79,13.71,11,17.14,14.64,14.21,12.64,10.43,10.14,8.71,7.14,7.86,13.29,11.21,13.86,13.29,14.57,7.43,13.21,12.57,13,13.07,9.07,8.43,10.29,9.86,10.29,13.71,7.29,10.71,9,9.14,12.29,12.29,8.21,6.86,7.79,11.29,10.29,11.93,9.57,10.14,7.64,12.71,9.71,6.86,10.71,9.57,9.29,6.14,10.64,13.86,8.14,8.29,9.21,9.71,13,7.93,10.57,11.43,9.5,10.29,8.14,11.57,12.43,11,10.57,9.71,8.57,8.86,10.71,12.43,13.21,14.86,10.29,9.14,10.86,12.57,10.29,10.57,13,13.57,13.21,10.86,12.29,10.29,9,8.36,9.57,11.36,10.07,10,5.57,6.14,6.29,8.36,10.93,10.71,10.5,10.71,10.57,11.86,7.86,7,7.57,6.57,8.43,12.5,9,8,10,11.57,11.29,11],[13.13,10.1,10.6,10.77,11.4,11.43,10.27,11.5,12.97,11.83,12.53,11,12.13,10.73,11.6,12.33,11.87,11.83,11.87,12.4,10.73,11.6,10.9,10.47,11.73,8.87,10.03,10.23,10.97,12,12.13,12.8,13.53,13.2,10.67,11.63,10.4,10.67,10.07,13.4,10.7,11,10.8,10.77,12.63,12.93,12.07,12.27,12.07,10.47,13.47,11.87,12.67,12.6,11.13,11.13,13.03,13.67,13.23,11.6,12.07,11.3,12.4,12.13,13.3,10.93,12.33,13.67,11.87,12.4,12.53,14,11.9,10.4,13.07,13,12.57,12.33,10.8,13.17,11.93,11.53,12.43,12.07,13.07,11.47,11.07,11.73,11.93,12.33,12.87,12.73,11.87,11.07,10.7,9.93,12.07,12.6,11.8,11,12.07,11.93,10.8,10.53,10.7,11.8,11.13,12.07,12.67,12.97,12.4,11.57,12.17,12.2,14.27,14,13.93,12.97,11.77,11.87,11.97,11.87,11.93,11.33,13.2,13.6,13.33,13.8,12.93,11.03,12.67,13.13,12.2,11.47,11.6,11.73],[40.91,45.45,31.82,54.55,54.55,27.27,50,27.27,72.73,36.36,31.82,59.09,40.91,31.82,54.55,31.82,31.82,36.36,54.55,40.91,27.27,31.82,90.91,27.27,54.55,90.91,90.91,81.82,72.73,27.27,27.27,36.36,86.36,68.18,68.18,36.36,40.91,63.64,31.82,68.18,81.82,72.73,40.91,72.73,45.45,40.91,40.91,40.91,45.45,54.55,63.64,22.73,50,31.82,22.73,31.82,54.55,63.64,54.55,54.55,22.73,27.27,31.82,40.91,72.73,95.45,59.09,63.64,31.82,40.91,59.09,77.27,63.64,22.73,45.45,45.45,81.82,27.27,50,81.82,45.45,68.18,45.45,22.73,81.82,36.36,45.45,40.91,22.73,27.27,40.91,36.36,22.73,36.36,45.45,31.82,22.73,40.91,77.27,27.27,22.73,54.55,40.91,31.82,45.45,22.73,40.91,54.55,36.36,63.64,59.09,27.27,36.36,77.27,90.91,68.18,100,63.64,36.36,22.73,36.36,50,22.73,22.73,45.45,54.55,90.91,100,59.09,45.45,36.36,72.73,68.18,59.09,86.36,31.82],[14.29,57.14,42.86,57.14,42.86,28.57,57.14,28.57,57.14,28.57,14.29,57.14,28.57,42.86,42.86,14.29,28.57,28.57,42.86,28.57,42.86,28.57,85.71,42.86,42.86,100,85.71,85.71,57.14,14.29,14.29,14.29,85.71,42.86,71.43,28.57,57.14,71.43,57.14,42.86,85.71,71.43,57.14,85.71,28.57,14.29,28.57,28.57,42.86,71.43,42.86,14.29,42.86,14.29,28.57,42.86,28.57,42.86,28.57,42.86,14.29,28.57,14.29,28.57,57.14,85.71,42.86,42.86,28.57,28.57,42.86,57.14,57.14,42.86,14.29,14.29,57.14,14.29,57.14,57.14,42.86,57.14,28.57,14.29,71.43,42.86,42.86,42.86,14.29,14.29,14.29,14.29,14.29,42.86,57.14,57.14,14.29,14.29,57.14,42.86,14.29,42.86,42.86,42.86,57.14,14.29,42.86,42.86,14.29,28.57,57.14,28.57,28.57,71.43,71.43,28.57,100,28.57,28.57,14.29,28.57,42.86,14.29,28.57,14.29,14.29,71.43,100,28.57,57.14,14.29,42.86,57.14,57.14,85.71,28.57],[53.33,40,26.67,53.33,60,26.67,46.67,26.67,80,40,40,60,46.67,26.67,60,40,33.33,40,60,46.67,20,33.33,93.33,20,60,86.67,93.33,80,80,33.33,33.33,46.67,86.67,80,66.67,40,33.33,60,20,80,80,73.33,33.33,66.67,53.33,53.33,46.67,46.67,46.67,46.67,73.33,26.67,53.33,40,20,26.67,66.67,73.33,66.67,60,26.67,26.67,40,46.67,80,100,66.67,73.33,33.33,46.67,66.67,86.67,66.67,13.33,60,60,93.33,33.33,46.67,93.33,46.67,73.33,53.33,26.67,86.67,33.33,46.67,40,26.67,33.33,53.33,46.67,26.67,33.33,40,20,26.67,53.33,86.67,20,26.67,60,40,26.67,40,26.67,40,60,46.67,80,60,26.67,40,80,100,86.67,100,80,40,26.67,40,53.33,26.67,20,60,73.33,100,100,73.33,40,46.67,86.67,73.33,60,86.67,33.33],["Inf (Inf;Inf)","0.0028 (-12;12)","0.067 (-5.2;5.4)","0.38 (-1.5;2.3)","0.47 (-0.99;1.9)","1 (1;1)","0.17 (-3.2;3.6)","1 (1;0.99)","31 (38;24)","1.3 (1.9;0.77)","55000 (55000;55000)","0.042 (-6.2;6.3)","1.4 (2;0.76)","0.85 (0.52;1.2)","1 (1;1)","1.8 (2.9;0.65)","3.2e+24 (3.2e+24;3.2e+24)","1.5 (2.4;0.69)","0.93 (0.78;1.1)","3.7e+56 (3.7e+56;3.7e+56)","0.59 (-0.43;1.6)","1.8 (3;0.65)","0.33 (-1.9;2.5)","0.27 (-2.3;2.8)","0.77 (0.26;1.3)","0.038 (-6.4;6.4)","0.51 (-0.83;1.8)","0.49 (-0.9;1.9)","0.35 (-1.7;2.4)","0.74 (0.14;1.3)","1.6 (2.6;0.67)","1200000 (1200000;1200000)","290 (300;270)","27 (34;21)","0.2 (-3;3.4)","1.3 (1.9;0.78)","0.53 (-0.69;1.8)","0.53 (-0.7;1.8)","0.0028 (-11;12)","600 (610;580)","0.59 (-0.45;1.6)","0.68 (-0.057;1.4)","0.54 (-0.67;1.7)","0.61 (-0.35;1.6)","2.3 (3.9;0.66)","5.5 (8.9;2.2)","0.75 (0.17;1.3)","1.7 (2.7;0.66)","360000 (360000;360000)","0.6 (-0.39;1.6)","41 (48;34)","1.7 (2.8;0.66)","13 (18;7.9)","3.8e+12 (3.8e+12;3.8e+12)","0.67 (-0.11;1.5)","1.4 (2.1;0.74)","5.3 (8.5;2)","8.9e+12 (8.9e+12;8.9e+12)","11 (16;6.4)","0.87 (0.61;1.1)","7.1e+07 (7.1e+07;7.1e+07)","0.68 (-0.086;1.4)","4 (6.8;1.3)","5.1e+07 (5.1e+07;5.1e+07)","3.7 (6.3;1.1)","0.46 (-1.1;2)","1.4 (2.2;0.72)","110 (120;100)","4.1e+14 (4.1e+14;4.1e+14)","27 (33;20)","2.2 (3.7;0.65)","75 (83;66)","0.81 (0.4;1.2)","0.15 (-3.5;3.8)","2.9 (5;0.81)","16 (21;10)","1.6 (2.6;0.67)","Inf (Inf;Inf)","0.96 (0.87;1)","13 (19;8.4)","6.6 (10;2.9)","0.69 (-0.049;1.4)","1.6 (2.6;0.67)","1.8e+21 (1.8e+21;1.8e+21)","2.3 (3.9;0.66)","1.7 (2.8;0.66)","0.49 (-0.9;1.9)","1.9 (3.1;0.64)","8e+16 (8e+16;8e+16)","Inf (Inf;Inf)","43 (50;36)","7.7 (12;3.7)","1.4 (2.1;0.74)","1.4 (2;0.75)","0.46 (-1;2)","0.0055 (-10;10)","1.7e+57 (1.7e+57;1.7e+57)","0.81 (0.41;1.2)","0.74 (0.16;1.3)","2.8 (4.8;0.77)","1.5e+15 (1.5e+15;1.5e+15)","0.95 (0.86;1)","0.2 (-2.9;3.3)","0.16 (-3.4;3.7)","0.61 (-0.38;1.6)","0.95 (0.85;1.1)","0.61 (-0.38;1.6)","2.5 (4.3;0.7)","13 (18;7.7)","1.6 (2.5;0.68)","780 (790;770)","3.2 (5.4;0.9)","29 (36;23)","2.6 (4.5;0.73)","23 (29;17)","12 (17;7.3)","410 (430;400)","0.9 (0.69;1.1)","1 (1;0.98)","1.1 (1.2;0.94)","1.4 (2.1;0.73)","0.96 (0.89;1)","1.6 (2.6;0.67)","1.9 (3.2;0.64)","8.4 (13;4.2)","11 (15;6)","1.1 (1.4;0.89)","2.9 (5;0.83)","1.7 (2.8;0.65)","0.91 (0.71;1.1)","720 (730;700)","2.4 (4.1;0.69)","0.88 (0.63;1.1)","0.92 (0.77;1.1)","0.35 (-1.7;2.4)","3 (5.1;0.85)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>TaxaID<\/th>\n      <th>Block<\/th>\n      <th>Enrichment<\/th>\n      <th>EffectSize<\/th>\n      <th>Statistic<\/th>\n      <th>Pvalue<\/th>\n      <th>AdjustedPvalue<\/th>\n      <th>Log2FoldChange (Median)\nAA_vs_BB<\/th>\n      <th>Median Abundance\n(All)<\/th>\n      <th>Median Abundance\nAA<\/th>\n      <th>Median Abundance\nBB<\/th>\n      <th>Log2FoldChange (Rank)\nAA_vs_BB<\/th>\n      <th>Mean Rank Abundance\nAA<\/th>\n      <th>Mean Rank Abundance\nBB<\/th>\n      <th>Occurrence (100%)\n(All)<\/th>\n      <th>Occurrence (100%)\nAA<\/th>\n      <th>Occurrence (100%)\nBB<\/th>\n      <th>Odds Ratio (95% CI)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,5,6,7,8,9,10,11,12,13,14,15,16,17]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<ul>
<li>Volcano</li>
</ul>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="examples.html#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_volcano</span>(</span>
<span id="cb347-2"><a href="examples.html#cb347-2" aria-hidden="true" tabindex="-1"></a>    metaphlan2_ps_wilcox,</span>
<span id="cb347-3"><a href="examples.html#cb347-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">group_names =</span> <span class="fu">c</span>(<span class="st">&quot;AA&quot;</span>, <span class="st">&quot;BB&quot;</span>),</span>
<span id="cb347-4"><a href="examples.html#cb347-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_index =</span> <span class="st">&quot;Log2FoldChange (Rank)</span><span class="sc">\n</span><span class="st">AA_vs_BB&quot;</span>,</span>
<span id="cb347-5"><a href="examples.html#cb347-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_index_cutoff =</span> <span class="fl">0.5</span>,</span>
<span id="cb347-6"><a href="examples.html#cb347-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_index =</span> <span class="st">&quot;Pvalue&quot;</span>,</span>
<span id="cb347-7"><a href="examples.html#cb347-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_index_cutoff =</span> <span class="fl">0.05</span>,</span>
<span id="cb347-8"><a href="examples.html#cb347-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">group_color =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;grey&quot;</span>, <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb347-9"><a href="examples.html#cb347-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">topN =</span> <span class="dv">5</span>,</span>
<span id="cb347-10"><a href="examples.html#cb347-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">taxa_name =</span> <span class="cn">NULL</span></span>
<span id="cb347-11"><a href="examples.html#cb347-11" aria-hidden="true" tabindex="-1"></a>   )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-185"></span>
<img src="Data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-185-1.png" alt="Wilcoxon Rank-Sum test (MGS example)" width="768" />
<p class="caption">
Figure 12.20: Wilcoxon Rank-Sum test (MGS example)
</p>
</div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="differential-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/XbiomeAnalysis/XMAS_tutorial/blob/main/19-examples.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Data analysis based on XMAS package.pdf", "Data analysis based on XMAS package.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
